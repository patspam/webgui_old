<html><head><title>autocomplete.js</title><link rel="stylesheet" type="text/css" href="../style.css" media="screen"/></head><body><div class="hl-main"><pre><span class="hl-comment">/*
Copyright (c) 2006, Yahoo! Inc. All rights reserved.
Code licensed under the BSD License:
</span><span class="hl-url">http://developer.yahoo.com/yui/license.txt</span><span class="hl-comment">
version: 0.12.0
*/
// holder
/**
 * The AutoComplete control provides the front-end logic for text-entry suggestion and
 * completion functionality.
 *
 * @module autocomplete
 * @requires yahoo, dom, event, datasource
 * @optional animation, connection, json
 * @namespace YAHOO.widget
 * @title AutoComplete Widget
 */
// holder
/****************************************************************************/
// holder
/****************************************************************************/
// holder
/****************************************************************************/
// holder
/**
 * The AutoComplete class provides the customizable functionality of a plug-and-play DHTML
 * auto completion widget.  Some key features:
 * &lt;ul&gt;
 * &lt;li&gt;Navigate with up/down arrow keys and/or mouse to pick a selection&lt;/li&gt;
 * &lt;li&gt;The drop down container can &quot;roll down&quot; or &quot;fly out&quot; via configurable
 * animation&lt;/li&gt;
 * &lt;li&gt;UI look-and-feel customizable through CSS, including container
 * attributes, borders, position, fonts, etc&lt;/li&gt;
 * &lt;/ul&gt;
 *
 * @class AutoComplete
 * @constructor
 * @param elInput {HTMLElement} DOM element reference of an input field
 * @param elInput {String} String ID of an input field
 * @param elContainer {HTMLElement} DOM element reference of an existing DIV
 * @param elContainer {String} String ID of an existing DIV
 * @param oDataSource {Object} Instance of YAHOO.widget.DataSource for query/results
 * @param oConfigs {Object} (optional) Object literal of configuration params
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">(</span><span class="hl-identifier">elInput</span><span class="hl-code">,</span><span class="hl-identifier">elContainer</span><span class="hl-code">,</span><span class="hl-identifier">oDataSource</span><span class="hl-code">,</span><span class="hl-identifier">oConfigs</span><span class="hl-brackets">) {
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">elInput</span><span class="hl-code"> &amp;&amp; </span><span class="hl-identifier">elContainer</span><span class="hl-code"> &amp;&amp; </span><span class="hl-identifier">oDataSource</span><span class="hl-brackets">) {
        </span><span class="hl-comment">// Validate DataSource
        </span><span class="hl-reserved">if </span><span class="hl-brackets">(</span><span class="hl-identifier">oDataSource</span><span class="hl-code"> &amp;&amp; </span><span class="hl-brackets">(</span><span class="hl-identifier">oDataSource </span><span class="hl-reserved">instanceof </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">widget</span><span class="hl-code">.</span><span class="hl-identifier">DataSource</span><span class="hl-brackets">)) {
            </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">dataSource</span><span class="hl-code"> = </span><span class="hl-identifier">oDataSource</span><span class="hl-code">;
        </span><span class="hl-brackets">}
        </span><span class="hl-reserved">else </span><span class="hl-brackets">{
            </span><span class="hl-reserved">return</span><span class="hl-code">;
        </span><span class="hl-brackets">}

        </span><span class="hl-comment">// Validate input element
        </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">Dom</span><span class="hl-code">.</span><span class="hl-identifier">inDocument</span><span class="hl-brackets">(</span><span class="hl-identifier">elInput</span><span class="hl-brackets">)) {
            </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-reserved">typeof </span><span class="hl-identifier">elInput</span><span class="hl-code"> == </span><span class="hl-quotes">&quot;</span><span class="hl-string">string</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">) {
                    </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_sName</span><span class="hl-code"> = </span><span class="hl-quotes">&quot;</span><span class="hl-string">instance</span><span class="hl-quotes">&quot;</span><span class="hl-code"> + </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">widget</span><span class="hl-code">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-code">.</span><span class="hl-identifier">_nIndex</span><span class="hl-code"> + </span><span class="hl-quotes">&quot; &quot;</span><span class="hl-code"> + </span><span class="hl-identifier">elInput</span><span class="hl-code">;
                    </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oTextbox</span><span class="hl-code"> = </span><span class="hl-builtin">document</span><span class="hl-code">.</span><span class="hl-identifier">getElementById</span><span class="hl-brackets">(</span><span class="hl-identifier">elInput</span><span class="hl-brackets">)</span><span class="hl-code">;
            </span><span class="hl-brackets">}
            </span><span class="hl-reserved">else </span><span class="hl-brackets">{
                </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_sName</span><span class="hl-code"> = </span><span class="hl-brackets">(</span><span class="hl-identifier">elInput</span><span class="hl-code">.</span><span class="hl-identifier">id</span><span class="hl-brackets">)</span><span class="hl-code"> ?
                    </span><span class="hl-quotes">&quot;</span><span class="hl-string">instance</span><span class="hl-quotes">&quot;</span><span class="hl-code"> + </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">widget</span><span class="hl-code">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-code">.</span><span class="hl-identifier">_nIndex</span><span class="hl-code"> + </span><span class="hl-quotes">&quot; &quot;</span><span class="hl-code"> + </span><span class="hl-identifier">elInput</span><span class="hl-code">.</span><span class="hl-identifier">id</span><span class="hl-code">:
                    </span><span class="hl-quotes">&quot;</span><span class="hl-string">instance</span><span class="hl-quotes">&quot;</span><span class="hl-code"> + </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">widget</span><span class="hl-code">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-code">.</span><span class="hl-identifier">_nIndex</span><span class="hl-code">;
                </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oTextbox</span><span class="hl-code"> = </span><span class="hl-identifier">elInput</span><span class="hl-code">;
            </span><span class="hl-brackets">}
        }
        </span><span class="hl-reserved">else </span><span class="hl-brackets">{
            </span><span class="hl-reserved">return</span><span class="hl-code">;
        </span><span class="hl-brackets">}

        </span><span class="hl-comment">// Validate container element
        </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">Dom</span><span class="hl-code">.</span><span class="hl-identifier">inDocument</span><span class="hl-brackets">(</span><span class="hl-identifier">elContainer</span><span class="hl-brackets">)) {
            </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-reserved">typeof </span><span class="hl-identifier">elContainer</span><span class="hl-code"> == </span><span class="hl-quotes">&quot;</span><span class="hl-string">string</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">) {
                    </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code"> = </span><span class="hl-builtin">document</span><span class="hl-code">.</span><span class="hl-identifier">getElementById</span><span class="hl-brackets">(</span><span class="hl-identifier">elContainer</span><span class="hl-brackets">)</span><span class="hl-code">;
            </span><span class="hl-brackets">}
            </span><span class="hl-reserved">else </span><span class="hl-brackets">{
                </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code"> = </span><span class="hl-identifier">elContainer</span><span class="hl-code">;
            </span><span class="hl-brackets">}
            </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">style</span><span class="hl-code">.</span><span class="hl-identifier">display</span><span class="hl-code"> == </span><span class="hl-quotes">&quot;</span><span class="hl-string">none</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">) {
            }
        }
        </span><span class="hl-reserved">else </span><span class="hl-brackets">{
            </span><span class="hl-reserved">return</span><span class="hl-code">;
        </span><span class="hl-brackets">}

        </span><span class="hl-comment">// Set any config params passed in to override defaults
        </span><span class="hl-reserved">if </span><span class="hl-brackets">(</span><span class="hl-reserved">typeof </span><span class="hl-identifier">oConfigs</span><span class="hl-code"> == </span><span class="hl-quotes">&quot;</span><span class="hl-string">object</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">) {
            </span><span class="hl-reserved">for</span><span class="hl-brackets">(</span><span class="hl-reserved">var </span><span class="hl-identifier">sConfig </span><span class="hl-reserved">in </span><span class="hl-identifier">oConfigs</span><span class="hl-brackets">) {
                </span><span class="hl-reserved">if </span><span class="hl-brackets">(</span><span class="hl-identifier">sConfig</span><span class="hl-brackets">) {
                    </span><span class="hl-reserved">this</span><span class="hl-brackets">[</span><span class="hl-identifier">sConfig</span><span class="hl-brackets">]</span><span class="hl-code"> = </span><span class="hl-identifier">oConfigs</span><span class="hl-brackets">[</span><span class="hl-identifier">sConfig</span><span class="hl-brackets">]</span><span class="hl-code">;
                </span><span class="hl-brackets">}
            }
        }

        </span><span class="hl-comment">// Initialization sequence
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_initContainer</span><span class="hl-brackets">()</span><span class="hl-code">;
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_initProps</span><span class="hl-brackets">()</span><span class="hl-code">;
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_initList</span><span class="hl-brackets">()</span><span class="hl-code">;
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_initContainerHelpers</span><span class="hl-brackets">()</span><span class="hl-code">;

        </span><span class="hl-comment">// Set up events
        </span><span class="hl-reserved">var </span><span class="hl-identifier">oSelf</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">;
        </span><span class="hl-reserved">var </span><span class="hl-identifier">oTextbox</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oTextbox</span><span class="hl-code">;
        </span><span class="hl-comment">// Events are actually for the content module within the container
        </span><span class="hl-reserved">var </span><span class="hl-identifier">oContent</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oContent</span><span class="hl-code">;

        </span><span class="hl-comment">// Dom events
        </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">Event</span><span class="hl-code">.</span><span class="hl-identifier">addListener</span><span class="hl-brackets">(</span><span class="hl-identifier">oTextbox</span><span class="hl-code">,</span><span class="hl-quotes">&quot;</span><span class="hl-string">keyup</span><span class="hl-quotes">&quot;</span><span class="hl-code">,</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_onTextboxKeyUp</span><span class="hl-code">,</span><span class="hl-identifier">oSelf</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">Event</span><span class="hl-code">.</span><span class="hl-identifier">addListener</span><span class="hl-brackets">(</span><span class="hl-identifier">oTextbox</span><span class="hl-code">,</span><span class="hl-quotes">&quot;</span><span class="hl-string">keydown</span><span class="hl-quotes">&quot;</span><span class="hl-code">,</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_onTextboxKeyDown</span><span class="hl-code">,</span><span class="hl-identifier">oSelf</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">Event</span><span class="hl-code">.</span><span class="hl-identifier">addListener</span><span class="hl-brackets">(</span><span class="hl-identifier">oTextbox</span><span class="hl-code">,</span><span class="hl-quotes">&quot;</span><span class="hl-string">focus</span><span class="hl-quotes">&quot;</span><span class="hl-code">,</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_onTextboxFocus</span><span class="hl-code">,</span><span class="hl-identifier">oSelf</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">Event</span><span class="hl-code">.</span><span class="hl-identifier">addListener</span><span class="hl-brackets">(</span><span class="hl-identifier">oTextbox</span><span class="hl-code">,</span><span class="hl-quotes">&quot;</span><span class="hl-string">blur</span><span class="hl-quotes">&quot;</span><span class="hl-code">,</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_onTextboxBlur</span><span class="hl-code">,</span><span class="hl-identifier">oSelf</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">Event</span><span class="hl-code">.</span><span class="hl-identifier">addListener</span><span class="hl-brackets">(</span><span class="hl-identifier">oContent</span><span class="hl-code">,</span><span class="hl-quotes">&quot;</span><span class="hl-string">mouseover</span><span class="hl-quotes">&quot;</span><span class="hl-code">,</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_onContainerMouseover</span><span class="hl-code">,</span><span class="hl-identifier">oSelf</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">Event</span><span class="hl-code">.</span><span class="hl-identifier">addListener</span><span class="hl-brackets">(</span><span class="hl-identifier">oContent</span><span class="hl-code">,</span><span class="hl-quotes">&quot;</span><span class="hl-string">mouseout</span><span class="hl-quotes">&quot;</span><span class="hl-code">,</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_onContainerMouseout</span><span class="hl-code">,</span><span class="hl-identifier">oSelf</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">Event</span><span class="hl-code">.</span><span class="hl-identifier">addListener</span><span class="hl-brackets">(</span><span class="hl-identifier">oContent</span><span class="hl-code">,</span><span class="hl-quotes">&quot;</span><span class="hl-string">scroll</span><span class="hl-quotes">&quot;</span><span class="hl-code">,</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_onContainerScroll</span><span class="hl-code">,</span><span class="hl-identifier">oSelf</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">Event</span><span class="hl-code">.</span><span class="hl-identifier">addListener</span><span class="hl-brackets">(</span><span class="hl-identifier">oContent</span><span class="hl-code">,</span><span class="hl-quotes">&quot;</span><span class="hl-string">resize</span><span class="hl-quotes">&quot;</span><span class="hl-code">,</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_onContainerResize</span><span class="hl-code">,</span><span class="hl-identifier">oSelf</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">oTextbox</span><span class="hl-code">.</span><span class="hl-identifier">form</span><span class="hl-brackets">) {
            </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">Event</span><span class="hl-code">.</span><span class="hl-identifier">addListener</span><span class="hl-brackets">(</span><span class="hl-identifier">oTextbox</span><span class="hl-code">.</span><span class="hl-identifier">form</span><span class="hl-code">,</span><span class="hl-quotes">&quot;</span><span class="hl-string">submit</span><span class="hl-quotes">&quot;</span><span class="hl-code">,</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_onFormSubmit</span><span class="hl-code">,</span><span class="hl-identifier">oSelf</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-brackets">}
        </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">Event</span><span class="hl-code">.</span><span class="hl-identifier">addListener</span><span class="hl-brackets">(</span><span class="hl-identifier">oTextbox</span><span class="hl-code">,</span><span class="hl-quotes">&quot;</span><span class="hl-string">keypress</span><span class="hl-quotes">&quot;</span><span class="hl-code">,</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_onTextboxKeyPress</span><span class="hl-code">,</span><span class="hl-identifier">oSelf</span><span class="hl-brackets">)</span><span class="hl-code">;

        </span><span class="hl-comment">// Custom events
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">textboxFocusEvent</span><span class="hl-code"> = </span><span class="hl-reserved">new </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">CustomEvent</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">textboxFocus</span><span class="hl-quotes">&quot;</span><span class="hl-code">, </span><span class="hl-reserved">this</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">textboxKeyEvent</span><span class="hl-code"> = </span><span class="hl-reserved">new </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">CustomEvent</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">textboxKey</span><span class="hl-quotes">&quot;</span><span class="hl-code">, </span><span class="hl-reserved">this</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">dataRequestEvent</span><span class="hl-code"> = </span><span class="hl-reserved">new </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">CustomEvent</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">dataRequest</span><span class="hl-quotes">&quot;</span><span class="hl-code">, </span><span class="hl-reserved">this</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">dataReturnEvent</span><span class="hl-code"> = </span><span class="hl-reserved">new </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">CustomEvent</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">dataReturn</span><span class="hl-quotes">&quot;</span><span class="hl-code">, </span><span class="hl-reserved">this</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">dataErrorEvent</span><span class="hl-code"> = </span><span class="hl-reserved">new </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">CustomEvent</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">dataError</span><span class="hl-quotes">&quot;</span><span class="hl-code">, </span><span class="hl-reserved">this</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">containerExpandEvent</span><span class="hl-code"> = </span><span class="hl-reserved">new </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">CustomEvent</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">containerExpand</span><span class="hl-quotes">&quot;</span><span class="hl-code">, </span><span class="hl-reserved">this</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">typeAheadEvent</span><span class="hl-code"> = </span><span class="hl-reserved">new </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">CustomEvent</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">typeAhead</span><span class="hl-quotes">&quot;</span><span class="hl-code">, </span><span class="hl-reserved">this</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">itemMouseOverEvent</span><span class="hl-code"> = </span><span class="hl-reserved">new </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">CustomEvent</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">itemMouseOver</span><span class="hl-quotes">&quot;</span><span class="hl-code">, </span><span class="hl-reserved">this</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">itemMouseOutEvent</span><span class="hl-code"> = </span><span class="hl-reserved">new </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">CustomEvent</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">itemMouseOut</span><span class="hl-quotes">&quot;</span><span class="hl-code">, </span><span class="hl-reserved">this</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">itemArrowToEvent</span><span class="hl-code"> = </span><span class="hl-reserved">new </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">CustomEvent</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">itemArrowTo</span><span class="hl-quotes">&quot;</span><span class="hl-code">, </span><span class="hl-reserved">this</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">itemArrowFromEvent</span><span class="hl-code"> = </span><span class="hl-reserved">new </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">CustomEvent</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">itemArrowFrom</span><span class="hl-quotes">&quot;</span><span class="hl-code">, </span><span class="hl-reserved">this</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">itemSelectEvent</span><span class="hl-code"> = </span><span class="hl-reserved">new </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">CustomEvent</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">itemSelect</span><span class="hl-quotes">&quot;</span><span class="hl-code">, </span><span class="hl-reserved">this</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">unmatchedItemSelectEvent</span><span class="hl-code"> = </span><span class="hl-reserved">new </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">CustomEvent</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">unmatchedItemSelect</span><span class="hl-quotes">&quot;</span><span class="hl-code">, </span><span class="hl-reserved">this</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">selectionEnforceEvent</span><span class="hl-code"> = </span><span class="hl-reserved">new </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">CustomEvent</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">selectionEnforce</span><span class="hl-quotes">&quot;</span><span class="hl-code">, </span><span class="hl-reserved">this</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">containerCollapseEvent</span><span class="hl-code"> = </span><span class="hl-reserved">new </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">CustomEvent</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">containerCollapse</span><span class="hl-quotes">&quot;</span><span class="hl-code">, </span><span class="hl-reserved">this</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">textboxBlurEvent</span><span class="hl-code"> = </span><span class="hl-reserved">new </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">CustomEvent</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">textboxBlur</span><span class="hl-quotes">&quot;</span><span class="hl-code">, </span><span class="hl-reserved">this</span><span class="hl-brackets">)</span><span class="hl-code">;
        
        </span><span class="hl-comment">// Finish up
        </span><span class="hl-identifier">oTextbox</span><span class="hl-code">.</span><span class="hl-identifier">setAttribute</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">autocomplete</span><span class="hl-quotes">&quot;</span><span class="hl-code">,</span><span class="hl-quotes">&quot;</span><span class="hl-string">off</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">widget</span><span class="hl-code">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-code">.</span><span class="hl-identifier">_nIndex</span><span class="hl-code">++;
    </span><span class="hl-brackets">}
    </span><span class="hl-comment">// Required arguments were not found
    </span><span class="hl-reserved">else </span><span class="hl-brackets">{
    }
}</span><span class="hl-default">;

</span><span class="hl-comment">/////////////////////////////////////////////////////////////////////////////
//
// Public member variables
//
/////////////////////////////////////////////////////////////////////////////

/**
 * The DataSource object that encapsulates the data used for auto completion.
 * This object should be an inherited object from YAHOO.widget.DataSource.
 *
 * @property dataSource
 * @type Object
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">dataSource</span><span class="hl-default"> = </span><span class="hl-reserved">null</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Number of characters that must be entered before querying for results. A negative value
 * effectively turns off the widget. A value of 0 allows queries of null or empty string
 * values.
 *
 * @property minQueryLength
 * @type Number
 * @default 1
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">minQueryLength</span><span class="hl-default"> = </span><span class="hl-number">1</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Maximum number of results to display in results container.
 *
 * @property maxResultsDisplayed
 * @type Number
 * @default 10
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">maxResultsDisplayed</span><span class="hl-default"> = </span><span class="hl-number">10</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Number of seconds to delay before submitting a query request.  If a query
 * request is received before a previous one has completed its delay, the
 * previous request is cancelled and the new request is set to the delay.
 *
 * @property queryDelay
 * @type Number
 * @default 0.5
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">queryDelay</span><span class="hl-default"> = </span><span class="hl-number">0.5</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Class name of a highlighted item within results container.
 *
 * @property highlighClassName
 * @type String
 * @default &quot;yui-ac-highlight&quot;
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">highlightClassName</span><span class="hl-default"> = </span><span class="hl-quotes">&quot;</span><span class="hl-string">yui-ac-highlight</span><span class="hl-quotes">&quot;</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Class name of a pre-highlighted item within results container.
 *
 * @property prehighlightClassName
 * @type String
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">prehighlightClassName</span><span class="hl-default"> = </span><span class="hl-reserved">null</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Query delimiter. A single character separator for multiple delimited
 * selections. Multiple delimiter characteres may be defined as an array of
 * strings. A null value or empty string indicates that query results cannot
 * be delimited. This feature is not recommended if you need forceSelection to
 * be true.
 *
 * @property delimChar
 * @type String | String[]
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">delimChar</span><span class="hl-default"> = </span><span class="hl-reserved">null</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Whether or not the first item in results container should be automatically highlighted
 * on expand.
 *
 * @property autoHighlight
 * @type Boolean
 * @default true
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">autoHighlight</span><span class="hl-default"> = </span><span class="hl-reserved">true</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Whether or not the input field should be automatically updated
 * with the first query result as the user types, auto-selecting the substring
 * that the user has not typed.
 *
 * @property typeAhead
 * @type Boolean
 * @default false
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">typeAhead</span><span class="hl-default"> = </span><span class="hl-reserved">false</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Whether or not to animate the expansion/collapse of the results container in the
 * horizontal direction.
 *
 * @property animHoriz
 * @type Boolean
 * @default false
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">animHoriz</span><span class="hl-default"> = </span><span class="hl-reserved">false</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Whether or not to animate the expansion/collapse of the results container in the
 * vertical direction.
 *
 * @property animVert
 * @type Boolean
 * @default true
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">animVert</span><span class="hl-default"> = </span><span class="hl-reserved">true</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Speed of container expand/collapse animation, in seconds..
 *
 * @property animSpeed
 * @type Number
 * @default 0.3
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">animSpeed</span><span class="hl-default"> = </span><span class="hl-number">0.3</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Whether or not to force the user's selection to match one of the query
 * results. Enabling this feature essentially transforms the input field into a
 * &amp;lt;select&amp;gt; field. This feature is not recommended with delimiter character(s)
 * defined.
 *
 * @property forceSelection
 * @type Boolean
 * @default false
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">forceSelection</span><span class="hl-default"> = </span><span class="hl-reserved">false</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Whether or not to allow browsers to cache user-typed input in the input
 * field. Disabling this feature will prevent the widget from setting the
 * autocomplete=&quot;off&quot; on the input field. When autocomplete=&quot;off&quot;
 * and users click the back button after form submission, user-typed input can
 * be prefilled by the browser from its cache. This caching of user input may
 * not be desired for sensitive data, such as credit card numbers, in which
 * case, implementers should consider setting allowBrowserAutocomplete to false.
 *
 * @property allowBrowserAutocomplete
 * @type Boolean
 * @default true
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">allowBrowserAutocomplete</span><span class="hl-default"> = </span><span class="hl-reserved">true</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Whether or not the results container should always be displayed.
 * Enabling this feature displays the container when the widget is instantiated
 * and prevents the toggling of the container to a collapsed state.
 *
 * @property alwaysShowContainer
 * @type Boolean
 * @default false
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">alwaysShowContainer</span><span class="hl-default"> = </span><span class="hl-reserved">false</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Whether or not to use an iFrame to layer over Windows form elements in
 * IE. Set to true only when the results container will be on top of a
 * &amp;lt;select&amp;gt; field in IE and thus exposed to the IE z-index bug (i.e.,
 * 5.5 &lt; IE &lt; 7).
 *
 * @property useIFrame
 * @type Boolean
 * @default false
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">useIFrame</span><span class="hl-default"> = </span><span class="hl-reserved">false</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Whether or not the results container should have a shadow.
 *
 * @property useShadow
 * @type Boolean
 * @default false
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">useShadow</span><span class="hl-default"> = </span><span class="hl-reserved">false</span><span class="hl-default">;

</span><span class="hl-comment">/////////////////////////////////////////////////////////////////////////////
//
// Public methods
//
/////////////////////////////////////////////////////////////////////////////

 /**
 * Public accessor to the unique name of the AutoComplete instance.
 *
 * @method toString
 * @return {String} Unique name of the AutoComplete instance.
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">toString</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">() {
    </span><span class="hl-reserved">return </span><span class="hl-quotes">&quot;</span><span class="hl-string">AutoComplete </span><span class="hl-quotes">&quot;</span><span class="hl-code"> + </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_sName</span><span class="hl-code">;
</span><span class="hl-brackets">}</span><span class="hl-default">;

 </span><span class="hl-comment">/**
 * Returns true if container is in an expanded state, false otherwise.
 *
 * @method isContainerOpen
 * @return {Boolean} Returns true if container is in an expanded state, false otherwise.
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">isContainerOpen</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">() {
    </span><span class="hl-reserved">return this</span><span class="hl-code">.</span><span class="hl-identifier">_bContainerOpen</span><span class="hl-code">;
</span><span class="hl-brackets">}</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Public accessor to the internal array of DOM &amp;lt;li&amp;gt; elements that
 * display query results within the results container.
 *
 * @method getListItems
 * @return {HTMLElement[]} Array of &amp;lt;li&amp;gt; elements within the results container.
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">getListItems</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">() {
    </span><span class="hl-reserved">return this</span><span class="hl-code">.</span><span class="hl-identifier">_aListItems</span><span class="hl-code">;
</span><span class="hl-brackets">}</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Public accessor to the data held in an &amp;lt;li&amp;gt; element of the
 * results container.
 *
 * @method getListItemData
 * @return {Object | Array} Object or array of result data or null
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">getListItemData</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">(</span><span class="hl-identifier">oListItem</span><span class="hl-brackets">) {
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">oListItem</span><span class="hl-code">.</span><span class="hl-identifier">_oResultData</span><span class="hl-brackets">) {
        </span><span class="hl-reserved">return </span><span class="hl-identifier">oListItem</span><span class="hl-code">.</span><span class="hl-identifier">_oResultData</span><span class="hl-code">;
    </span><span class="hl-brackets">}
    </span><span class="hl-reserved">else </span><span class="hl-brackets">{
        </span><span class="hl-reserved">return false</span><span class="hl-code">;
    </span><span class="hl-brackets">}
}</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Sets HTML markup for the results container header. This markup will be
 * inserted within a &amp;lt;div&amp;gt; tag with a class of &quot;ac_hd&quot;.
 *
 * @method setHeader
 * @param sHeader {String} HTML markup for results container header.
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">setHeader</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">(</span><span class="hl-identifier">sHeader</span><span class="hl-brackets">) {
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">sHeader</span><span class="hl-brackets">) {
        </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oContent</span><span class="hl-code">.</span><span class="hl-identifier">_oHeader</span><span class="hl-brackets">) {
            </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oContent</span><span class="hl-code">.</span><span class="hl-identifier">_oHeader</span><span class="hl-code">.</span><span class="hl-identifier">innerHTML</span><span class="hl-code"> = </span><span class="hl-identifier">sHeader</span><span class="hl-code">;
            </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oContent</span><span class="hl-code">.</span><span class="hl-identifier">_oHeader</span><span class="hl-code">.</span><span class="hl-identifier">style</span><span class="hl-code">.</span><span class="hl-identifier">display</span><span class="hl-code"> = </span><span class="hl-quotes">&quot;</span><span class="hl-string">block</span><span class="hl-quotes">&quot;</span><span class="hl-code">;
        </span><span class="hl-brackets">}
    }
    </span><span class="hl-reserved">else </span><span class="hl-brackets">{
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oContent</span><span class="hl-code">.</span><span class="hl-identifier">_oHeader</span><span class="hl-code">.</span><span class="hl-identifier">innerHTML</span><span class="hl-code"> = </span><span class="hl-quotes">&quot;&quot;</span><span class="hl-code">;
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oContent</span><span class="hl-code">.</span><span class="hl-identifier">_oHeader</span><span class="hl-code">.</span><span class="hl-identifier">style</span><span class="hl-code">.</span><span class="hl-identifier">display</span><span class="hl-code"> = </span><span class="hl-quotes">&quot;</span><span class="hl-string">none</span><span class="hl-quotes">&quot;</span><span class="hl-code">;
    </span><span class="hl-brackets">}
}</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Sets HTML markup for the results container footer. This markup will be
 * inserted within a &amp;lt;div&amp;gt; tag with a class of &quot;ac_ft&quot;.
 *
 * @method setFooter
 * @param sFooter {String} HTML markup for results container footer.
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">setFooter</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">(</span><span class="hl-identifier">sFooter</span><span class="hl-brackets">) {
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">sFooter</span><span class="hl-brackets">) {
        </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oContent</span><span class="hl-code">.</span><span class="hl-identifier">_oFooter</span><span class="hl-brackets">) {
            </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oContent</span><span class="hl-code">.</span><span class="hl-identifier">_oFooter</span><span class="hl-code">.</span><span class="hl-identifier">innerHTML</span><span class="hl-code"> = </span><span class="hl-identifier">sFooter</span><span class="hl-code">;
            </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oContent</span><span class="hl-code">.</span><span class="hl-identifier">_oFooter</span><span class="hl-code">.</span><span class="hl-identifier">style</span><span class="hl-code">.</span><span class="hl-identifier">display</span><span class="hl-code"> = </span><span class="hl-quotes">&quot;</span><span class="hl-string">block</span><span class="hl-quotes">&quot;</span><span class="hl-code">;
        </span><span class="hl-brackets">}
    }
    </span><span class="hl-reserved">else </span><span class="hl-brackets">{
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oContent</span><span class="hl-code">.</span><span class="hl-identifier">_oFooter</span><span class="hl-code">.</span><span class="hl-identifier">innerHTML</span><span class="hl-code"> = </span><span class="hl-quotes">&quot;&quot;</span><span class="hl-code">;
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oContent</span><span class="hl-code">.</span><span class="hl-identifier">_oFooter</span><span class="hl-code">.</span><span class="hl-identifier">style</span><span class="hl-code">.</span><span class="hl-identifier">display</span><span class="hl-code"> = </span><span class="hl-quotes">&quot;</span><span class="hl-string">none</span><span class="hl-quotes">&quot;</span><span class="hl-code">;
    </span><span class="hl-brackets">}
}</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Sets HTML markup for the results container body. This markup will be
 * inserted within a &amp;lt;div&amp;gt; tag with a class of &quot;ac_bd&quot;.
 *
 * @method setBody
 * @param sHeader {String} HTML markup for results container body.
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">setBody</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">(</span><span class="hl-identifier">sBody</span><span class="hl-brackets">) {
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">sBody</span><span class="hl-brackets">) {
        </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oContent</span><span class="hl-code">.</span><span class="hl-identifier">_oBody</span><span class="hl-brackets">) {
            </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oContent</span><span class="hl-code">.</span><span class="hl-identifier">_oBody</span><span class="hl-code">.</span><span class="hl-identifier">innerHTML</span><span class="hl-code"> = </span><span class="hl-identifier">sBody</span><span class="hl-code">;
            </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oContent</span><span class="hl-code">.</span><span class="hl-identifier">_oBody</span><span class="hl-code">.</span><span class="hl-identifier">style</span><span class="hl-code">.</span><span class="hl-identifier">display</span><span class="hl-code"> = </span><span class="hl-quotes">&quot;</span><span class="hl-string">block</span><span class="hl-quotes">&quot;</span><span class="hl-code">;
            </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oContent</span><span class="hl-code">.</span><span class="hl-identifier">style</span><span class="hl-code">.</span><span class="hl-identifier">display</span><span class="hl-code"> = </span><span class="hl-quotes">&quot;</span><span class="hl-string">block</span><span class="hl-quotes">&quot;</span><span class="hl-code">;
        </span><span class="hl-brackets">}
    }
    </span><span class="hl-reserved">else </span><span class="hl-brackets">{
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oContent</span><span class="hl-code">.</span><span class="hl-identifier">_oBody</span><span class="hl-code">.</span><span class="hl-identifier">innerHTML</span><span class="hl-code"> = </span><span class="hl-quotes">&quot;&quot;</span><span class="hl-code">;
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oContent</span><span class="hl-code">.</span><span class="hl-identifier">style</span><span class="hl-code">.</span><span class="hl-identifier">display</span><span class="hl-code"> = </span><span class="hl-quotes">&quot;</span><span class="hl-string">none</span><span class="hl-quotes">&quot;</span><span class="hl-code">;
    </span><span class="hl-brackets">}
    </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_maxResultsDisplayed</span><span class="hl-code"> = </span><span class="hl-number">0</span><span class="hl-code">;
</span><span class="hl-brackets">}</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Overridable method that converts a result item object into HTML markup
 * for display. Return data values are accessible via the oResultItem object,
 * and the key return value will always be oResultItem[0]. Markup will be
 * displayed within &amp;lt;li&amp;gt; element tags in the container.
 *
 * @method formatResult
 * @param oResultItem {Object} Result item representing one query result. Data is held in an array.
 * @param sQuery {String} The current query string.
 * @return {String} HTML markup of formatted result data.
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">formatResult</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">(</span><span class="hl-identifier">oResultItem</span><span class="hl-code">, </span><span class="hl-identifier">sQuery</span><span class="hl-brackets">) {
    </span><span class="hl-reserved">var </span><span class="hl-identifier">sResult</span><span class="hl-code"> = </span><span class="hl-identifier">oResultItem</span><span class="hl-brackets">[</span><span class="hl-number">0</span><span class="hl-brackets">]</span><span class="hl-code">;
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">sResult</span><span class="hl-brackets">) {
        </span><span class="hl-reserved">return </span><span class="hl-identifier">sResult</span><span class="hl-code">;
    </span><span class="hl-brackets">}
    </span><span class="hl-reserved">else </span><span class="hl-brackets">{
        </span><span class="hl-reserved">return </span><span class="hl-quotes">&quot;&quot;</span><span class="hl-code">;
    </span><span class="hl-brackets">}
}</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Overridable method called before container expands allows implementers to access data
 * and DOM elements.
 *
 * @method doBeforeExpandContainer
 * @return {Boolean} Return true to continue expanding container, false to cancel the expand.
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">doBeforeExpandContainer</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">(</span><span class="hl-identifier">oResultItem</span><span class="hl-code">, </span><span class="hl-identifier">sQuery</span><span class="hl-brackets">) {
    </span><span class="hl-reserved">return true</span><span class="hl-code">;
</span><span class="hl-brackets">}</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Makes query request to the DataSource.
 *
 * @method sendQuery
 * @param sQuery {String} Query string.
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">sendQuery</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">(</span><span class="hl-identifier">sQuery</span><span class="hl-brackets">) {
    </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_sendQuery</span><span class="hl-brackets">(</span><span class="hl-identifier">sQuery</span><span class="hl-brackets">)</span><span class="hl-code">;
</span><span class="hl-brackets">}</span><span class="hl-default">;

</span><span class="hl-comment">/////////////////////////////////////////////////////////////////////////////
//
// Public events
//
/////////////////////////////////////////////////////////////////////////////

/**
 * Fired when the input field receives focus.
 *
 * @event textboxFocusEvent
 * @param oSelf {Object} The AutoComplete instance.
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">textboxFocusEvent</span><span class="hl-default"> = </span><span class="hl-reserved">null</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Fired when the input field receives key input.
 *
 * @event textboxKeyEvent
 * @param oSelf {Object} The AutoComplete instance.
 * @param nKeycode {Number} The keycode number.
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">textboxKeyEvent</span><span class="hl-default"> = </span><span class="hl-reserved">null</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Fired when the AutoComplete instance makes a query to the DataSource.
 * 
 * @event dataRequestEvent
 * @param oSelf {Object} The AutoComplete instance.
 * @param sQuery {String} The query string.
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">dataRequestEvent</span><span class="hl-default"> = </span><span class="hl-reserved">null</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Fired when the AutoComplete instance receives query results from the data
 * source.
 *
 * @event dataReturnEvent
 * @param oSelf {Object} The AutoComplete instance.
 * @param sQuery {String} The query string.
 * @param aResults {Array} Results array.
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">dataReturnEvent</span><span class="hl-default"> = </span><span class="hl-reserved">null</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Fired when the AutoComplete instance does not receive query results from the
 * DataSource due to an error.
 *
 * @event dataErrorEvent
 * @param oSelf {Object} The AutoComplete instance.
 * @param sQuery {String} The query string.
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">dataErrorEvent</span><span class="hl-default"> = </span><span class="hl-reserved">null</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Fired when the results container is expanded.
 *
 * @event containerExpandEvent
 * @param oSelf {Object} The AutoComplete instance.
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">containerExpandEvent</span><span class="hl-default"> = </span><span class="hl-reserved">null</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Fired when the input field has been prefilled by the type-ahead
 * feature. 
 *
 * @event typeAheadEvent
 * @param oSelf {Object} The AutoComplete instance.
 * @param sQuery {String} The query string.
 * @param sPrefill {String} The prefill string.
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">typeAheadEvent</span><span class="hl-default"> = </span><span class="hl-reserved">null</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Fired when result item has been moused over.
 *
 * @event itemMouseOverEvent
 * @param oSelf {Object} The AutoComplete instance.
 * @param elItem {HTMLElement} The &amp;lt;li&amp;gt element item moused to.
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">itemMouseOverEvent</span><span class="hl-default"> = </span><span class="hl-reserved">null</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Fired when result item has been moused out.
 *
 * @event itemMouseOutEvent
 * @param oSelf {Object} The AutoComplete instance.
 * @param elItem {HTMLElement} The &amp;lt;li&amp;gt; element item moused from.
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">itemMouseOutEvent</span><span class="hl-default"> = </span><span class="hl-reserved">null</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Fired when result item has been arrowed to. 
 *
 * @event itemArrowToEvent
 * @param oSelf {Object} The AutoComplete instance.
 * @param elItem {HTMLElement} The &amp;lt;li&amp;gt; element item arrowed to.
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">itemArrowToEvent</span><span class="hl-default"> = </span><span class="hl-reserved">null</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Fired when result item has been arrowed away from.
 *
 * @event itemArrowFromEvent
 * @param oSelf {Object} The AutoComplete instance.
 * @param elItem {HTMLElement} The &amp;lt;li&amp;gt; element item arrowed from.
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">itemArrowFromEvent</span><span class="hl-default"> = </span><span class="hl-reserved">null</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Fired when an item is selected via mouse click, ENTER key, or TAB key.
 *
 * @event itemSelectEvent
 * @param oSelf {Object} The AutoComplete instance.
 * @param elItem {HTMLElement} The selected &amp;lt;li&amp;gt; element item.
 * @param oData {Object} The data returned for the item, either as an object,
 * or mapped from the schema into an array.
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">itemSelectEvent</span><span class="hl-default"> = </span><span class="hl-reserved">null</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Fired when a user selection does not match any of the displayed result items.
 * Note that this event may not behave as expected when delimiter characters
 * have been defined. 
 *
 * @event unmatchedItemSelectEvent
 * @param oSelf {Object} The AutoComplete instance.
 * @param sQuery {String} The user-typed query string.
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">unmatchedItemSelectEvent</span><span class="hl-default"> = </span><span class="hl-reserved">null</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Fired if forceSelection is enabled and the user's input has been cleared
 * because it did not match one of the returned query results.
 *
 * @event selectionEnforceEvent
 * @param oSelf {Object} The AutoComplete instance.
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">selectionEnforceEvent</span><span class="hl-default"> = </span><span class="hl-reserved">null</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Fired when the results container is collapsed.
 *
 * @event containerCollapseEvent
 * @param oSelf {Object} The AutoComplete instance.
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">containerCollapseEvent</span><span class="hl-default"> = </span><span class="hl-reserved">null</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Fired when the input field loses focus.
 *
 * @event textboxBlurEvent
 * @param oSelf {Object} The AutoComplete instance.
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">textboxBlurEvent</span><span class="hl-default"> = </span><span class="hl-reserved">null</span><span class="hl-default">;

</span><span class="hl-comment">/////////////////////////////////////////////////////////////////////////////
//
// Private member variables
//
/////////////////////////////////////////////////////////////////////////////

/**
 * Internal class variable to index multiple AutoComplete instances.
 *
 * @property _nIndex
 * @type Number
 * @default 0
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">_nIndex</span><span class="hl-default"> = </span><span class="hl-number">0</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Name of AutoComplete instance.
 *
 * @property _sName
 * @type String
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_sName</span><span class="hl-default"> = </span><span class="hl-reserved">null</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Text input field DOM element.
 *
 * @property _oTextbox
 * @type HTMLElement
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_oTextbox</span><span class="hl-default"> = </span><span class="hl-reserved">null</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Whether or not the input field is currently in focus. If query results come back
 * but the user has already moved on, do not proceed with auto complete behavior.
 *
 * @property _bFocused
 * @type Boolean
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_bFocused</span><span class="hl-default"> = </span><span class="hl-reserved">true</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Animation instance for container expand/collapse.
 *
 * @property _oAnim
 * @type Boolean
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_oAnim</span><span class="hl-default"> = </span><span class="hl-reserved">null</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Container DOM element.
 *
 * @property _oContainer
 * @type HTMLElement
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_oContainer</span><span class="hl-default"> = </span><span class="hl-reserved">null</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Whether or not the results container is currently open.
 *
 * @property _bContainerOpen
 * @type Boolean
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_bContainerOpen</span><span class="hl-default"> = </span><span class="hl-reserved">false</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Whether or not the mouse is currently over the results
 * container. This is necessary in order to prevent clicks on container items
 * from being text input field blur events.
 *
 * @property _bOverContainer
 * @type Boolean
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_bOverContainer</span><span class="hl-default"> = </span><span class="hl-reserved">false</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Array of &amp;lt;li&amp;gt; elements references that contain query results within the
 * results container.
 *
 * @property _aListItems
 * @type Array
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_aListItems</span><span class="hl-default"> = </span><span class="hl-reserved">null</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Number of &amp;lt;li&amp;gt; elements currently displayed in results container.
 *
 * @property _nDisplayedItems
 * @type Number
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_nDisplayedItems</span><span class="hl-default"> = </span><span class="hl-number">0</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Internal count of &amp;lt;li&amp;gt; elements displayed and hidden in results container.
 *
 * @property _maxResultsDisplayed
 * @type Number
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_maxResultsDisplayed</span><span class="hl-default"> = </span><span class="hl-number">0</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Current query string
 *
 * @property _sCurQuery
 * @type String
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_sCurQuery</span><span class="hl-default"> = </span><span class="hl-reserved">null</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Past queries this session (for saving delimited queries).
 *
 * @property _sSavedQuery
 * @type String
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_sSavedQuery</span><span class="hl-default"> = </span><span class="hl-reserved">null</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Pointer to the currently highlighted &amp;lt;li&amp;gt; element in the container.
 *
 * @property _oCurItem
 * @type HTMLElement
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_oCurItem</span><span class="hl-default"> = </span><span class="hl-reserved">null</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Whether or not an item has been selected since the container was populated
 * with results. Reset to false by _populateList, and set to true when item is
 * selected.
 *
 * @property _bItemSelected
 * @type Boolean
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_bItemSelected</span><span class="hl-default"> = </span><span class="hl-reserved">false</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Key code of the last key pressed in textbox.
 *
 * @property _nKeyCode
 * @type Number
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_nKeyCode</span><span class="hl-default"> = </span><span class="hl-reserved">null</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Delay timeout ID.
 *
 * @property _nDelayID
 * @type Number
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_nDelayID</span><span class="hl-default"> = -</span><span class="hl-number">1</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Src to iFrame used when useIFrame = true. Supports implementations over SSL
 * as well.
 *
 * @property _iFrameSrc
 * @type String
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_iFrameSrc</span><span class="hl-default"> = </span><span class="hl-quotes">&quot;</span><span class="hl-string">javascript:false;</span><span class="hl-quotes">&quot;</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * For users typing via certain IMEs, queries must be triggered by intervals,
 * since key events yet supported across all browsers for all IMEs.
 *
 * @property _queryInterval
 * @type Object
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_queryInterval</span><span class="hl-default"> = </span><span class="hl-reserved">null</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Internal tracker to last known textbox value, used to determine whether or not
 * to trigger a query via interval for certain IME users.
 *
 * @event _sLastTextboxValue
 * @type String
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_sLastTextboxValue</span><span class="hl-default"> = </span><span class="hl-reserved">null</span><span class="hl-default">;

</span><span class="hl-comment">/////////////////////////////////////////////////////////////////////////////
//
// Private methods
//
/////////////////////////////////////////////////////////////////////////////

/**
 * Updates and validates latest public config properties.
 *
 * @method __initProps
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_initProps</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">() {
    </span><span class="hl-comment">// Correct any invalid values
    </span><span class="hl-reserved">var </span><span class="hl-identifier">minQueryLength</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">minQueryLength</span><span class="hl-code">;
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">isNaN</span><span class="hl-brackets">(</span><span class="hl-identifier">minQueryLength</span><span class="hl-brackets">)</span><span class="hl-code"> || </span><span class="hl-brackets">(</span><span class="hl-identifier">minQueryLength</span><span class="hl-code"> &lt; </span><span class="hl-number">1</span><span class="hl-brackets">)) {
        </span><span class="hl-identifier">minQueryLength</span><span class="hl-code"> = </span><span class="hl-number">1</span><span class="hl-code">;
    </span><span class="hl-brackets">}
    </span><span class="hl-reserved">var </span><span class="hl-identifier">maxResultsDisplayed</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">maxResultsDisplayed</span><span class="hl-code">;
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">isNaN</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">maxResultsDisplayed</span><span class="hl-brackets">)</span><span class="hl-code"> || </span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">maxResultsDisplayed</span><span class="hl-code"> &lt; </span><span class="hl-number">1</span><span class="hl-brackets">)) {
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">maxResultsDisplayed</span><span class="hl-code"> = </span><span class="hl-number">10</span><span class="hl-code">;
    </span><span class="hl-brackets">}
    </span><span class="hl-reserved">var </span><span class="hl-identifier">queryDelay</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">queryDelay</span><span class="hl-code">;
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">isNaN</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">queryDelay</span><span class="hl-brackets">)</span><span class="hl-code"> || </span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">queryDelay</span><span class="hl-code"> &lt; </span><span class="hl-number">0</span><span class="hl-brackets">)) {
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">queryDelay</span><span class="hl-code"> = </span><span class="hl-number">0.5</span><span class="hl-code">;
    </span><span class="hl-brackets">}
    </span><span class="hl-reserved">var </span><span class="hl-identifier">aDelimChar</span><span class="hl-code"> = </span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">delimChar</span><span class="hl-brackets">)</span><span class="hl-code"> ? </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">delimChar</span><span class="hl-code"> : </span><span class="hl-reserved">null</span><span class="hl-code">;
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">aDelimChar</span><span class="hl-brackets">) {
        </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-reserved">typeof </span><span class="hl-identifier">aDelimChar</span><span class="hl-code"> == </span><span class="hl-quotes">&quot;</span><span class="hl-string">string</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">) {
            </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">delimChar</span><span class="hl-code"> = </span><span class="hl-brackets">[</span><span class="hl-identifier">aDelimChar</span><span class="hl-brackets">]</span><span class="hl-code">;
        </span><span class="hl-brackets">}
        </span><span class="hl-reserved">else if</span><span class="hl-brackets">(</span><span class="hl-identifier">aDelimChar</span><span class="hl-code">.</span><span class="hl-identifier">constructor</span><span class="hl-code"> != </span><span class="hl-builtin">Array</span><span class="hl-brackets">) {
            </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">delimChar</span><span class="hl-code"> = </span><span class="hl-reserved">null</span><span class="hl-code">;
        </span><span class="hl-brackets">}
    }
    </span><span class="hl-reserved">var </span><span class="hl-identifier">animSpeed</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">animSpeed</span><span class="hl-code">;
    </span><span class="hl-reserved">if</span><span class="hl-brackets">((</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">animHoriz</span><span class="hl-code"> || </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">animVert</span><span class="hl-brackets">)</span><span class="hl-code"> &amp;&amp; </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">Anim</span><span class="hl-brackets">) {
        </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">isNaN</span><span class="hl-brackets">(</span><span class="hl-identifier">animSpeed</span><span class="hl-brackets">)</span><span class="hl-code"> || </span><span class="hl-brackets">(</span><span class="hl-identifier">animSpeed</span><span class="hl-code"> &lt; </span><span class="hl-number">0</span><span class="hl-brackets">)) {
            </span><span class="hl-identifier">animSpeed</span><span class="hl-code"> = </span><span class="hl-number">0.3</span><span class="hl-code">;
        </span><span class="hl-brackets">}
        </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-code">!</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oAnim </span><span class="hl-brackets">) {
            </span><span class="hl-identifier">oAnim</span><span class="hl-code"> = </span><span class="hl-reserved">new </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">Anim</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oContent</span><span class="hl-code">, </span><span class="hl-brackets">{}</span><span class="hl-code">, </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">animSpeed</span><span class="hl-brackets">)</span><span class="hl-code">;
            </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oAnim</span><span class="hl-code"> = </span><span class="hl-identifier">oAnim</span><span class="hl-code">;
        </span><span class="hl-brackets">}
        </span><span class="hl-reserved">else </span><span class="hl-brackets">{
            </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oAnim</span><span class="hl-code">.</span><span class="hl-identifier">duration</span><span class="hl-code"> = </span><span class="hl-identifier">animSpeed</span><span class="hl-code">;
        </span><span class="hl-brackets">}
    }
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">forceSelection</span><span class="hl-code"> &amp;&amp; </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">delimChar</span><span class="hl-brackets">) {
    }
}</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Initializes the results container helpers if they are enabled and do
 * not exist
 *
 * @method _initContainerHelpers
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_initContainerHelpers</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">() {
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">useShadow</span><span class="hl-code"> &amp;&amp; !</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oShadow</span><span class="hl-brackets">) {
        </span><span class="hl-reserved">var </span><span class="hl-identifier">oShadow</span><span class="hl-code"> = </span><span class="hl-builtin">document</span><span class="hl-code">.</span><span class="hl-identifier">createElement</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">div</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-identifier">oShadow</span><span class="hl-code">.</span><span class="hl-identifier">className</span><span class="hl-code"> = </span><span class="hl-quotes">&quot;</span><span class="hl-string">yui-ac-shadow</span><span class="hl-quotes">&quot;</span><span class="hl-code">;
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oShadow</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">appendChild</span><span class="hl-brackets">(</span><span class="hl-identifier">oShadow</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-brackets">}
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">useIFrame</span><span class="hl-code"> &amp;&amp; !</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oIFrame</span><span class="hl-brackets">) {
        </span><span class="hl-reserved">var </span><span class="hl-identifier">oIFrame</span><span class="hl-code"> = </span><span class="hl-builtin">document</span><span class="hl-code">.</span><span class="hl-identifier">createElement</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">iframe</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-identifier">oIFrame</span><span class="hl-code">.</span><span class="hl-identifier">src</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_iFrameSrc</span><span class="hl-code">;
        </span><span class="hl-identifier">oIFrame</span><span class="hl-code">.</span><span class="hl-identifier">frameBorder</span><span class="hl-code"> = </span><span class="hl-number">0</span><span class="hl-code">;
        </span><span class="hl-identifier">oIFrame</span><span class="hl-code">.</span><span class="hl-identifier">scrolling</span><span class="hl-code"> = </span><span class="hl-quotes">&quot;</span><span class="hl-string">no</span><span class="hl-quotes">&quot;</span><span class="hl-code">;
        </span><span class="hl-identifier">oIFrame</span><span class="hl-code">.</span><span class="hl-identifier">style</span><span class="hl-code">.</span><span class="hl-identifier">position</span><span class="hl-code"> = </span><span class="hl-quotes">&quot;</span><span class="hl-string">absolute</span><span class="hl-quotes">&quot;</span><span class="hl-code">;
        </span><span class="hl-identifier">oIFrame</span><span class="hl-code">.</span><span class="hl-identifier">style</span><span class="hl-code">.</span><span class="hl-identifier">width</span><span class="hl-code"> = </span><span class="hl-quotes">&quot;</span><span class="hl-string">100%</span><span class="hl-quotes">&quot;</span><span class="hl-code">;
        </span><span class="hl-identifier">oIFrame</span><span class="hl-code">.</span><span class="hl-identifier">style</span><span class="hl-code">.</span><span class="hl-identifier">height</span><span class="hl-code"> = </span><span class="hl-quotes">&quot;</span><span class="hl-string">100%</span><span class="hl-quotes">&quot;</span><span class="hl-code">;
        </span><span class="hl-identifier">oIFrame</span><span class="hl-code">.</span><span class="hl-identifier">tabIndex</span><span class="hl-code"> = -</span><span class="hl-number">1</span><span class="hl-code">;
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oIFrame</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">appendChild</span><span class="hl-brackets">(</span><span class="hl-identifier">oIFrame</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-brackets">}
}</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Initializes the results container once at object creation
 *
 * @method _initContainer
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_initContainer</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">() {
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-code">!</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oContent</span><span class="hl-brackets">) {
        </span><span class="hl-comment">// The oContent div helps size the iframe and shadow properly
        </span><span class="hl-reserved">var </span><span class="hl-identifier">oContent</span><span class="hl-code"> = </span><span class="hl-builtin">document</span><span class="hl-code">.</span><span class="hl-identifier">createElement</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">div</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-identifier">oContent</span><span class="hl-code">.</span><span class="hl-identifier">className</span><span class="hl-code"> = </span><span class="hl-quotes">&quot;</span><span class="hl-string">yui-ac-content</span><span class="hl-quotes">&quot;</span><span class="hl-code">;
        </span><span class="hl-identifier">oContent</span><span class="hl-code">.</span><span class="hl-identifier">style</span><span class="hl-code">.</span><span class="hl-identifier">display</span><span class="hl-code"> = </span><span class="hl-quotes">&quot;</span><span class="hl-string">none</span><span class="hl-quotes">&quot;</span><span class="hl-code">;
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oContent</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">appendChild</span><span class="hl-brackets">(</span><span class="hl-identifier">oContent</span><span class="hl-brackets">)</span><span class="hl-code">;

        </span><span class="hl-reserved">var </span><span class="hl-identifier">oHeader</span><span class="hl-code"> = </span><span class="hl-builtin">document</span><span class="hl-code">.</span><span class="hl-identifier">createElement</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">div</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-identifier">oHeader</span><span class="hl-code">.</span><span class="hl-identifier">className</span><span class="hl-code"> = </span><span class="hl-quotes">&quot;</span><span class="hl-string">yui-ac-hd</span><span class="hl-quotes">&quot;</span><span class="hl-code">;
        </span><span class="hl-identifier">oHeader</span><span class="hl-code">.</span><span class="hl-identifier">style</span><span class="hl-code">.</span><span class="hl-identifier">display</span><span class="hl-code"> = </span><span class="hl-quotes">&quot;</span><span class="hl-string">none</span><span class="hl-quotes">&quot;</span><span class="hl-code">;
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oContent</span><span class="hl-code">.</span><span class="hl-identifier">_oHeader</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oContent</span><span class="hl-code">.</span><span class="hl-identifier">appendChild</span><span class="hl-brackets">(</span><span class="hl-identifier">oHeader</span><span class="hl-brackets">)</span><span class="hl-code">;

        </span><span class="hl-reserved">var </span><span class="hl-identifier">oBody</span><span class="hl-code"> = </span><span class="hl-builtin">document</span><span class="hl-code">.</span><span class="hl-identifier">createElement</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">div</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-identifier">oBody</span><span class="hl-code">.</span><span class="hl-identifier">className</span><span class="hl-code"> = </span><span class="hl-quotes">&quot;</span><span class="hl-string">yui-ac-bd</span><span class="hl-quotes">&quot;</span><span class="hl-code">;
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oContent</span><span class="hl-code">.</span><span class="hl-identifier">_oBody</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oContent</span><span class="hl-code">.</span><span class="hl-identifier">appendChild</span><span class="hl-brackets">(</span><span class="hl-identifier">oBody</span><span class="hl-brackets">)</span><span class="hl-code">;

        </span><span class="hl-reserved">var </span><span class="hl-identifier">oFooter</span><span class="hl-code"> = </span><span class="hl-builtin">document</span><span class="hl-code">.</span><span class="hl-identifier">createElement</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">div</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-identifier">oFooter</span><span class="hl-code">.</span><span class="hl-identifier">className</span><span class="hl-code"> = </span><span class="hl-quotes">&quot;</span><span class="hl-string">yui-ac-ft</span><span class="hl-quotes">&quot;</span><span class="hl-code">;
        </span><span class="hl-identifier">oFooter</span><span class="hl-code">.</span><span class="hl-identifier">style</span><span class="hl-code">.</span><span class="hl-identifier">display</span><span class="hl-code"> = </span><span class="hl-quotes">&quot;</span><span class="hl-string">none</span><span class="hl-quotes">&quot;</span><span class="hl-code">;
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oContent</span><span class="hl-code">.</span><span class="hl-identifier">_oFooter</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oContent</span><span class="hl-code">.</span><span class="hl-identifier">appendChild</span><span class="hl-brackets">(</span><span class="hl-identifier">oFooter</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-brackets">}
    </span><span class="hl-reserved">else </span><span class="hl-brackets">{
    }
}</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Clears out contents of container body and creates up to
 * YAHOO.widget.AutoComplete#maxResultsDisplayed &amp;lt;li&amp;gt; elements in an
 * &amp;lt;ul&amp;gt; element.
 *
 * @method _initList
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_initList</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">() {
    </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_aListItems</span><span class="hl-code"> = </span><span class="hl-brackets">[]</span><span class="hl-code">;
    </span><span class="hl-reserved">while</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oContent</span><span class="hl-code">.</span><span class="hl-identifier">_oBody</span><span class="hl-code">.</span><span class="hl-identifier">hasChildNodes</span><span class="hl-brackets">()) {
        </span><span class="hl-reserved">var </span><span class="hl-identifier">oldListItems</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">getListItems</span><span class="hl-brackets">()</span><span class="hl-code">;
        </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">oldListItems</span><span class="hl-brackets">) {
            </span><span class="hl-reserved">for</span><span class="hl-brackets">(</span><span class="hl-reserved">var </span><span class="hl-identifier">oldi</span><span class="hl-code"> = </span><span class="hl-identifier">oldListItems</span><span class="hl-code">.</span><span class="hl-identifier">length</span><span class="hl-code">-</span><span class="hl-number">1</span><span class="hl-code">; </span><span class="hl-identifier">oldi</span><span class="hl-code"> &gt;= </span><span class="hl-number">0</span><span class="hl-code">; </span><span class="hl-identifier">i</span><span class="hl-code">--</span><span class="hl-brackets">) {
                </span><span class="hl-identifier">oldListItems</span><span class="hl-brackets">[</span><span class="hl-identifier">oldi</span><span class="hl-brackets">]</span><span class="hl-code"> = </span><span class="hl-reserved">null</span><span class="hl-code">;
            </span><span class="hl-brackets">}
        }
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oContent</span><span class="hl-code">.</span><span class="hl-identifier">_oBody</span><span class="hl-code">.</span><span class="hl-identifier">innerHTML</span><span class="hl-code"> = </span><span class="hl-quotes">&quot;&quot;</span><span class="hl-code">;
    </span><span class="hl-brackets">}

    </span><span class="hl-reserved">var </span><span class="hl-identifier">oList</span><span class="hl-code"> = </span><span class="hl-builtin">document</span><span class="hl-code">.</span><span class="hl-identifier">createElement</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">ul</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-identifier">oList</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oContent</span><span class="hl-code">.</span><span class="hl-identifier">_oBody</span><span class="hl-code">.</span><span class="hl-identifier">appendChild</span><span class="hl-brackets">(</span><span class="hl-identifier">oList</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-reserved">for</span><span class="hl-brackets">(</span><span class="hl-reserved">var </span><span class="hl-identifier">i</span><span class="hl-code">=</span><span class="hl-number">0</span><span class="hl-code">; </span><span class="hl-identifier">i</span><span class="hl-code">&lt;</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">maxResultsDisplayed</span><span class="hl-code">; </span><span class="hl-identifier">i</span><span class="hl-code">++</span><span class="hl-brackets">) {
        </span><span class="hl-reserved">var </span><span class="hl-identifier">oItem</span><span class="hl-code"> = </span><span class="hl-builtin">document</span><span class="hl-code">.</span><span class="hl-identifier">createElement</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">li</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-identifier">oItem</span><span class="hl-code"> = </span><span class="hl-identifier">oList</span><span class="hl-code">.</span><span class="hl-identifier">appendChild</span><span class="hl-brackets">(</span><span class="hl-identifier">oItem</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_aListItems</span><span class="hl-brackets">[</span><span class="hl-identifier">i</span><span class="hl-brackets">]</span><span class="hl-code"> = </span><span class="hl-identifier">oItem</span><span class="hl-code">;
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_initListItem</span><span class="hl-brackets">(</span><span class="hl-identifier">oItem</span><span class="hl-code">, </span><span class="hl-identifier">i</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-brackets">}
    </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_maxResultsDisplayed</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">maxResultsDisplayed</span><span class="hl-code">;
</span><span class="hl-brackets">}</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Initializes each &amp;lt;li&amp;gt; element in the container list.
 *
 * @method _initListItem
 * @param oItem {HTMLElement} The &amp;lt;li&amp;gt; DOM element.
 * @param nItemIndex {Number} The index of the element.
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_initListItem</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">(</span><span class="hl-identifier">oItem</span><span class="hl-code">, </span><span class="hl-identifier">nItemIndex</span><span class="hl-brackets">) {
    </span><span class="hl-reserved">var </span><span class="hl-identifier">oSelf</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">;
    </span><span class="hl-identifier">oItem</span><span class="hl-code">.</span><span class="hl-identifier">style</span><span class="hl-code">.</span><span class="hl-identifier">display</span><span class="hl-code"> = </span><span class="hl-quotes">&quot;</span><span class="hl-string">none</span><span class="hl-quotes">&quot;</span><span class="hl-code">;
    </span><span class="hl-identifier">oItem</span><span class="hl-code">.</span><span class="hl-identifier">_nItemIndex</span><span class="hl-code"> = </span><span class="hl-identifier">nItemIndex</span><span class="hl-code">;

    </span><span class="hl-identifier">oItem</span><span class="hl-code">.</span><span class="hl-identifier">mouseover</span><span class="hl-code"> = </span><span class="hl-identifier">oItem</span><span class="hl-code">.</span><span class="hl-identifier">mouseout</span><span class="hl-code"> = </span><span class="hl-identifier">oItem</span><span class="hl-code">.</span><span class="hl-identifier">onclick</span><span class="hl-code"> = </span><span class="hl-reserved">null</span><span class="hl-code">;
    </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">Event</span><span class="hl-code">.</span><span class="hl-identifier">addListener</span><span class="hl-brackets">(</span><span class="hl-identifier">oItem</span><span class="hl-code">,</span><span class="hl-quotes">&quot;</span><span class="hl-string">mouseover</span><span class="hl-quotes">&quot;</span><span class="hl-code">,</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_onItemMouseover</span><span class="hl-code">,</span><span class="hl-identifier">oSelf</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">Event</span><span class="hl-code">.</span><span class="hl-identifier">addListener</span><span class="hl-brackets">(</span><span class="hl-identifier">oItem</span><span class="hl-code">,</span><span class="hl-quotes">&quot;</span><span class="hl-string">mouseout</span><span class="hl-quotes">&quot;</span><span class="hl-code">,</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_onItemMouseout</span><span class="hl-code">,</span><span class="hl-identifier">oSelf</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">Event</span><span class="hl-code">.</span><span class="hl-identifier">addListener</span><span class="hl-brackets">(</span><span class="hl-identifier">oItem</span><span class="hl-code">,</span><span class="hl-quotes">&quot;</span><span class="hl-string">click</span><span class="hl-quotes">&quot;</span><span class="hl-code">,</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_onItemMouseclick</span><span class="hl-code">,</span><span class="hl-identifier">oSelf</span><span class="hl-brackets">)</span><span class="hl-code">;
</span><span class="hl-brackets">}</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Enables interval detection for  Korean IME support.
 *
 * @method _onIMEDetected
 * @param oSelf {Object} The AutoComplete instance.
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_onIMEDetected</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-brackets">) {
    </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_enableIntervalDetection</span><span class="hl-brackets">()</span><span class="hl-code">;
</span><span class="hl-brackets">}</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Enables query triggers based on text input detection by intervals (rather
 * than by key events).
 *
 * @method _enableIntervalDetection
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_enableIntervalDetection</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">() {
    </span><span class="hl-reserved">var </span><span class="hl-identifier">currValue</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oTextbox</span><span class="hl-code">.</span><span class="hl-identifier">value</span><span class="hl-code">;
    </span><span class="hl-reserved">var </span><span class="hl-identifier">lastValue</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_sLastTextboxValue</span><span class="hl-code">;
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">currValue</span><span class="hl-code"> != </span><span class="hl-identifier">lastValue</span><span class="hl-brackets">) {
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_sLastTextboxValue</span><span class="hl-code"> = </span><span class="hl-identifier">currValue</span><span class="hl-code">;
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_sendQuery</span><span class="hl-brackets">(</span><span class="hl-identifier">currValue</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-brackets">}
}</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Cancels text input detection by intervals.
 *
 * @method _cancelIntervalDetection
 * @param oSelf {Object} The AutoComplete instance.
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_cancelIntervalDetection</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-brackets">) {
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_queryInterval</span><span class="hl-brackets">) {
        </span><span class="hl-identifier">clearInterval</span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_queryInterval</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-brackets">}
}</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Whether or not key is functional or should be ignored. Note that the right
 * arrow key is NOT an ignored key since it triggers queries for certain intl
 * charsets.
 *
 * @method _isIgnoreKey
 * @param nKeycode {Number} Code of key pressed.
 * @return {Boolean} True if key should be ignored, false otherwise.
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_isIgnoreKey</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">(</span><span class="hl-identifier">nKeyCode</span><span class="hl-brackets">) {
    </span><span class="hl-reserved">if </span><span class="hl-brackets">((</span><span class="hl-identifier">nKeyCode</span><span class="hl-code"> == </span><span class="hl-number">9</span><span class="hl-brackets">)</span><span class="hl-code"> || </span><span class="hl-brackets">(</span><span class="hl-identifier">nKeyCode</span><span class="hl-code"> == </span><span class="hl-number">13</span><span class="hl-brackets">)</span><span class="hl-code">  || </span><span class="hl-comment">// tab, enter
            </span><span class="hl-brackets">(</span><span class="hl-identifier">nKeyCode</span><span class="hl-code"> == </span><span class="hl-number">16</span><span class="hl-brackets">)</span><span class="hl-code"> || </span><span class="hl-brackets">(</span><span class="hl-identifier">nKeyCode</span><span class="hl-code"> == </span><span class="hl-number">17</span><span class="hl-brackets">)</span><span class="hl-code"> || </span><span class="hl-comment">// shift, ctl
            </span><span class="hl-brackets">(</span><span class="hl-identifier">nKeyCode</span><span class="hl-code"> &gt;= </span><span class="hl-number">18</span><span class="hl-code"> &amp;&amp; </span><span class="hl-identifier">nKeyCode</span><span class="hl-code"> &lt;= </span><span class="hl-number">20</span><span class="hl-brackets">)</span><span class="hl-code"> || </span><span class="hl-comment">// alt,pause/break,caps lock
            </span><span class="hl-brackets">(</span><span class="hl-identifier">nKeyCode</span><span class="hl-code"> == </span><span class="hl-number">27</span><span class="hl-brackets">)</span><span class="hl-code"> || </span><span class="hl-comment">// esc
            </span><span class="hl-brackets">(</span><span class="hl-identifier">nKeyCode</span><span class="hl-code"> &gt;= </span><span class="hl-number">33</span><span class="hl-code"> &amp;&amp; </span><span class="hl-identifier">nKeyCode</span><span class="hl-code"> &lt;= </span><span class="hl-number">35</span><span class="hl-brackets">)</span><span class="hl-code"> || </span><span class="hl-comment">// page up,page down,end
            </span><span class="hl-brackets">(</span><span class="hl-identifier">nKeyCode</span><span class="hl-code"> &gt;= </span><span class="hl-number">36</span><span class="hl-code"> &amp;&amp; </span><span class="hl-identifier">nKeyCode</span><span class="hl-code"> &lt;= </span><span class="hl-number">38</span><span class="hl-brackets">)</span><span class="hl-code"> || </span><span class="hl-comment">// home,left,up
            </span><span class="hl-brackets">(</span><span class="hl-identifier">nKeyCode</span><span class="hl-code"> == </span><span class="hl-number">40</span><span class="hl-brackets">)</span><span class="hl-code"> || </span><span class="hl-comment">// down
            </span><span class="hl-brackets">(</span><span class="hl-identifier">nKeyCode</span><span class="hl-code"> &gt;= </span><span class="hl-number">44</span><span class="hl-code"> &amp;&amp; </span><span class="hl-identifier">nKeyCode</span><span class="hl-code"> &lt;= </span><span class="hl-number">45</span><span class="hl-brackets">)) { </span><span class="hl-comment">// print screen,insert
        </span><span class="hl-reserved">return true</span><span class="hl-code">;
    </span><span class="hl-brackets">}
    </span><span class="hl-reserved">return false</span><span class="hl-code">;
</span><span class="hl-brackets">}</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Makes query request to the DataSource.
 *
 * @method _sendQuery
 * @param sQuery {String} Query string.
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_sendQuery</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">(</span><span class="hl-identifier">sQuery</span><span class="hl-brackets">) {
    </span><span class="hl-comment">// Widget has been effectively turned off
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">minQueryLength</span><span class="hl-code"> == -</span><span class="hl-number">1</span><span class="hl-brackets">) {
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_toggleContainer</span><span class="hl-brackets">(</span><span class="hl-reserved">false</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-reserved">return</span><span class="hl-code">;
    </span><span class="hl-brackets">}
    </span><span class="hl-comment">// Delimiter has been enabled
    </span><span class="hl-reserved">var </span><span class="hl-identifier">aDelimChar</span><span class="hl-code"> = </span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">delimChar</span><span class="hl-brackets">)</span><span class="hl-code"> ? </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">delimChar</span><span class="hl-code"> : </span><span class="hl-reserved">null</span><span class="hl-code">;
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">aDelimChar</span><span class="hl-brackets">) {
        </span><span class="hl-comment">// Loop through all possible delimiters and find the latest one
        // A &quot; &quot; may be a false positive if they are defined as delimiters AND
        // are used to separate delimited queries
        </span><span class="hl-reserved">var </span><span class="hl-identifier">nDelimIndex</span><span class="hl-code"> = -</span><span class="hl-number">1</span><span class="hl-code">;
        </span><span class="hl-reserved">for</span><span class="hl-brackets">(</span><span class="hl-reserved">var </span><span class="hl-identifier">i</span><span class="hl-code"> = </span><span class="hl-identifier">aDelimChar</span><span class="hl-code">.</span><span class="hl-identifier">length</span><span class="hl-code">-</span><span class="hl-number">1</span><span class="hl-code">; </span><span class="hl-identifier">i</span><span class="hl-code"> &gt;= </span><span class="hl-number">0</span><span class="hl-code">; </span><span class="hl-identifier">i</span><span class="hl-code">--</span><span class="hl-brackets">) {
            </span><span class="hl-reserved">var </span><span class="hl-identifier">nNewIndex</span><span class="hl-code"> = </span><span class="hl-identifier">sQuery</span><span class="hl-code">.</span><span class="hl-identifier">lastIndexOf</span><span class="hl-brackets">(</span><span class="hl-identifier">aDelimChar</span><span class="hl-brackets">[</span><span class="hl-identifier">i</span><span class="hl-brackets">])</span><span class="hl-code">;
            </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">nNewIndex</span><span class="hl-code"> &gt; </span><span class="hl-identifier">nDelimIndex</span><span class="hl-brackets">) {
                </span><span class="hl-identifier">nDelimIndex</span><span class="hl-code"> = </span><span class="hl-identifier">nNewIndex</span><span class="hl-code">;
            </span><span class="hl-brackets">}
        }
        </span><span class="hl-comment">// If we think the last delimiter is a space (&quot; &quot;), make sure it is NOT
        // a false positive by also checking the char directly before it
        </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">aDelimChar</span><span class="hl-brackets">[</span><span class="hl-identifier">i</span><span class="hl-brackets">]</span><span class="hl-code"> == </span><span class="hl-quotes">&quot; &quot;</span><span class="hl-brackets">) {
            </span><span class="hl-reserved">for </span><span class="hl-brackets">(</span><span class="hl-reserved">var </span><span class="hl-identifier">j</span><span class="hl-code"> = </span><span class="hl-identifier">aDelimChar</span><span class="hl-code">.</span><span class="hl-identifier">length</span><span class="hl-code">-</span><span class="hl-number">1</span><span class="hl-code">; </span><span class="hl-identifier">j</span><span class="hl-code"> &gt;= </span><span class="hl-number">0</span><span class="hl-code">; </span><span class="hl-identifier">j</span><span class="hl-code">--</span><span class="hl-brackets">) {
                </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">sQuery</span><span class="hl-brackets">[</span><span class="hl-identifier">nDelimIndex</span><span class="hl-code"> - </span><span class="hl-number">1</span><span class="hl-brackets">]</span><span class="hl-code"> == </span><span class="hl-identifier">aDelimChar</span><span class="hl-brackets">[</span><span class="hl-identifier">j</span><span class="hl-brackets">]) {
                    </span><span class="hl-identifier">nDelimIndex</span><span class="hl-code">--;
                    </span><span class="hl-reserved">break</span><span class="hl-code">;
                </span><span class="hl-brackets">}
            }
        }
        </span><span class="hl-comment">// A delimiter has been found so extract the latest query
        </span><span class="hl-reserved">if </span><span class="hl-brackets">(</span><span class="hl-identifier">nDelimIndex</span><span class="hl-code"> &gt; -</span><span class="hl-number">1</span><span class="hl-brackets">) {
            </span><span class="hl-reserved">var </span><span class="hl-identifier">nQueryStart</span><span class="hl-code"> = </span><span class="hl-identifier">nDelimIndex</span><span class="hl-code"> + </span><span class="hl-number">1</span><span class="hl-code">;
            </span><span class="hl-comment">// Trim any white space from the beginning...
            </span><span class="hl-reserved">while</span><span class="hl-brackets">(</span><span class="hl-identifier">sQuery</span><span class="hl-code">.</span><span class="hl-identifier">charAt</span><span class="hl-brackets">(</span><span class="hl-identifier">nQueryStart</span><span class="hl-brackets">)</span><span class="hl-code"> == </span><span class="hl-quotes">&quot; &quot;</span><span class="hl-brackets">) {
                </span><span class="hl-identifier">nQueryStart</span><span class="hl-code"> += </span><span class="hl-number">1</span><span class="hl-code">;
            </span><span class="hl-brackets">}
            </span><span class="hl-comment">// ...and save the rest of the string for later
            </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_sSavedQuery</span><span class="hl-code"> = </span><span class="hl-identifier">sQuery</span><span class="hl-code">.</span><span class="hl-identifier">substring</span><span class="hl-brackets">(</span><span class="hl-number">0</span><span class="hl-code">,</span><span class="hl-identifier">nQueryStart</span><span class="hl-brackets">)</span><span class="hl-code">;
            </span><span class="hl-comment">// Here is the query itself
            </span><span class="hl-identifier">sQuery</span><span class="hl-code"> = </span><span class="hl-identifier">sQuery</span><span class="hl-code">.</span><span class="hl-identifier">substr</span><span class="hl-brackets">(</span><span class="hl-identifier">nQueryStart</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-brackets">}
        </span><span class="hl-reserved">else if</span><span class="hl-brackets">(</span><span class="hl-identifier">sQuery</span><span class="hl-code">.</span><span class="hl-identifier">indexOf</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_sSavedQuery</span><span class="hl-brackets">)</span><span class="hl-code"> &lt; </span><span class="hl-number">0</span><span class="hl-brackets">){
            </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_sSavedQuery</span><span class="hl-code"> = </span><span class="hl-reserved">null</span><span class="hl-code">;
        </span><span class="hl-brackets">}
    }

    </span><span class="hl-comment">// Don't search queries that are too short
    </span><span class="hl-reserved">if </span><span class="hl-brackets">(</span><span class="hl-identifier">sQuery</span><span class="hl-code"> &amp;&amp; </span><span class="hl-brackets">(</span><span class="hl-identifier">sQuery</span><span class="hl-code">.</span><span class="hl-identifier">length</span><span class="hl-code"> &lt; </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">minQueryLength</span><span class="hl-brackets">)</span><span class="hl-code"> || </span><span class="hl-brackets">(</span><span class="hl-code">!</span><span class="hl-identifier">sQuery</span><span class="hl-code"> &amp;&amp; </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">minQueryLength</span><span class="hl-code"> &gt; </span><span class="hl-number">0</span><span class="hl-brackets">)) {
        </span><span class="hl-reserved">if </span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_nDelayID</span><span class="hl-code"> != -</span><span class="hl-number">1</span><span class="hl-brackets">) {
            </span><span class="hl-identifier">clearTimeout</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_nDelayID</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-brackets">}
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_toggleContainer</span><span class="hl-brackets">(</span><span class="hl-reserved">false</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-reserved">return</span><span class="hl-code">;
    </span><span class="hl-brackets">}

    </span><span class="hl-identifier">sQuery</span><span class="hl-code"> = </span><span class="hl-identifier">encodeURIComponent</span><span class="hl-brackets">(</span><span class="hl-identifier">sQuery</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_nDelayID</span><span class="hl-code"> = -</span><span class="hl-number">1</span><span class="hl-code">;    </span><span class="hl-comment">// Reset timeout ID because request has been made
    </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">dataRequestEvent</span><span class="hl-code">.</span><span class="hl-identifier">fire</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">, </span><span class="hl-identifier">sQuery</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">dataSource</span><span class="hl-code">.</span><span class="hl-identifier">getResults</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_populateList</span><span class="hl-code">, </span><span class="hl-identifier">sQuery</span><span class="hl-code">, </span><span class="hl-reserved">this</span><span class="hl-brackets">)</span><span class="hl-code">;
</span><span class="hl-brackets">}</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Populates the array of &amp;lt;li&amp;gt; elements in the container with query
 * results. This method is passed to YAHOO.widget.DataSource#getResults as a
 * callback function so results from the DataSource instance are returned to the
 * AutoComplete instance.
 *
 * @method _populateList
 * @param sQuery {String} The query string.
 * @param aResults {Array} An array of query result objects from the DataSource.
 * @param oSelf {Object} The AutoComplete instance.
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_populateList</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">(</span><span class="hl-identifier">sQuery</span><span class="hl-code">, </span><span class="hl-identifier">aResults</span><span class="hl-code">, </span><span class="hl-identifier">oSelf</span><span class="hl-brackets">) {
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">aResults</span><span class="hl-code"> === </span><span class="hl-reserved">null</span><span class="hl-brackets">) {
        </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">dataErrorEvent</span><span class="hl-code">.</span><span class="hl-identifier">fire</span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-code">, </span><span class="hl-identifier">sQuery</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-brackets">}
    </span><span class="hl-reserved">if </span><span class="hl-brackets">(</span><span class="hl-code">!</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_bFocused</span><span class="hl-code"> || !</span><span class="hl-identifier">aResults</span><span class="hl-brackets">) {
        </span><span class="hl-reserved">return</span><span class="hl-code">;
    </span><span class="hl-brackets">}

    </span><span class="hl-reserved">var </span><span class="hl-identifier">isOpera</span><span class="hl-code"> = </span><span class="hl-brackets">(</span><span class="hl-builtin">navigator</span><span class="hl-code">.</span><span class="hl-identifier">userAgent</span><span class="hl-code">.</span><span class="hl-identifier">toLowerCase</span><span class="hl-brackets">()</span><span class="hl-code">.</span><span class="hl-identifier">indexOf</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">opera</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">)</span><span class="hl-code"> != -</span><span class="hl-number">1</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-reserved">var </span><span class="hl-identifier">contentStyle</span><span class="hl-code"> = </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oContent</span><span class="hl-code">.</span><span class="hl-identifier">style</span><span class="hl-code">;
    </span><span class="hl-identifier">contentStyle</span><span class="hl-code">.</span><span class="hl-identifier">width</span><span class="hl-code"> = </span><span class="hl-brackets">(</span><span class="hl-code">!</span><span class="hl-identifier">isOpera</span><span class="hl-brackets">)</span><span class="hl-code"> ? </span><span class="hl-reserved">null</span><span class="hl-code"> : </span><span class="hl-quotes">&quot;&quot;</span><span class="hl-code">;
    </span><span class="hl-identifier">contentStyle</span><span class="hl-code">.</span><span class="hl-identifier">height</span><span class="hl-code"> = </span><span class="hl-brackets">(</span><span class="hl-code">!</span><span class="hl-identifier">isOpera</span><span class="hl-brackets">)</span><span class="hl-code"> ? </span><span class="hl-reserved">null</span><span class="hl-code"> : </span><span class="hl-quotes">&quot;&quot;</span><span class="hl-code">;

    </span><span class="hl-reserved">var </span><span class="hl-identifier">sCurQuery</span><span class="hl-code"> = </span><span class="hl-identifier">decodeURIComponent</span><span class="hl-brackets">(</span><span class="hl-identifier">sQuery</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_sCurQuery</span><span class="hl-code"> = </span><span class="hl-identifier">sCurQuery</span><span class="hl-code">;
    </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_bItemSelected</span><span class="hl-code"> = </span><span class="hl-reserved">false</span><span class="hl-code">;

    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_maxResultsDisplayed</span><span class="hl-code"> != </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">maxResultsDisplayed</span><span class="hl-brackets">) {
        </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_initList</span><span class="hl-brackets">()</span><span class="hl-code">;
    </span><span class="hl-brackets">}

    </span><span class="hl-reserved">var </span><span class="hl-identifier">nItems</span><span class="hl-code"> = </span><span class="hl-builtin">Math</span><span class="hl-code">.</span><span class="hl-identifier">min</span><span class="hl-brackets">(</span><span class="hl-identifier">aResults</span><span class="hl-code">.</span><span class="hl-identifier">length</span><span class="hl-code">,</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">maxResultsDisplayed</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_nDisplayedItems</span><span class="hl-code"> = </span><span class="hl-identifier">nItems</span><span class="hl-code">;
    </span><span class="hl-reserved">if </span><span class="hl-brackets">(</span><span class="hl-identifier">nItems</span><span class="hl-code"> &gt; </span><span class="hl-number">0</span><span class="hl-brackets">) {
        </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_initContainerHelpers</span><span class="hl-brackets">()</span><span class="hl-code">;
        </span><span class="hl-reserved">var </span><span class="hl-identifier">aItems</span><span class="hl-code"> = </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_aListItems</span><span class="hl-code">;

        </span><span class="hl-comment">// Fill items with data
        </span><span class="hl-reserved">for</span><span class="hl-brackets">(</span><span class="hl-reserved">var </span><span class="hl-identifier">i</span><span class="hl-code"> = </span><span class="hl-identifier">nItems</span><span class="hl-code">-</span><span class="hl-number">1</span><span class="hl-code">; </span><span class="hl-identifier">i</span><span class="hl-code"> &gt;= </span><span class="hl-number">0</span><span class="hl-code">; </span><span class="hl-identifier">i</span><span class="hl-code">--</span><span class="hl-brackets">) {
            </span><span class="hl-reserved">var </span><span class="hl-identifier">oItemi</span><span class="hl-code"> = </span><span class="hl-identifier">aItems</span><span class="hl-brackets">[</span><span class="hl-identifier">i</span><span class="hl-brackets">]</span><span class="hl-code">;
            </span><span class="hl-reserved">var </span><span class="hl-identifier">oResultItemi</span><span class="hl-code"> = </span><span class="hl-identifier">aResults</span><span class="hl-brackets">[</span><span class="hl-identifier">i</span><span class="hl-brackets">]</span><span class="hl-code">;
            </span><span class="hl-identifier">oItemi</span><span class="hl-code">.</span><span class="hl-identifier">innerHTML</span><span class="hl-code"> = </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">formatResult</span><span class="hl-brackets">(</span><span class="hl-identifier">oResultItemi</span><span class="hl-code">, </span><span class="hl-identifier">sCurQuery</span><span class="hl-brackets">)</span><span class="hl-code">;
            </span><span class="hl-identifier">oItemi</span><span class="hl-code">.</span><span class="hl-identifier">style</span><span class="hl-code">.</span><span class="hl-identifier">display</span><span class="hl-code"> = </span><span class="hl-quotes">&quot;</span><span class="hl-string">list-item</span><span class="hl-quotes">&quot;</span><span class="hl-code">;
            </span><span class="hl-identifier">oItemi</span><span class="hl-code">.</span><span class="hl-identifier">_sResultKey</span><span class="hl-code"> = </span><span class="hl-identifier">oResultItemi</span><span class="hl-brackets">[</span><span class="hl-number">0</span><span class="hl-brackets">]</span><span class="hl-code">;
            </span><span class="hl-identifier">oItemi</span><span class="hl-code">.</span><span class="hl-identifier">_oResultData</span><span class="hl-code"> = </span><span class="hl-identifier">oResultItemi</span><span class="hl-code">;

        </span><span class="hl-brackets">}

        </span><span class="hl-comment">// Empty out remaining items if any
        </span><span class="hl-reserved">for</span><span class="hl-brackets">(</span><span class="hl-reserved">var </span><span class="hl-identifier">j</span><span class="hl-code"> = </span><span class="hl-identifier">aItems</span><span class="hl-code">.</span><span class="hl-identifier">length</span><span class="hl-code">-</span><span class="hl-number">1</span><span class="hl-code">; </span><span class="hl-identifier">j</span><span class="hl-code"> &gt;= </span><span class="hl-identifier">nItems</span><span class="hl-code"> ; </span><span class="hl-identifier">j</span><span class="hl-code">--</span><span class="hl-brackets">) {
            </span><span class="hl-reserved">var </span><span class="hl-identifier">oItemj</span><span class="hl-code"> = </span><span class="hl-identifier">aItems</span><span class="hl-brackets">[</span><span class="hl-identifier">j</span><span class="hl-brackets">]</span><span class="hl-code">;
            </span><span class="hl-identifier">oItemj</span><span class="hl-code">.</span><span class="hl-identifier">innerHTML</span><span class="hl-code"> = </span><span class="hl-reserved">null</span><span class="hl-code">;
            </span><span class="hl-identifier">oItemj</span><span class="hl-code">.</span><span class="hl-identifier">style</span><span class="hl-code">.</span><span class="hl-identifier">display</span><span class="hl-code"> = </span><span class="hl-quotes">&quot;</span><span class="hl-string">none</span><span class="hl-quotes">&quot;</span><span class="hl-code">;
            </span><span class="hl-identifier">oItemj</span><span class="hl-code">.</span><span class="hl-identifier">_sResultKey</span><span class="hl-code"> = </span><span class="hl-reserved">null</span><span class="hl-code">;
            </span><span class="hl-identifier">oItemj</span><span class="hl-code">.</span><span class="hl-identifier">_oResultData</span><span class="hl-code"> = </span><span class="hl-reserved">null</span><span class="hl-code">;
        </span><span class="hl-brackets">}

        </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">autoHighlight</span><span class="hl-brackets">) {
            </span><span class="hl-comment">// Go to the first item
            </span><span class="hl-reserved">var </span><span class="hl-identifier">oFirstItem</span><span class="hl-code"> = </span><span class="hl-identifier">aItems</span><span class="hl-brackets">[</span><span class="hl-number">0</span><span class="hl-brackets">]</span><span class="hl-code">;
            </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_toggleHighlight</span><span class="hl-brackets">(</span><span class="hl-identifier">oFirstItem</span><span class="hl-code">,</span><span class="hl-quotes">&quot;</span><span class="hl-string">to</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">)</span><span class="hl-code">;
            </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">itemArrowToEvent</span><span class="hl-code">.</span><span class="hl-identifier">fire</span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-code">, </span><span class="hl-identifier">oFirstItem</span><span class="hl-brackets">)</span><span class="hl-code">;
            </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_typeAhead</span><span class="hl-brackets">(</span><span class="hl-identifier">oFirstItem</span><span class="hl-code">,</span><span class="hl-identifier">sQuery</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-brackets">}
        </span><span class="hl-reserved">else </span><span class="hl-brackets">{
            </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_oCurItem</span><span class="hl-code"> = </span><span class="hl-reserved">null</span><span class="hl-code">;
        </span><span class="hl-brackets">}

        </span><span class="hl-comment">// Expand the container
        </span><span class="hl-reserved">var </span><span class="hl-identifier">ok</span><span class="hl-code"> = </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">doBeforeExpandContainer</span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_oTextbox</span><span class="hl-code">, </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">, </span><span class="hl-identifier">sQuery</span><span class="hl-code">, </span><span class="hl-identifier">aResults</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_toggleContainer</span><span class="hl-brackets">(</span><span class="hl-identifier">ok</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-brackets">}
    </span><span class="hl-reserved">else </span><span class="hl-brackets">{
        </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_toggleContainer</span><span class="hl-brackets">(</span><span class="hl-reserved">false</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-brackets">}
    </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">dataReturnEvent</span><span class="hl-code">.</span><span class="hl-identifier">fire</span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-code">, </span><span class="hl-identifier">sQuery</span><span class="hl-code">, </span><span class="hl-identifier">aResults</span><span class="hl-brackets">)</span><span class="hl-code">;
</span><span class="hl-brackets">}</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * When forceSelection is true and the user attempts
 * leave the text input box without selecting an item from the query results,
 * the user selection is cleared.
 *
 * @method _clearSelection
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_clearSelection</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">() {
    </span><span class="hl-reserved">var </span><span class="hl-identifier">sValue</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oTextbox</span><span class="hl-code">.</span><span class="hl-identifier">value</span><span class="hl-code">;
    </span><span class="hl-reserved">var </span><span class="hl-identifier">sChar</span><span class="hl-code"> = </span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">delimChar</span><span class="hl-brackets">)</span><span class="hl-code"> ? </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">delimChar</span><span class="hl-brackets">[</span><span class="hl-number">0</span><span class="hl-brackets">]</span><span class="hl-code"> : </span><span class="hl-reserved">null</span><span class="hl-code">;
    </span><span class="hl-reserved">var </span><span class="hl-identifier">nIndex</span><span class="hl-code"> = </span><span class="hl-brackets">(</span><span class="hl-identifier">sChar</span><span class="hl-brackets">)</span><span class="hl-code"> ? </span><span class="hl-identifier">sValue</span><span class="hl-code">.</span><span class="hl-identifier">lastIndexOf</span><span class="hl-brackets">(</span><span class="hl-identifier">sChar</span><span class="hl-code">, </span><span class="hl-identifier">sValue</span><span class="hl-code">.</span><span class="hl-identifier">length</span><span class="hl-code">-</span><span class="hl-number">2</span><span class="hl-brackets">)</span><span class="hl-code"> : -</span><span class="hl-number">1</span><span class="hl-code">;
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">nIndex</span><span class="hl-code"> &gt; -</span><span class="hl-number">1</span><span class="hl-brackets">) {
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oTextbox</span><span class="hl-code">.</span><span class="hl-identifier">value</span><span class="hl-code"> = </span><span class="hl-identifier">sValue</span><span class="hl-code">.</span><span class="hl-identifier">substring</span><span class="hl-brackets">(</span><span class="hl-number">0</span><span class="hl-code">,</span><span class="hl-identifier">nIndex</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-brackets">}
    </span><span class="hl-reserved">else </span><span class="hl-brackets">{
         </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oTextbox</span><span class="hl-code">.</span><span class="hl-identifier">value</span><span class="hl-code"> = </span><span class="hl-quotes">&quot;&quot;</span><span class="hl-code">;
    </span><span class="hl-brackets">}
    </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_sSavedQuery</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oTextbox</span><span class="hl-code">.</span><span class="hl-identifier">value</span><span class="hl-code">;

    </span><span class="hl-comment">// Fire custom event
    </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">selectionEnforceEvent</span><span class="hl-code">.</span><span class="hl-identifier">fire</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-brackets">)</span><span class="hl-code">;
</span><span class="hl-brackets">}</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Whether or not user-typed value in the text input box matches any of the
 * query results.
 *
 * @method _textMatchesOption
 * @return {Boolean} True if user-input text matches a result, false otherwise.
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_textMatchesOption</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">() {
    </span><span class="hl-reserved">var </span><span class="hl-identifier">foundMatch</span><span class="hl-code"> = </span><span class="hl-reserved">false</span><span class="hl-code">;

    </span><span class="hl-reserved">for</span><span class="hl-brackets">(</span><span class="hl-reserved">var </span><span class="hl-identifier">i</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_nDisplayedItems</span><span class="hl-code">-</span><span class="hl-number">1</span><span class="hl-code">; </span><span class="hl-identifier">i</span><span class="hl-code"> &gt;= </span><span class="hl-number">0</span><span class="hl-code"> ; </span><span class="hl-identifier">i</span><span class="hl-code">--</span><span class="hl-brackets">) {
        </span><span class="hl-reserved">var </span><span class="hl-identifier">oItem</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_aListItems</span><span class="hl-brackets">[</span><span class="hl-identifier">i</span><span class="hl-brackets">]</span><span class="hl-code">;
        </span><span class="hl-reserved">var </span><span class="hl-identifier">sMatch</span><span class="hl-code"> = </span><span class="hl-identifier">oItem</span><span class="hl-code">.</span><span class="hl-identifier">_sResultKey</span><span class="hl-code">.</span><span class="hl-identifier">toLowerCase</span><span class="hl-brackets">()</span><span class="hl-code">;
        </span><span class="hl-reserved">if </span><span class="hl-brackets">(</span><span class="hl-identifier">sMatch</span><span class="hl-code"> == </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_sCurQuery</span><span class="hl-code">.</span><span class="hl-identifier">toLowerCase</span><span class="hl-brackets">()) {
            </span><span class="hl-identifier">foundMatch</span><span class="hl-code"> = </span><span class="hl-reserved">true</span><span class="hl-code">;
            </span><span class="hl-reserved">break</span><span class="hl-code">;
        </span><span class="hl-brackets">}
    }
    </span><span class="hl-reserved">return</span><span class="hl-brackets">(</span><span class="hl-identifier">foundMatch</span><span class="hl-brackets">)</span><span class="hl-code">;
</span><span class="hl-brackets">}</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Updates in the text input box with the first query result as the user types,
 * selecting the substring that the user has not typed.
 *
 * @method _typeAhead
 * @param oItem {HTMLElement} The &amp;lt;li&amp;gt; element item whose data populates the input field.
 * @param sQuery {String} Query string.
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_typeAhead</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">(</span><span class="hl-identifier">oItem</span><span class="hl-code">, </span><span class="hl-identifier">sQuery</span><span class="hl-brackets">) {
    </span><span class="hl-comment">// Don't update if turned off
    </span><span class="hl-reserved">if </span><span class="hl-brackets">(</span><span class="hl-code">!</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">typeAhead</span><span class="hl-brackets">) {
        </span><span class="hl-reserved">return</span><span class="hl-code">;
    </span><span class="hl-brackets">}

    </span><span class="hl-reserved">var </span><span class="hl-identifier">oTextbox</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oTextbox</span><span class="hl-code">;
    </span><span class="hl-reserved">var </span><span class="hl-identifier">sValue</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oTextbox</span><span class="hl-code">.</span><span class="hl-identifier">value</span><span class="hl-code">; </span><span class="hl-comment">// any saved queries plus what user has typed

    // Don't update with type-ahead if text selection is not supported
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-code">!</span><span class="hl-identifier">oTextbox</span><span class="hl-code">.</span><span class="hl-identifier">setSelectionRange</span><span class="hl-code"> &amp;&amp; !</span><span class="hl-identifier">oTextbox</span><span class="hl-code">.</span><span class="hl-identifier">createTextRange</span><span class="hl-brackets">) {
        </span><span class="hl-reserved">return</span><span class="hl-code">;
    </span><span class="hl-brackets">}

    </span><span class="hl-comment">// Select the portion of text that the user has not typed
    </span><span class="hl-reserved">var </span><span class="hl-identifier">nStart</span><span class="hl-code"> = </span><span class="hl-identifier">sValue</span><span class="hl-code">.</span><span class="hl-identifier">length</span><span class="hl-code">;
    </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_updateValue</span><span class="hl-brackets">(</span><span class="hl-identifier">oItem</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-reserved">var </span><span class="hl-identifier">nEnd</span><span class="hl-code"> = </span><span class="hl-identifier">oTextbox</span><span class="hl-code">.</span><span class="hl-identifier">value</span><span class="hl-code">.</span><span class="hl-identifier">length</span><span class="hl-code">;
    </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_selectText</span><span class="hl-brackets">(</span><span class="hl-identifier">oTextbox</span><span class="hl-code">,</span><span class="hl-identifier">nStart</span><span class="hl-code">,</span><span class="hl-identifier">nEnd</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-reserved">var </span><span class="hl-identifier">sPrefill</span><span class="hl-code"> = </span><span class="hl-identifier">oTextbox</span><span class="hl-code">.</span><span class="hl-identifier">value</span><span class="hl-code">.</span><span class="hl-identifier">substr</span><span class="hl-brackets">(</span><span class="hl-identifier">nStart</span><span class="hl-code">,</span><span class="hl-identifier">nEnd</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">typeAheadEvent</span><span class="hl-code">.</span><span class="hl-identifier">fire</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">,</span><span class="hl-identifier">sQuery</span><span class="hl-code">,</span><span class="hl-identifier">sPrefill</span><span class="hl-brackets">)</span><span class="hl-code">;
</span><span class="hl-brackets">}</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Selects text in the input field.
 *
 * @method _selectText
 * @param oTextbox {HTMLElement} Text input box element in which to select text.
 * @param nStart {Number} Starting index of text string to select.
 * @param nEnd {Number} Ending index of text selection.
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_selectText</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">(</span><span class="hl-identifier">oTextbox</span><span class="hl-code">, </span><span class="hl-identifier">nStart</span><span class="hl-code">, </span><span class="hl-identifier">nEnd</span><span class="hl-brackets">) {
    </span><span class="hl-reserved">if </span><span class="hl-brackets">(</span><span class="hl-identifier">oTextbox</span><span class="hl-code">.</span><span class="hl-identifier">setSelectionRange</span><span class="hl-brackets">) { </span><span class="hl-comment">// For Mozilla
        </span><span class="hl-identifier">oTextbox</span><span class="hl-code">.</span><span class="hl-identifier">setSelectionRange</span><span class="hl-brackets">(</span><span class="hl-identifier">nStart</span><span class="hl-code">,</span><span class="hl-identifier">nEnd</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-brackets">}
    </span><span class="hl-reserved">else if </span><span class="hl-brackets">(</span><span class="hl-identifier">oTextbox</span><span class="hl-code">.</span><span class="hl-identifier">createTextRange</span><span class="hl-brackets">) { </span><span class="hl-comment">// For IE
        </span><span class="hl-reserved">var </span><span class="hl-identifier">oTextRange</span><span class="hl-code"> = </span><span class="hl-identifier">oTextbox</span><span class="hl-code">.</span><span class="hl-identifier">createTextRange</span><span class="hl-brackets">()</span><span class="hl-code">;
        </span><span class="hl-identifier">oTextRange</span><span class="hl-code">.</span><span class="hl-identifier">moveStart</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">character</span><span class="hl-quotes">&quot;</span><span class="hl-code">, </span><span class="hl-identifier">nStart</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-identifier">oTextRange</span><span class="hl-code">.</span><span class="hl-identifier">moveEnd</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">character</span><span class="hl-quotes">&quot;</span><span class="hl-code">, </span><span class="hl-identifier">nEnd</span><span class="hl-code">-</span><span class="hl-identifier">oTextbox</span><span class="hl-code">.</span><span class="hl-identifier">value</span><span class="hl-code">.</span><span class="hl-identifier">length</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-identifier">oTextRange</span><span class="hl-code">.</span><span class="hl-identifier">select</span><span class="hl-brackets">()</span><span class="hl-code">;
    </span><span class="hl-brackets">}
    </span><span class="hl-reserved">else </span><span class="hl-brackets">{
        </span><span class="hl-identifier">oTextbox</span><span class="hl-code">.</span><span class="hl-identifier">select</span><span class="hl-brackets">()</span><span class="hl-code">;
    </span><span class="hl-brackets">}
}</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Syncs results container with its helpers.
 *
 * @method _toggleContainerHelpers
 * @param bShow {Boolean} True if container is expanded, false if collapsed
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_toggleContainerHelpers</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">(</span><span class="hl-identifier">bShow</span><span class="hl-brackets">) {
    </span><span class="hl-reserved">var </span><span class="hl-identifier">bFireEvent</span><span class="hl-code"> = </span><span class="hl-reserved">false</span><span class="hl-code">;
    </span><span class="hl-reserved">var </span><span class="hl-identifier">width</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oContent</span><span class="hl-code">.</span><span class="hl-identifier">offsetWidth</span><span class="hl-code"> + </span><span class="hl-quotes">&quot;</span><span class="hl-string">px</span><span class="hl-quotes">&quot;</span><span class="hl-code">;
    </span><span class="hl-reserved">var </span><span class="hl-identifier">height</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oContent</span><span class="hl-code">.</span><span class="hl-identifier">offsetHeight</span><span class="hl-code"> + </span><span class="hl-quotes">&quot;</span><span class="hl-string">px</span><span class="hl-quotes">&quot;</span><span class="hl-code">;

    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">useIFrame</span><span class="hl-code"> &amp;&amp; </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oIFrame</span><span class="hl-brackets">) {
        </span><span class="hl-identifier">bFireEvent</span><span class="hl-code"> = </span><span class="hl-reserved">true</span><span class="hl-code">;
        </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">bShow</span><span class="hl-brackets">) {
            </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oIFrame</span><span class="hl-code">.</span><span class="hl-identifier">style</span><span class="hl-code">.</span><span class="hl-identifier">width</span><span class="hl-code"> = </span><span class="hl-identifier">width</span><span class="hl-code">;
            </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oIFrame</span><span class="hl-code">.</span><span class="hl-identifier">style</span><span class="hl-code">.</span><span class="hl-identifier">height</span><span class="hl-code"> = </span><span class="hl-identifier">height</span><span class="hl-code">;
        </span><span class="hl-brackets">}
        </span><span class="hl-reserved">else </span><span class="hl-brackets">{
            </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oIFrame</span><span class="hl-code">.</span><span class="hl-identifier">style</span><span class="hl-code">.</span><span class="hl-identifier">width</span><span class="hl-code"> = </span><span class="hl-number">0</span><span class="hl-code">;
            </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oIFrame</span><span class="hl-code">.</span><span class="hl-identifier">style</span><span class="hl-code">.</span><span class="hl-identifier">height</span><span class="hl-code"> = </span><span class="hl-number">0</span><span class="hl-code">;
        </span><span class="hl-brackets">}
    }
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">useShadow</span><span class="hl-code"> &amp;&amp; </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oShadow</span><span class="hl-brackets">) {
        </span><span class="hl-identifier">bFireEvent</span><span class="hl-code"> = </span><span class="hl-reserved">true</span><span class="hl-code">;
        </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">bShow</span><span class="hl-brackets">) {
            </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oShadow</span><span class="hl-code">.</span><span class="hl-identifier">style</span><span class="hl-code">.</span><span class="hl-identifier">width</span><span class="hl-code"> = </span><span class="hl-identifier">width</span><span class="hl-code">;
            </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oShadow</span><span class="hl-code">.</span><span class="hl-identifier">style</span><span class="hl-code">.</span><span class="hl-identifier">height</span><span class="hl-code"> = </span><span class="hl-identifier">height</span><span class="hl-code">;
        </span><span class="hl-brackets">}
        </span><span class="hl-reserved">else </span><span class="hl-brackets">{
           </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oShadow</span><span class="hl-code">.</span><span class="hl-identifier">style</span><span class="hl-code">.</span><span class="hl-identifier">width</span><span class="hl-code"> = </span><span class="hl-number">0</span><span class="hl-code">;
            </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oShadow</span><span class="hl-code">.</span><span class="hl-identifier">style</span><span class="hl-code">.</span><span class="hl-identifier">height</span><span class="hl-code"> = </span><span class="hl-number">0</span><span class="hl-code">;
        </span><span class="hl-brackets">}
    }
}</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Animates expansion or collapse of the container.
 *
 * @method _toggleContainer
 * @param bShow {Boolean} True if container should be expanded, false if container should be collapsed
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_toggleContainer</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">(</span><span class="hl-identifier">bShow</span><span class="hl-brackets">) {
    </span><span class="hl-reserved">var </span><span class="hl-identifier">oContainer</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">;

    </span><span class="hl-comment">// Implementer has container always open so don't mess with it
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">alwaysShowContainer</span><span class="hl-code"> &amp;&amp; </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_bContainerOpen</span><span class="hl-brackets">) {
        </span><span class="hl-reserved">return</span><span class="hl-code">;
    </span><span class="hl-brackets">}
    
    </span><span class="hl-comment">// Clear contents of container
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-code">!</span><span class="hl-identifier">bShow</span><span class="hl-brackets">) {
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oContent</span><span class="hl-code">.</span><span class="hl-identifier">scrollTop</span><span class="hl-code"> = </span><span class="hl-number">0</span><span class="hl-code">;
        </span><span class="hl-reserved">var </span><span class="hl-identifier">aItems</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_aListItems</span><span class="hl-code">;

        </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">aItems</span><span class="hl-code"> &amp;&amp; </span><span class="hl-brackets">(</span><span class="hl-identifier">aItems</span><span class="hl-code">.</span><span class="hl-identifier">length</span><span class="hl-code"> &gt; </span><span class="hl-number">0</span><span class="hl-brackets">)) {
            </span><span class="hl-reserved">for</span><span class="hl-brackets">(</span><span class="hl-reserved">var </span><span class="hl-identifier">i</span><span class="hl-code"> = </span><span class="hl-identifier">aItems</span><span class="hl-code">.</span><span class="hl-identifier">length</span><span class="hl-code">-</span><span class="hl-number">1</span><span class="hl-code">; </span><span class="hl-identifier">i</span><span class="hl-code"> &gt;= </span><span class="hl-number">0</span><span class="hl-code"> ; </span><span class="hl-identifier">i</span><span class="hl-code">--</span><span class="hl-brackets">) {
                </span><span class="hl-identifier">aItems</span><span class="hl-brackets">[</span><span class="hl-identifier">i</span><span class="hl-brackets">]</span><span class="hl-code">.</span><span class="hl-identifier">style</span><span class="hl-code">.</span><span class="hl-identifier">display</span><span class="hl-code"> = </span><span class="hl-quotes">&quot;</span><span class="hl-string">none</span><span class="hl-quotes">&quot;</span><span class="hl-code">;
            </span><span class="hl-brackets">}
        }

        </span><span class="hl-reserved">if </span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oCurItem</span><span class="hl-brackets">) {
            </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_toggleHighlight</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oCurItem</span><span class="hl-code">,</span><span class="hl-quotes">&quot;</span><span class="hl-string">from</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-brackets">}

        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oCurItem</span><span class="hl-code"> = </span><span class="hl-reserved">null</span><span class="hl-code">;
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_nDisplayedItems</span><span class="hl-code"> = </span><span class="hl-number">0</span><span class="hl-code">;
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_sCurQuery</span><span class="hl-code"> = </span><span class="hl-reserved">null</span><span class="hl-code">;
    </span><span class="hl-brackets">}

    </span><span class="hl-comment">// Container is already closed
    </span><span class="hl-reserved">if </span><span class="hl-brackets">(</span><span class="hl-code">!</span><span class="hl-identifier">bShow</span><span class="hl-code"> &amp;&amp; !</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_bContainerOpen</span><span class="hl-brackets">) {
        </span><span class="hl-identifier">oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oContent</span><span class="hl-code">.</span><span class="hl-identifier">style</span><span class="hl-code">.</span><span class="hl-identifier">display</span><span class="hl-code"> = </span><span class="hl-quotes">&quot;</span><span class="hl-string">none</span><span class="hl-quotes">&quot;</span><span class="hl-code">;
        </span><span class="hl-reserved">return</span><span class="hl-code">;
    </span><span class="hl-brackets">}

    </span><span class="hl-comment">// If animation is enabled...
    </span><span class="hl-reserved">var </span><span class="hl-identifier">oAnim</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oAnim</span><span class="hl-code">;
    </span><span class="hl-reserved">if </span><span class="hl-brackets">(</span><span class="hl-identifier">oAnim</span><span class="hl-code"> &amp;&amp; </span><span class="hl-identifier">oAnim</span><span class="hl-code">.</span><span class="hl-identifier">getEl</span><span class="hl-brackets">()</span><span class="hl-code"> &amp;&amp; </span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">animHoriz</span><span class="hl-code"> || </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">animVert</span><span class="hl-brackets">)) {
        </span><span class="hl-comment">// If helpers need to be collapsed, do it right away...
        // but if helpers need to be expanded, wait until after the container expands
        </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-code">!</span><span class="hl-identifier">bShow</span><span class="hl-brackets">) {
            </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_toggleContainerHelpers</span><span class="hl-brackets">(</span><span class="hl-identifier">bShow</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-brackets">}

        </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">oAnim</span><span class="hl-code">.</span><span class="hl-identifier">isAnimated</span><span class="hl-brackets">()) {
            </span><span class="hl-identifier">oAnim</span><span class="hl-code">.</span><span class="hl-identifier">stop</span><span class="hl-brackets">()</span><span class="hl-code">;
        </span><span class="hl-brackets">}

        </span><span class="hl-comment">// Clone container to grab current size offscreen
        </span><span class="hl-reserved">var </span><span class="hl-identifier">oClone</span><span class="hl-code"> = </span><span class="hl-identifier">oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oContent</span><span class="hl-code">.</span><span class="hl-identifier">cloneNode</span><span class="hl-brackets">(</span><span class="hl-reserved">true</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-identifier">oContainer</span><span class="hl-code">.</span><span class="hl-identifier">appendChild</span><span class="hl-brackets">(</span><span class="hl-identifier">oClone</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-identifier">oClone</span><span class="hl-code">.</span><span class="hl-identifier">style</span><span class="hl-code">.</span><span class="hl-identifier">top</span><span class="hl-code"> = </span><span class="hl-quotes">&quot;</span><span class="hl-string">-9000px</span><span class="hl-quotes">&quot;</span><span class="hl-code">;
        </span><span class="hl-identifier">oClone</span><span class="hl-code">.</span><span class="hl-identifier">style</span><span class="hl-code">.</span><span class="hl-identifier">display</span><span class="hl-code"> = </span><span class="hl-quotes">&quot;</span><span class="hl-string">block</span><span class="hl-quotes">&quot;</span><span class="hl-code">;

        </span><span class="hl-comment">// Current size of the container is the EXPANDED size
        </span><span class="hl-reserved">var </span><span class="hl-identifier">wExp</span><span class="hl-code"> = </span><span class="hl-identifier">oClone</span><span class="hl-code">.</span><span class="hl-identifier">offsetWidth</span><span class="hl-code">;
        </span><span class="hl-reserved">var </span><span class="hl-identifier">hExp</span><span class="hl-code"> = </span><span class="hl-identifier">oClone</span><span class="hl-code">.</span><span class="hl-identifier">offsetHeight</span><span class="hl-code">;

        </span><span class="hl-comment">// Calculate COLLAPSED sizes based on horiz and vert anim
        </span><span class="hl-reserved">var </span><span class="hl-identifier">wColl</span><span class="hl-code"> = </span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">animHoriz</span><span class="hl-brackets">)</span><span class="hl-code"> ? </span><span class="hl-number">0</span><span class="hl-code"> : </span><span class="hl-identifier">wExp</span><span class="hl-code">;
        </span><span class="hl-reserved">var </span><span class="hl-identifier">hColl</span><span class="hl-code"> = </span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">animVert</span><span class="hl-brackets">)</span><span class="hl-code"> ? </span><span class="hl-number">0</span><span class="hl-code"> : </span><span class="hl-identifier">hExp</span><span class="hl-code">;

        </span><span class="hl-comment">// Set animation sizes
        </span><span class="hl-identifier">oAnim</span><span class="hl-code">.</span><span class="hl-identifier">attributes</span><span class="hl-code"> = </span><span class="hl-brackets">(</span><span class="hl-identifier">bShow</span><span class="hl-brackets">)</span><span class="hl-code"> ?
            </span><span class="hl-brackets">{</span><span class="hl-identifier">width</span><span class="hl-code">: </span><span class="hl-brackets">{ </span><span class="hl-identifier">to</span><span class="hl-code">: </span><span class="hl-identifier">wExp </span><span class="hl-brackets">}</span><span class="hl-code">, </span><span class="hl-identifier">height</span><span class="hl-code">: </span><span class="hl-brackets">{ </span><span class="hl-identifier">to</span><span class="hl-code">: </span><span class="hl-identifier">hExp </span><span class="hl-brackets">}}</span><span class="hl-code"> :
            </span><span class="hl-brackets">{</span><span class="hl-identifier">width</span><span class="hl-code">: </span><span class="hl-brackets">{ </span><span class="hl-identifier">to</span><span class="hl-code">: </span><span class="hl-identifier">wColl</span><span class="hl-brackets">}</span><span class="hl-code">, </span><span class="hl-identifier">height</span><span class="hl-code">: </span><span class="hl-brackets">{ </span><span class="hl-identifier">to</span><span class="hl-code">: </span><span class="hl-identifier">hColl </span><span class="hl-brackets">}}</span><span class="hl-code">;

        </span><span class="hl-comment">// If opening anew, set to a collapsed size...
        </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">bShow</span><span class="hl-code"> &amp;&amp; !</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_bContainerOpen</span><span class="hl-brackets">) {
            </span><span class="hl-identifier">oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oContent</span><span class="hl-code">.</span><span class="hl-identifier">style</span><span class="hl-code">.</span><span class="hl-identifier">width</span><span class="hl-code"> = </span><span class="hl-identifier">wColl</span><span class="hl-code">+</span><span class="hl-quotes">&quot;</span><span class="hl-string">px</span><span class="hl-quotes">&quot;</span><span class="hl-code">;
            </span><span class="hl-identifier">oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oContent</span><span class="hl-code">.</span><span class="hl-identifier">style</span><span class="hl-code">.</span><span class="hl-identifier">height</span><span class="hl-code"> = </span><span class="hl-identifier">hColl</span><span class="hl-code">+</span><span class="hl-quotes">&quot;</span><span class="hl-string">px</span><span class="hl-quotes">&quot;</span><span class="hl-code">;
        </span><span class="hl-brackets">}
        </span><span class="hl-comment">// Else, set it to its last known size.
        </span><span class="hl-reserved">else </span><span class="hl-brackets">{
            </span><span class="hl-identifier">oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oContent</span><span class="hl-code">.</span><span class="hl-identifier">style</span><span class="hl-code">.</span><span class="hl-identifier">width</span><span class="hl-code"> = </span><span class="hl-identifier">wExp</span><span class="hl-code">+</span><span class="hl-quotes">&quot;</span><span class="hl-string">px</span><span class="hl-quotes">&quot;</span><span class="hl-code">;
            </span><span class="hl-identifier">oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oContent</span><span class="hl-code">.</span><span class="hl-identifier">style</span><span class="hl-code">.</span><span class="hl-identifier">height</span><span class="hl-code"> = </span><span class="hl-identifier">hExp</span><span class="hl-code">+</span><span class="hl-quotes">&quot;</span><span class="hl-string">px</span><span class="hl-quotes">&quot;</span><span class="hl-code">;
        </span><span class="hl-brackets">}

        </span><span class="hl-identifier">oContainer</span><span class="hl-code">.</span><span class="hl-identifier">removeChild</span><span class="hl-brackets">(</span><span class="hl-identifier">oClone</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-identifier">oClone</span><span class="hl-code"> = </span><span class="hl-reserved">null</span><span class="hl-code">;

    	</span><span class="hl-reserved">var </span><span class="hl-identifier">oSelf</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">;
    	</span><span class="hl-reserved">var </span><span class="hl-identifier">onAnimComplete</span><span class="hl-code"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">() {
            </span><span class="hl-comment">// Finish the collapse
    		</span><span class="hl-identifier">oAnim</span><span class="hl-code">.</span><span class="hl-identifier">onComplete</span><span class="hl-code">.</span><span class="hl-identifier">unsubscribeAll</span><span class="hl-brackets">()</span><span class="hl-code">;

            </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">bShow</span><span class="hl-brackets">) {
                </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">containerExpandEvent</span><span class="hl-code">.</span><span class="hl-identifier">fire</span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-brackets">)</span><span class="hl-code">;
            </span><span class="hl-brackets">}
            </span><span class="hl-reserved">else </span><span class="hl-brackets">{
                </span><span class="hl-identifier">oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oContent</span><span class="hl-code">.</span><span class="hl-identifier">style</span><span class="hl-code">.</span><span class="hl-identifier">display</span><span class="hl-code"> = </span><span class="hl-quotes">&quot;</span><span class="hl-string">none</span><span class="hl-quotes">&quot;</span><span class="hl-code">;
                </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">containerCollapseEvent</span><span class="hl-code">.</span><span class="hl-identifier">fire</span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-brackets">)</span><span class="hl-code">;
            </span><span class="hl-brackets">}
            </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_toggleContainerHelpers</span><span class="hl-brackets">(</span><span class="hl-identifier">bShow</span><span class="hl-brackets">)</span><span class="hl-code">;
     	</span><span class="hl-brackets">}</span><span class="hl-code">;

        </span><span class="hl-comment">// Display container and animate it
        </span><span class="hl-identifier">oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oContent</span><span class="hl-code">.</span><span class="hl-identifier">style</span><span class="hl-code">.</span><span class="hl-identifier">display</span><span class="hl-code"> = </span><span class="hl-quotes">&quot;</span><span class="hl-string">block</span><span class="hl-quotes">&quot;</span><span class="hl-code">;
        </span><span class="hl-identifier">oAnim</span><span class="hl-code">.</span><span class="hl-identifier">onComplete</span><span class="hl-code">.</span><span class="hl-identifier">subscribe</span><span class="hl-brackets">(</span><span class="hl-identifier">onAnimComplete</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-identifier">oAnim</span><span class="hl-code">.</span><span class="hl-identifier">animate</span><span class="hl-brackets">()</span><span class="hl-code">;
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_bContainerOpen</span><span class="hl-code"> = </span><span class="hl-identifier">bShow</span><span class="hl-code">;
    </span><span class="hl-brackets">}
    </span><span class="hl-comment">// Else don't animate, just show or hide
    </span><span class="hl-reserved">else </span><span class="hl-brackets">{
        </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">bShow</span><span class="hl-brackets">) {
            </span><span class="hl-identifier">oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oContent</span><span class="hl-code">.</span><span class="hl-identifier">style</span><span class="hl-code">.</span><span class="hl-identifier">display</span><span class="hl-code"> = </span><span class="hl-quotes">&quot;</span><span class="hl-string">block</span><span class="hl-quotes">&quot;</span><span class="hl-code">;
            </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">containerExpandEvent</span><span class="hl-code">.</span><span class="hl-identifier">fire</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-brackets">}
        </span><span class="hl-reserved">else </span><span class="hl-brackets">{
            </span><span class="hl-identifier">oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oContent</span><span class="hl-code">.</span><span class="hl-identifier">style</span><span class="hl-code">.</span><span class="hl-identifier">display</span><span class="hl-code"> = </span><span class="hl-quotes">&quot;</span><span class="hl-string">none</span><span class="hl-quotes">&quot;</span><span class="hl-code">;
            </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">containerCollapseEvent</span><span class="hl-code">.</span><span class="hl-identifier">fire</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-brackets">}
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_toggleContainerHelpers</span><span class="hl-brackets">(</span><span class="hl-identifier">bShow</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_bContainerOpen</span><span class="hl-code"> = </span><span class="hl-identifier">bShow</span><span class="hl-code">;
   </span><span class="hl-brackets">}

}</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Toggles the highlight on or off for an item in the container, and also cleans
 * up highlighting of any previous item.
 *
 * @method _toggleHighlight
 * @param oNewItem {HTMLElement} The &amp;lt;li&amp;gt; element item to receive highlight behavior.
 * @param sType {String} Type &quot;mouseover&quot; will toggle highlight on, and &quot;mouseout&quot; will toggle highlight off.
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_toggleHighlight</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">(</span><span class="hl-identifier">oNewItem</span><span class="hl-code">, </span><span class="hl-identifier">sType</span><span class="hl-brackets">) {
    </span><span class="hl-reserved">var </span><span class="hl-identifier">sHighlight</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">highlightClassName</span><span class="hl-code">;
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oCurItem</span><span class="hl-brackets">) {
        </span><span class="hl-comment">// Remove highlight from old item
        </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">Dom</span><span class="hl-code">.</span><span class="hl-identifier">removeClass</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oCurItem</span><span class="hl-code">, </span><span class="hl-identifier">sHighlight</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-brackets">}

    </span><span class="hl-reserved">if</span><span class="hl-brackets">((</span><span class="hl-identifier">sType</span><span class="hl-code"> == </span><span class="hl-quotes">&quot;</span><span class="hl-string">to</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">)</span><span class="hl-code"> &amp;&amp; </span><span class="hl-identifier">sHighlight</span><span class="hl-brackets">) {
        </span><span class="hl-comment">// Apply highlight to new item
        </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">Dom</span><span class="hl-code">.</span><span class="hl-identifier">addClass</span><span class="hl-brackets">(</span><span class="hl-identifier">oNewItem</span><span class="hl-code">, </span><span class="hl-identifier">sHighlight</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oCurItem</span><span class="hl-code"> = </span><span class="hl-identifier">oNewItem</span><span class="hl-code">;
    </span><span class="hl-brackets">}
}</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Toggles the pre-highlight on or off for an item in the container.
 *
 * @method _togglePrehighlight
 * @param oNewItem {HTMLElement} The &amp;lt;li&amp;gt; element item to receive highlight behavior.
 * @param sType {String} Type &quot;mouseover&quot; will toggle highlight on, and &quot;mouseout&quot; will toggle highlight off.
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_togglePrehighlight</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">(</span><span class="hl-identifier">oNewItem</span><span class="hl-code">, </span><span class="hl-identifier">sType</span><span class="hl-brackets">) {
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">oNewItem</span><span class="hl-code"> == </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oCurItem</span><span class="hl-brackets">) {
        </span><span class="hl-reserved">return</span><span class="hl-code">;
    </span><span class="hl-brackets">}

    </span><span class="hl-reserved">var </span><span class="hl-identifier">sPrehighlight</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">prehighlightClassName</span><span class="hl-code">;
    </span><span class="hl-reserved">if</span><span class="hl-brackets">((</span><span class="hl-identifier">sType</span><span class="hl-code"> == </span><span class="hl-quotes">&quot;</span><span class="hl-string">mouseover</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">)</span><span class="hl-code"> &amp;&amp; </span><span class="hl-identifier">sPrehighlight</span><span class="hl-brackets">) {
        </span><span class="hl-comment">// Apply prehighlight to new item
        </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">Dom</span><span class="hl-code">.</span><span class="hl-identifier">addClass</span><span class="hl-brackets">(</span><span class="hl-identifier">oNewItem</span><span class="hl-code">, </span><span class="hl-identifier">sPrehighlight</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-brackets">}
    </span><span class="hl-reserved">else </span><span class="hl-brackets">{
        </span><span class="hl-comment">// Remove prehighlight from old item
        </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">Dom</span><span class="hl-code">.</span><span class="hl-identifier">removeClass</span><span class="hl-brackets">(</span><span class="hl-identifier">oNewItem</span><span class="hl-code">, </span><span class="hl-identifier">sPrehighlight</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-brackets">}
}</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Updates the text input box value with selected query result. If a delimiter
 * has been defined, then the value gets appended with the delimiter.
 *
 * @method _updateValue
 * @param oItem {HTMLElement} The &amp;lt;li&amp;gt; element item with which to update the value.
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_updateValue</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">(</span><span class="hl-identifier">oItem</span><span class="hl-brackets">) {
    </span><span class="hl-reserved">var </span><span class="hl-identifier">oTextbox</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oTextbox</span><span class="hl-code">;
    </span><span class="hl-reserved">var </span><span class="hl-identifier">sDelimChar</span><span class="hl-code"> = </span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">delimChar</span><span class="hl-brackets">)</span><span class="hl-code"> ? </span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">delimChar</span><span class="hl-brackets">[</span><span class="hl-number">0</span><span class="hl-brackets">]</span><span class="hl-code"> || </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">delimChar</span><span class="hl-brackets">)</span><span class="hl-code"> : </span><span class="hl-reserved">null</span><span class="hl-code">;
    </span><span class="hl-reserved">var </span><span class="hl-identifier">sSavedQuery</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_sSavedQuery</span><span class="hl-code">;
    </span><span class="hl-reserved">var </span><span class="hl-identifier">sResultKey</span><span class="hl-code"> = </span><span class="hl-identifier">oItem</span><span class="hl-code">.</span><span class="hl-identifier">_sResultKey</span><span class="hl-code">;
    </span><span class="hl-identifier">oTextbox</span><span class="hl-code">.</span><span class="hl-identifier">focus</span><span class="hl-brackets">()</span><span class="hl-code">;

    </span><span class="hl-comment">// First clear text field
    </span><span class="hl-identifier">oTextbox</span><span class="hl-code">.</span><span class="hl-identifier">value</span><span class="hl-code"> = </span><span class="hl-quotes">&quot;&quot;</span><span class="hl-code">;
    </span><span class="hl-comment">// Grab data to put into text field
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">sDelimChar</span><span class="hl-brackets">) {
        </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">sSavedQuery</span><span class="hl-brackets">) {
            </span><span class="hl-identifier">oTextbox</span><span class="hl-code">.</span><span class="hl-identifier">value</span><span class="hl-code"> = </span><span class="hl-identifier">sSavedQuery</span><span class="hl-code">;
        </span><span class="hl-brackets">}
        </span><span class="hl-identifier">oTextbox</span><span class="hl-code">.</span><span class="hl-identifier">value</span><span class="hl-code"> += </span><span class="hl-identifier">sResultKey</span><span class="hl-code"> + </span><span class="hl-identifier">sDelimChar</span><span class="hl-code">;
        </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">sDelimChar</span><span class="hl-code"> != </span><span class="hl-quotes">&quot; &quot;</span><span class="hl-brackets">) {
            </span><span class="hl-identifier">oTextbox</span><span class="hl-code">.</span><span class="hl-identifier">value</span><span class="hl-code"> += </span><span class="hl-quotes">&quot; &quot;</span><span class="hl-code">;
        </span><span class="hl-brackets">}
    }
    </span><span class="hl-reserved">else </span><span class="hl-brackets">{ </span><span class="hl-identifier">oTextbox</span><span class="hl-code">.</span><span class="hl-identifier">value</span><span class="hl-code"> = </span><span class="hl-identifier">sResultKey</span><span class="hl-code">; </span><span class="hl-brackets">}

    </span><span class="hl-comment">// scroll to bottom of textarea if necessary
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">oTextbox</span><span class="hl-code">.</span><span class="hl-identifier">type</span><span class="hl-code"> == </span><span class="hl-quotes">&quot;</span><span class="hl-string">textarea</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">) {
        </span><span class="hl-identifier">oTextbox</span><span class="hl-code">.</span><span class="hl-identifier">scrollTop</span><span class="hl-code"> = </span><span class="hl-identifier">oTextbox</span><span class="hl-code">.</span><span class="hl-identifier">scrollHeight</span><span class="hl-code">;
    </span><span class="hl-brackets">}

    </span><span class="hl-comment">// move cursor to end
    </span><span class="hl-reserved">var </span><span class="hl-identifier">end</span><span class="hl-code"> = </span><span class="hl-identifier">oTextbox</span><span class="hl-code">.</span><span class="hl-identifier">value</span><span class="hl-code">.</span><span class="hl-identifier">length</span><span class="hl-code">;
    </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_selectText</span><span class="hl-brackets">(</span><span class="hl-identifier">oTextbox</span><span class="hl-code">,</span><span class="hl-identifier">end</span><span class="hl-code">,</span><span class="hl-identifier">end</span><span class="hl-brackets">)</span><span class="hl-code">;

    </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oCurItem</span><span class="hl-code"> = </span><span class="hl-identifier">oItem</span><span class="hl-code">;
</span><span class="hl-brackets">}</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Selects a result item from the container
 *
 * @method _selectItem
 * @param oItem {HTMLElement} The selected &amp;lt;li&amp;gt; element item.
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_selectItem</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">(</span><span class="hl-identifier">oItem</span><span class="hl-brackets">) {
    </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_bItemSelected</span><span class="hl-code"> = </span><span class="hl-reserved">true</span><span class="hl-code">;
    </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_updateValue</span><span class="hl-brackets">(</span><span class="hl-identifier">oItem</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_cancelIntervalDetection</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">itemSelectEvent</span><span class="hl-code">.</span><span class="hl-identifier">fire</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">, </span><span class="hl-identifier">oItem</span><span class="hl-code">, </span><span class="hl-identifier">oItem</span><span class="hl-code">.</span><span class="hl-identifier">_oResultData</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_toggleContainer</span><span class="hl-brackets">(</span><span class="hl-reserved">false</span><span class="hl-brackets">)</span><span class="hl-code">;
</span><span class="hl-brackets">}</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * For values updated by type-ahead, the right arrow key jumps to the end
 * of the textbox, otherwise the container is closed.
 *
 * @method _jumpSelection
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_jumpSelection</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">() {
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-code">!</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">typeAhead</span><span class="hl-brackets">) {
        </span><span class="hl-reserved">return</span><span class="hl-code">;
    </span><span class="hl-brackets">}
    </span><span class="hl-reserved">else </span><span class="hl-brackets">{
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_toggleContainer</span><span class="hl-brackets">(</span><span class="hl-reserved">false</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-brackets">}
}</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Triggered by up and down arrow keys, changes the current highlighted
 * &amp;lt;li&amp;gt; element item. Scrolls container if necessary.
 *
 * @method _moveSelection
 * @param nKeyCode {Number} Code of key pressed.
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_moveSelection</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">(</span><span class="hl-identifier">nKeyCode</span><span class="hl-brackets">) {
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_bContainerOpen</span><span class="hl-brackets">) {
        </span><span class="hl-comment">// Determine current item's id number
        </span><span class="hl-reserved">var </span><span class="hl-identifier">oCurItem</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oCurItem</span><span class="hl-code">;
        </span><span class="hl-reserved">var </span><span class="hl-identifier">nCurItemIndex</span><span class="hl-code"> = -</span><span class="hl-number">1</span><span class="hl-code">;

        </span><span class="hl-reserved">if </span><span class="hl-brackets">(</span><span class="hl-identifier">oCurItem</span><span class="hl-brackets">) {
            </span><span class="hl-identifier">nCurItemIndex</span><span class="hl-code"> = </span><span class="hl-identifier">oCurItem</span><span class="hl-code">.</span><span class="hl-identifier">_nItemIndex</span><span class="hl-code">;
        </span><span class="hl-brackets">}

        </span><span class="hl-reserved">var </span><span class="hl-identifier">nNewItemIndex</span><span class="hl-code"> = </span><span class="hl-brackets">(</span><span class="hl-identifier">nKeyCode</span><span class="hl-code"> == </span><span class="hl-number">40</span><span class="hl-brackets">)</span><span class="hl-code"> ?
                </span><span class="hl-brackets">(</span><span class="hl-identifier">nCurItemIndex</span><span class="hl-code"> + </span><span class="hl-number">1</span><span class="hl-brackets">)</span><span class="hl-code"> : </span><span class="hl-brackets">(</span><span class="hl-identifier">nCurItemIndex</span><span class="hl-code"> - </span><span class="hl-number">1</span><span class="hl-brackets">)</span><span class="hl-code">;

        </span><span class="hl-comment">// Out of bounds
        </span><span class="hl-reserved">if </span><span class="hl-brackets">(</span><span class="hl-identifier">nNewItemIndex</span><span class="hl-code"> &lt; -</span><span class="hl-number">2</span><span class="hl-code"> || </span><span class="hl-identifier">nNewItemIndex</span><span class="hl-code"> &gt;= </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_nDisplayedItems</span><span class="hl-brackets">) {
            </span><span class="hl-reserved">return</span><span class="hl-code">;
        </span><span class="hl-brackets">}

        </span><span class="hl-reserved">if </span><span class="hl-brackets">(</span><span class="hl-identifier">oCurItem</span><span class="hl-brackets">) {
            </span><span class="hl-comment">// Unhighlight current item
            </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_toggleHighlight</span><span class="hl-brackets">(</span><span class="hl-identifier">oCurItem</span><span class="hl-code">, </span><span class="hl-quotes">&quot;</span><span class="hl-string">from</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">)</span><span class="hl-code">;
            </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">itemArrowFromEvent</span><span class="hl-code">.</span><span class="hl-identifier">fire</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">, </span><span class="hl-identifier">oCurItem</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-brackets">}
        </span><span class="hl-reserved">if </span><span class="hl-brackets">(</span><span class="hl-identifier">nNewItemIndex</span><span class="hl-code"> == -</span><span class="hl-number">1</span><span class="hl-brackets">) {
           </span><span class="hl-comment">// Go back to query (remove type-ahead string)
            </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">delimChar</span><span class="hl-code"> &amp;&amp; </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_sSavedQuery</span><span class="hl-brackets">) {
                </span><span class="hl-reserved">if </span><span class="hl-brackets">(</span><span class="hl-code">!</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_textMatchesOption</span><span class="hl-brackets">()) {
                    </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oTextbox</span><span class="hl-code">.</span><span class="hl-identifier">value</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_sSavedQuery</span><span class="hl-code">;
                </span><span class="hl-brackets">}
                </span><span class="hl-reserved">else </span><span class="hl-brackets">{
                    </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oTextbox</span><span class="hl-code">.</span><span class="hl-identifier">value</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_sSavedQuery</span><span class="hl-code"> + </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_sCurQuery</span><span class="hl-code">;
                </span><span class="hl-brackets">}
            }
            </span><span class="hl-reserved">else </span><span class="hl-brackets">{
                </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oTextbox</span><span class="hl-code">.</span><span class="hl-identifier">value</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_sCurQuery</span><span class="hl-code">;
            </span><span class="hl-brackets">}
            </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oCurItem</span><span class="hl-code"> = </span><span class="hl-reserved">null</span><span class="hl-code">;
            </span><span class="hl-reserved">return</span><span class="hl-code">;
        </span><span class="hl-brackets">}
        </span><span class="hl-reserved">if </span><span class="hl-brackets">(</span><span class="hl-identifier">nNewItemIndex</span><span class="hl-code"> == -</span><span class="hl-number">2</span><span class="hl-brackets">) {
            </span><span class="hl-comment">// Close container
            </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_toggleContainer</span><span class="hl-brackets">(</span><span class="hl-reserved">false</span><span class="hl-brackets">)</span><span class="hl-code">;
            </span><span class="hl-reserved">return</span><span class="hl-code">;
        </span><span class="hl-brackets">}

        </span><span class="hl-reserved">var </span><span class="hl-identifier">oNewItem</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_aListItems</span><span class="hl-brackets">[</span><span class="hl-identifier">nNewItemIndex</span><span class="hl-brackets">]</span><span class="hl-code">;

        </span><span class="hl-comment">// Scroll the container if necessary
        </span><span class="hl-reserved">var </span><span class="hl-identifier">oContent</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oContent</span><span class="hl-code">;
        </span><span class="hl-reserved">var </span><span class="hl-identifier">scrollOn</span><span class="hl-code"> = </span><span class="hl-brackets">((</span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">Dom</span><span class="hl-code">.</span><span class="hl-identifier">getStyle</span><span class="hl-brackets">(</span><span class="hl-identifier">oContent</span><span class="hl-code">,</span><span class="hl-quotes">&quot;</span><span class="hl-string">overflow</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">)</span><span class="hl-code"> == </span><span class="hl-quotes">&quot;</span><span class="hl-string">auto</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">)</span><span class="hl-code"> ||
            </span><span class="hl-brackets">(</span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">Dom</span><span class="hl-code">.</span><span class="hl-identifier">getStyle</span><span class="hl-brackets">(</span><span class="hl-identifier">oContent</span><span class="hl-code">,</span><span class="hl-quotes">&quot;</span><span class="hl-string">overflowY</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">)</span><span class="hl-code"> == </span><span class="hl-quotes">&quot;</span><span class="hl-string">auto</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">))</span><span class="hl-code">;
        </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">scrollOn</span><span class="hl-code"> &amp;&amp; </span><span class="hl-brackets">(</span><span class="hl-identifier">nNewItemIndex</span><span class="hl-code"> &gt; -</span><span class="hl-number">1</span><span class="hl-brackets">)</span><span class="hl-code"> &amp;&amp;
        </span><span class="hl-brackets">(</span><span class="hl-identifier">nNewItemIndex</span><span class="hl-code"> &lt; </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_nDisplayedItems</span><span class="hl-brackets">)) {
            </span><span class="hl-comment">// User is keying down
            </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">nKeyCode</span><span class="hl-code"> == </span><span class="hl-number">40</span><span class="hl-brackets">) {
                </span><span class="hl-comment">// Bottom of selected item is below scroll area...
                </span><span class="hl-reserved">if</span><span class="hl-brackets">((</span><span class="hl-identifier">oNewItem</span><span class="hl-code">.</span><span class="hl-identifier">offsetTop</span><span class="hl-code">+</span><span class="hl-identifier">oNewItem</span><span class="hl-code">.</span><span class="hl-identifier">offsetHeight</span><span class="hl-brackets">)</span><span class="hl-code"> &gt; </span><span class="hl-brackets">(</span><span class="hl-identifier">oContent</span><span class="hl-code">.</span><span class="hl-identifier">scrollTop</span><span class="hl-code"> + </span><span class="hl-identifier">oContent</span><span class="hl-code">.</span><span class="hl-identifier">offsetHeight</span><span class="hl-brackets">)) {
                    </span><span class="hl-comment">// Set bottom of scroll area to bottom of selected item
                    </span><span class="hl-identifier">oContent</span><span class="hl-code">.</span><span class="hl-identifier">scrollTop</span><span class="hl-code"> = </span><span class="hl-brackets">(</span><span class="hl-identifier">oNewItem</span><span class="hl-code">.</span><span class="hl-identifier">offsetTop</span><span class="hl-code">+</span><span class="hl-identifier">oNewItem</span><span class="hl-code">.</span><span class="hl-identifier">offsetHeight</span><span class="hl-brackets">)</span><span class="hl-code"> - </span><span class="hl-identifier">oContent</span><span class="hl-code">.</span><span class="hl-identifier">offsetHeight</span><span class="hl-code">;
                </span><span class="hl-brackets">}
                </span><span class="hl-comment">// Bottom of selected item is above scroll area...
                </span><span class="hl-reserved">else if</span><span class="hl-brackets">((</span><span class="hl-identifier">oNewItem</span><span class="hl-code">.</span><span class="hl-identifier">offsetTop</span><span class="hl-code">+</span><span class="hl-identifier">oNewItem</span><span class="hl-code">.</span><span class="hl-identifier">offsetHeight</span><span class="hl-brackets">)</span><span class="hl-code"> &lt; </span><span class="hl-identifier">oContent</span><span class="hl-code">.</span><span class="hl-identifier">scrollTop</span><span class="hl-brackets">) {
                    </span><span class="hl-comment">// Set top of selected item to top of scroll area
                    </span><span class="hl-identifier">oContent</span><span class="hl-code">.</span><span class="hl-identifier">scrollTop</span><span class="hl-code"> = </span><span class="hl-identifier">oNewItem</span><span class="hl-code">.</span><span class="hl-identifier">offsetTop</span><span class="hl-code">;

                </span><span class="hl-brackets">}
            }
            </span><span class="hl-comment">// User is keying up
            </span><span class="hl-reserved">else </span><span class="hl-brackets">{
                </span><span class="hl-comment">// Top of selected item is above scroll area
                </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">oNewItem</span><span class="hl-code">.</span><span class="hl-identifier">offsetTop</span><span class="hl-code"> &lt; </span><span class="hl-identifier">oContent</span><span class="hl-code">.</span><span class="hl-identifier">scrollTop</span><span class="hl-brackets">) {
                    </span><span class="hl-comment">// Set top of scroll area to top of selected item
                    </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oContent</span><span class="hl-code">.</span><span class="hl-identifier">scrollTop</span><span class="hl-code"> = </span><span class="hl-identifier">oNewItem</span><span class="hl-code">.</span><span class="hl-identifier">offsetTop</span><span class="hl-code">;
                </span><span class="hl-brackets">}
                </span><span class="hl-comment">// Top of selected item is below scroll area
                </span><span class="hl-reserved">else if</span><span class="hl-brackets">(</span><span class="hl-identifier">oNewItem</span><span class="hl-code">.</span><span class="hl-identifier">offsetTop</span><span class="hl-code"> &gt; </span><span class="hl-brackets">(</span><span class="hl-identifier">oContent</span><span class="hl-code">.</span><span class="hl-identifier">scrollTop</span><span class="hl-code"> + </span><span class="hl-identifier">oContent</span><span class="hl-code">.</span><span class="hl-identifier">offsetHeight</span><span class="hl-brackets">)) {
                    </span><span class="hl-comment">// Set bottom of selected item to bottom of scroll area
                    </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oContainer</span><span class="hl-code">.</span><span class="hl-identifier">_oContent</span><span class="hl-code">.</span><span class="hl-identifier">scrollTop</span><span class="hl-code"> = </span><span class="hl-brackets">(</span><span class="hl-identifier">oNewItem</span><span class="hl-code">.</span><span class="hl-identifier">offsetTop</span><span class="hl-code">+</span><span class="hl-identifier">oNewItem</span><span class="hl-code">.</span><span class="hl-identifier">offsetHeight</span><span class="hl-brackets">)</span><span class="hl-code"> - </span><span class="hl-identifier">oContent</span><span class="hl-code">.</span><span class="hl-identifier">offsetHeight</span><span class="hl-code">;
                </span><span class="hl-brackets">}
            }
        }

        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_toggleHighlight</span><span class="hl-brackets">(</span><span class="hl-identifier">oNewItem</span><span class="hl-code">, </span><span class="hl-quotes">&quot;</span><span class="hl-string">to</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">itemArrowToEvent</span><span class="hl-code">.</span><span class="hl-identifier">fire</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">, </span><span class="hl-identifier">oNewItem</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">typeAhead</span><span class="hl-brackets">) {
            </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_updateValue</span><span class="hl-brackets">(</span><span class="hl-identifier">oNewItem</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-brackets">}
    }
}</span><span class="hl-default">;

</span><span class="hl-comment">/////////////////////////////////////////////////////////////////////////////
//
// Private event handlers
//
/////////////////////////////////////////////////////////////////////////////

/**
 * Handles &amp;lt;li&amp;gt; element mouseover events in the container.
 *
 * @method _onItemMouseover
 * @param v {HTMLEvent} The mouseover event.
 * @param oSelf {Object} The AutoComplete instance.
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_onItemMouseover</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">(</span><span class="hl-identifier">v</span><span class="hl-code">,</span><span class="hl-identifier">oSelf</span><span class="hl-brackets">) {
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">prehighlightClassName</span><span class="hl-brackets">) {
        </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_togglePrehighlight</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">,</span><span class="hl-quotes">&quot;</span><span class="hl-string">mouseover</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-brackets">}
    </span><span class="hl-reserved">else </span><span class="hl-brackets">{
        </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_toggleHighlight</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">,</span><span class="hl-quotes">&quot;</span><span class="hl-string">to</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-brackets">}

    </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">itemMouseOverEvent</span><span class="hl-code">.</span><span class="hl-identifier">fire</span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-code">, </span><span class="hl-reserved">this</span><span class="hl-brackets">)</span><span class="hl-code">;
</span><span class="hl-brackets">}</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Handles &amp;lt;li&amp;gt; element mouseout events in the container.
 *
 * @method _onItemMouseout
 * @param v {HTMLEvent} The mouseout event.
 * @param oSelf {Object} The AutoComplete instance.
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_onItemMouseout</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">(</span><span class="hl-identifier">v</span><span class="hl-code">,</span><span class="hl-identifier">oSelf</span><span class="hl-brackets">) {
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">prehighlightClassName</span><span class="hl-brackets">) {
        </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_togglePrehighlight</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">,</span><span class="hl-quotes">&quot;</span><span class="hl-string">mouseout</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-brackets">}
    </span><span class="hl-reserved">else </span><span class="hl-brackets">{
        </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_toggleHighlight</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">,</span><span class="hl-quotes">&quot;</span><span class="hl-string">from</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-brackets">}

    </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">itemMouseOutEvent</span><span class="hl-code">.</span><span class="hl-identifier">fire</span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-code">, </span><span class="hl-reserved">this</span><span class="hl-brackets">)</span><span class="hl-code">;
</span><span class="hl-brackets">}</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Handles &amp;lt;li&amp;gt; element click events in the container.
 *
 * @method _onItemMouseclick
 * @param v {HTMLEvent} The click event.
 * @param oSelf {Object} The AutoComplete instance.
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_onItemMouseclick</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">(</span><span class="hl-identifier">v</span><span class="hl-code">,</span><span class="hl-identifier">oSelf</span><span class="hl-brackets">) {
    </span><span class="hl-comment">// In case item has not been moused over
    </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_toggleHighlight</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">,</span><span class="hl-quotes">&quot;</span><span class="hl-string">to</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_selectItem</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-brackets">)</span><span class="hl-code">;
</span><span class="hl-brackets">}</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Handles container mouseover events.
 *
 * @method _onContainerMouseover
 * @param v {HTMLEvent} The mouseover event.
 * @param oSelf {Object} The AutoComplete instance.
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_onContainerMouseover</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">(</span><span class="hl-identifier">v</span><span class="hl-code">,</span><span class="hl-identifier">oSelf</span><span class="hl-brackets">) {
    </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_bOverContainer</span><span class="hl-code"> = </span><span class="hl-reserved">true</span><span class="hl-code">;
</span><span class="hl-brackets">}</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Handles container mouseout events.
 *
 * @method _onContainerMouseout
 * @param v {HTMLEvent} The mouseout event.
 * @param oSelf {Object} The AutoComplete instance.
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_onContainerMouseout</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">(</span><span class="hl-identifier">v</span><span class="hl-code">,</span><span class="hl-identifier">oSelf</span><span class="hl-brackets">) {
    </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_bOverContainer</span><span class="hl-code"> = </span><span class="hl-reserved">false</span><span class="hl-code">;
    </span><span class="hl-comment">// If container is still active
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_oCurItem</span><span class="hl-brackets">) {
        </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_toggleHighlight</span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_oCurItem</span><span class="hl-code">,</span><span class="hl-quotes">&quot;</span><span class="hl-string">to</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-brackets">}
}</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Handles container scroll events.
 *
 * @method _onContainerScroll
 * @param v {HTMLEvent} The scroll event.
 * @param oSelf {Object} The AutoComplete instance.
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_onContainerScroll</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">(</span><span class="hl-identifier">v</span><span class="hl-code">,</span><span class="hl-identifier">oSelf</span><span class="hl-brackets">) {
    </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_oTextbox</span><span class="hl-code">.</span><span class="hl-identifier">focus</span><span class="hl-brackets">()</span><span class="hl-code">;
</span><span class="hl-brackets">}</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Handles container resize events.
 *
 * @method _onContainerResize
 * @param v {HTMLEvent} The resize event.
 * @param oSelf {Object} The AutoComplete instance.
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_onContainerResize</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">(</span><span class="hl-identifier">v</span><span class="hl-code">,</span><span class="hl-identifier">oSelf</span><span class="hl-brackets">) {
    </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_toggleContainerHelpers</span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_bContainerOpen</span><span class="hl-brackets">)</span><span class="hl-code">;
</span><span class="hl-brackets">}</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Handles textbox keydown events of functional keys, mainly for UI behavior.
 *
 * @method _onTextboxKeyDown
 * @param v {HTMLEvent} The keydown event.
 * @param oSelf {object} The AutoComplete instance.
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_onTextboxKeyDown</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">(</span><span class="hl-identifier">v</span><span class="hl-code">,</span><span class="hl-identifier">oSelf</span><span class="hl-brackets">) {
    </span><span class="hl-reserved">var </span><span class="hl-identifier">nKeyCode</span><span class="hl-code"> = </span><span class="hl-identifier">v</span><span class="hl-code">.</span><span class="hl-identifier">keyCode</span><span class="hl-code">;

    </span><span class="hl-reserved">switch </span><span class="hl-brackets">(</span><span class="hl-identifier">nKeyCode</span><span class="hl-brackets">) {
        </span><span class="hl-reserved">case </span><span class="hl-number">9</span><span class="hl-code">: </span><span class="hl-comment">// tab
            </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">delimChar</span><span class="hl-code"> &amp;&amp; </span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_nKeyCode</span><span class="hl-code"> != </span><span class="hl-identifier">nKeyCode</span><span class="hl-brackets">)) {
                </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_bContainerOpen</span><span class="hl-brackets">) {
                    </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">Event</span><span class="hl-code">.</span><span class="hl-identifier">stopEvent</span><span class="hl-brackets">(</span><span class="hl-identifier">v</span><span class="hl-brackets">)</span><span class="hl-code">;
                </span><span class="hl-brackets">}
            }
            </span><span class="hl-comment">// select an item or clear out
            </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_oCurItem</span><span class="hl-brackets">) {
                </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_selectItem</span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_oCurItem</span><span class="hl-brackets">)</span><span class="hl-code">;
            </span><span class="hl-brackets">}
            </span><span class="hl-reserved">else </span><span class="hl-brackets">{
                </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_toggleContainer</span><span class="hl-brackets">(</span><span class="hl-reserved">false</span><span class="hl-brackets">)</span><span class="hl-code">;
            </span><span class="hl-brackets">}
            </span><span class="hl-reserved">break</span><span class="hl-code">;
        </span><span class="hl-reserved">case </span><span class="hl-number">13</span><span class="hl-code">: </span><span class="hl-comment">// enter
            </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_nKeyCode</span><span class="hl-code"> != </span><span class="hl-identifier">nKeyCode</span><span class="hl-brackets">) {
                </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_bContainerOpen</span><span class="hl-brackets">) {
                    </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">Event</span><span class="hl-code">.</span><span class="hl-identifier">stopEvent</span><span class="hl-brackets">(</span><span class="hl-identifier">v</span><span class="hl-brackets">)</span><span class="hl-code">;
                </span><span class="hl-brackets">}
            }
            </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_oCurItem</span><span class="hl-brackets">) {
                </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_selectItem</span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_oCurItem</span><span class="hl-brackets">)</span><span class="hl-code">;
            </span><span class="hl-brackets">}
            </span><span class="hl-reserved">else </span><span class="hl-brackets">{
                </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_toggleContainer</span><span class="hl-brackets">(</span><span class="hl-reserved">false</span><span class="hl-brackets">)</span><span class="hl-code">;
            </span><span class="hl-brackets">}
            </span><span class="hl-reserved">break</span><span class="hl-code">;
        </span><span class="hl-reserved">case </span><span class="hl-number">27</span><span class="hl-code">: </span><span class="hl-comment">// esc
            </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_toggleContainer</span><span class="hl-brackets">(</span><span class="hl-reserved">false</span><span class="hl-brackets">)</span><span class="hl-code">;
            </span><span class="hl-reserved">return</span><span class="hl-code">;
        </span><span class="hl-reserved">case </span><span class="hl-number">39</span><span class="hl-code">: </span><span class="hl-comment">// right
            </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_jumpSelection</span><span class="hl-brackets">()</span><span class="hl-code">;
            </span><span class="hl-reserved">break</span><span class="hl-code">;
        </span><span class="hl-reserved">case </span><span class="hl-number">38</span><span class="hl-code">: </span><span class="hl-comment">// up
            </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">Event</span><span class="hl-code">.</span><span class="hl-identifier">stopEvent</span><span class="hl-brackets">(</span><span class="hl-identifier">v</span><span class="hl-brackets">)</span><span class="hl-code">;
            </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_moveSelection</span><span class="hl-brackets">(</span><span class="hl-identifier">nKeyCode</span><span class="hl-brackets">)</span><span class="hl-code">;
            </span><span class="hl-reserved">break</span><span class="hl-code">;
        </span><span class="hl-reserved">case </span><span class="hl-number">40</span><span class="hl-code">: </span><span class="hl-comment">// down
            </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">Event</span><span class="hl-code">.</span><span class="hl-identifier">stopEvent</span><span class="hl-brackets">(</span><span class="hl-identifier">v</span><span class="hl-brackets">)</span><span class="hl-code">;
            </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_moveSelection</span><span class="hl-brackets">(</span><span class="hl-identifier">nKeyCode</span><span class="hl-brackets">)</span><span class="hl-code">;
            </span><span class="hl-reserved">break</span><span class="hl-code">;
        </span><span class="hl-reserved">default</span><span class="hl-code">:
            </span><span class="hl-reserved">break</span><span class="hl-code">;
    </span><span class="hl-brackets">}
}</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Handles textbox keypress events.
 * @method _onTextboxKeyPress
 * @param v {HTMLEvent} The keypress event.
 * @param oSelf {Object} The AutoComplete instance.
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_onTextboxKeyPress</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">(</span><span class="hl-identifier">v</span><span class="hl-code">,</span><span class="hl-identifier">oSelf</span><span class="hl-brackets">) {
    </span><span class="hl-reserved">var </span><span class="hl-identifier">nKeyCode</span><span class="hl-code"> = </span><span class="hl-identifier">v</span><span class="hl-code">.</span><span class="hl-identifier">keyCode</span><span class="hl-code">;

        </span><span class="hl-comment">//Expose only to Mac browsers, where stopEvent is ineffective on keydown events (bug 790337)
        </span><span class="hl-reserved">var </span><span class="hl-identifier">isMac</span><span class="hl-code"> = </span><span class="hl-brackets">(</span><span class="hl-builtin">navigator</span><span class="hl-code">.</span><span class="hl-identifier">userAgent</span><span class="hl-code">.</span><span class="hl-identifier">toLowerCase</span><span class="hl-brackets">()</span><span class="hl-code">.</span><span class="hl-identifier">indexOf</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">mac</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">)</span><span class="hl-code"> != -</span><span class="hl-number">1</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">isMac</span><span class="hl-brackets">) {
            </span><span class="hl-reserved">switch </span><span class="hl-brackets">(</span><span class="hl-identifier">nKeyCode</span><span class="hl-brackets">) {
            </span><span class="hl-reserved">case </span><span class="hl-number">9</span><span class="hl-code">: </span><span class="hl-comment">// tab
                </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">delimChar</span><span class="hl-code"> &amp;&amp; </span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_nKeyCode</span><span class="hl-code"> != </span><span class="hl-identifier">nKeyCode</span><span class="hl-brackets">)) {
                    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_bContainerOpen</span><span class="hl-brackets">) {
                        </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">Event</span><span class="hl-code">.</span><span class="hl-identifier">stopEvent</span><span class="hl-brackets">(</span><span class="hl-identifier">v</span><span class="hl-brackets">)</span><span class="hl-code">;
                    </span><span class="hl-brackets">}
                }
                </span><span class="hl-reserved">break</span><span class="hl-code">;
            </span><span class="hl-reserved">case </span><span class="hl-number">13</span><span class="hl-code">: </span><span class="hl-comment">// enter
                    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_nKeyCode</span><span class="hl-code"> != </span><span class="hl-identifier">nKeyCode</span><span class="hl-brackets">) {
                        </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_bContainerOpen</span><span class="hl-brackets">) {
                            </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">Event</span><span class="hl-code">.</span><span class="hl-identifier">stopEvent</span><span class="hl-brackets">(</span><span class="hl-identifier">v</span><span class="hl-brackets">)</span><span class="hl-code">;
                        </span><span class="hl-brackets">}
                    }
                </span><span class="hl-reserved">break</span><span class="hl-code">;
            </span><span class="hl-reserved">case </span><span class="hl-number">38</span><span class="hl-code">: </span><span class="hl-comment">// up
            </span><span class="hl-reserved">case </span><span class="hl-number">40</span><span class="hl-code">: </span><span class="hl-comment">// down
                </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">Event</span><span class="hl-code">.</span><span class="hl-identifier">stopEvent</span><span class="hl-brackets">(</span><span class="hl-identifier">v</span><span class="hl-brackets">)</span><span class="hl-code">;
                </span><span class="hl-reserved">break</span><span class="hl-code">;
            </span><span class="hl-reserved">default</span><span class="hl-code">:
                </span><span class="hl-reserved">break</span><span class="hl-code">;
            </span><span class="hl-brackets">}
        }

        </span><span class="hl-comment">//TODO: (?) limit only to non-IE, non-Mac-FF for Korean IME support (bug 811948)
        // Korean IME detected
        </span><span class="hl-reserved">else if</span><span class="hl-brackets">(</span><span class="hl-identifier">nKeyCode</span><span class="hl-code"> == </span><span class="hl-number">229</span><span class="hl-brackets">) {
            </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_queryInterval</span><span class="hl-code"> = </span><span class="hl-identifier">setInterval</span><span class="hl-brackets">(</span><span class="hl-reserved">function</span><span class="hl-brackets">() { </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_onIMEDetected</span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-brackets">)</span><span class="hl-code">; </span><span class="hl-brackets">}</span><span class="hl-code">,</span><span class="hl-number">500</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-brackets">}
}</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Handles textbox keyup events that trigger queries.
 *
 * @method _onTextboxKeyUp
 * @param v {HTMLEvent} The keyup event.
 * @param oSelf {Object} The AutoComplete instance.
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_onTextboxKeyUp</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">(</span><span class="hl-identifier">v</span><span class="hl-code">,</span><span class="hl-identifier">oSelf</span><span class="hl-brackets">) {
    </span><span class="hl-comment">// Check to see if any of the public properties have been updated
    </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_initProps</span><span class="hl-brackets">()</span><span class="hl-code">;

    </span><span class="hl-reserved">var </span><span class="hl-identifier">nKeyCode</span><span class="hl-code"> = </span><span class="hl-identifier">v</span><span class="hl-code">.</span><span class="hl-identifier">keyCode</span><span class="hl-code">;
    </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_nKeyCode</span><span class="hl-code"> = </span><span class="hl-identifier">nKeyCode</span><span class="hl-code">;
    </span><span class="hl-reserved">var </span><span class="hl-identifier">sText</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">value</span><span class="hl-code">; </span><span class="hl-comment">//string in textbox

    // Filter out chars that don't trigger queries
    </span><span class="hl-reserved">if </span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_isIgnoreKey</span><span class="hl-brackets">(</span><span class="hl-identifier">nKeyCode</span><span class="hl-brackets">)</span><span class="hl-code"> || </span><span class="hl-brackets">(</span><span class="hl-identifier">sText</span><span class="hl-code">.</span><span class="hl-identifier">toLowerCase</span><span class="hl-brackets">()</span><span class="hl-code"> == </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_sCurQuery</span><span class="hl-brackets">)) {
        </span><span class="hl-reserved">return</span><span class="hl-code">;
    </span><span class="hl-brackets">}
    </span><span class="hl-reserved">else </span><span class="hl-brackets">{
        </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">textboxKeyEvent</span><span class="hl-code">.</span><span class="hl-identifier">fire</span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-code">, </span><span class="hl-identifier">nKeyCode</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-brackets">}

    </span><span class="hl-comment">// Set timeout on the request
    </span><span class="hl-reserved">if </span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">queryDelay</span><span class="hl-code"> &gt; </span><span class="hl-number">0</span><span class="hl-brackets">) {
        </span><span class="hl-reserved">var </span><span class="hl-identifier">nDelayID</span><span class="hl-code"> =
            </span><span class="hl-identifier">setTimeout</span><span class="hl-brackets">(</span><span class="hl-reserved">function</span><span class="hl-brackets">(){</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_sendQuery</span><span class="hl-brackets">(</span><span class="hl-identifier">sText</span><span class="hl-brackets">)</span><span class="hl-code">;</span><span class="hl-brackets">}</span><span class="hl-code">,</span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">queryDelay</span><span class="hl-code"> * </span><span class="hl-number">1000</span><span class="hl-brackets">))</span><span class="hl-code">;

        </span><span class="hl-reserved">if </span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_nDelayID</span><span class="hl-code"> != -</span><span class="hl-number">1</span><span class="hl-brackets">) {
            </span><span class="hl-identifier">clearTimeout</span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_nDelayID</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-brackets">}

        </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_nDelayID</span><span class="hl-code"> = </span><span class="hl-identifier">nDelayID</span><span class="hl-code">;
    </span><span class="hl-brackets">}
    </span><span class="hl-reserved">else </span><span class="hl-brackets">{
        </span><span class="hl-comment">// No delay so send request immediately
        </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_sendQuery</span><span class="hl-brackets">(</span><span class="hl-identifier">sText</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-brackets">}
}</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Handles text input box receiving focus.
 *
 * @method _onTextboxFocus
 * @param v {HTMLEvent} The focus event.
 * @param oSelf {Object} The AutoComplete instance.
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_onTextboxFocus</span><span class="hl-default"> = </span><span class="hl-reserved">function </span><span class="hl-brackets">(</span><span class="hl-identifier">v</span><span class="hl-code">,</span><span class="hl-identifier">oSelf</span><span class="hl-brackets">) {
    </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_oTextbox</span><span class="hl-code">.</span><span class="hl-identifier">setAttribute</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">autocomplete</span><span class="hl-quotes">&quot;</span><span class="hl-code">,</span><span class="hl-quotes">&quot;</span><span class="hl-string">off</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_bFocused</span><span class="hl-code"> = </span><span class="hl-reserved">true</span><span class="hl-code">;
    </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">textboxFocusEvent</span><span class="hl-code">.</span><span class="hl-identifier">fire</span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-brackets">)</span><span class="hl-code">;
</span><span class="hl-brackets">}</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Handles text input box losing focus.
 *
 * @method _onTextboxBlur
 * @param v {HTMLEvent} The focus event.
 * @param oSelf {Object} The AutoComplete instance.
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_onTextboxBlur</span><span class="hl-default"> = </span><span class="hl-reserved">function </span><span class="hl-brackets">(</span><span class="hl-identifier">v</span><span class="hl-code">,</span><span class="hl-identifier">oSelf</span><span class="hl-brackets">) {
    </span><span class="hl-comment">// Don't treat as a blur if it was a selection via mouse click
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-code">!</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_bOverContainer</span><span class="hl-code"> || </span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_nKeyCode</span><span class="hl-code"> == </span><span class="hl-number">9</span><span class="hl-brackets">)) {
        </span><span class="hl-comment">// Current query needs to be validated
        </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-code">!</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_bItemSelected</span><span class="hl-brackets">) {
            </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-code">!</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_bContainerOpen</span><span class="hl-code"> || </span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_bContainerOpen</span><span class="hl-code"> &amp;&amp; !</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_textMatchesOption</span><span class="hl-brackets">())) {
                </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">forceSelection</span><span class="hl-brackets">) {
                    </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_clearSelection</span><span class="hl-brackets">()</span><span class="hl-code">;
                </span><span class="hl-brackets">}
                </span><span class="hl-reserved">else </span><span class="hl-brackets">{
                    </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">unmatchedItemSelectEvent</span><span class="hl-code">.</span><span class="hl-identifier">fire</span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-code">, </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_sCurQuery</span><span class="hl-brackets">)</span><span class="hl-code">;
                </span><span class="hl-brackets">}
            }
        }

        </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_bContainerOpen</span><span class="hl-brackets">) {
            </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_toggleContainer</span><span class="hl-brackets">(</span><span class="hl-reserved">false</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-brackets">}
        </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_cancelIntervalDetection</span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_bFocused</span><span class="hl-code"> = </span><span class="hl-reserved">false</span><span class="hl-code">;
        </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">textboxBlurEvent</span><span class="hl-code">.</span><span class="hl-identifier">fire</span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-brackets">}
}</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Handles form submission event.
 *
 * @method _onFormSubmit
 * @param v {HTMLEvent} The submit event.
 * @param oSelf {Object} The AutoComplete instance.
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">AutoComplete</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_onFormSubmit</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">(</span><span class="hl-identifier">v</span><span class="hl-code">,</span><span class="hl-identifier">oSelf</span><span class="hl-brackets">) {
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">allowBrowserAutocomplete</span><span class="hl-brackets">) {
        </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_oTextbox</span><span class="hl-code">.</span><span class="hl-identifier">setAttribute</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">autocomplete</span><span class="hl-quotes">&quot;</span><span class="hl-code">,</span><span class="hl-quotes">&quot;</span><span class="hl-string">on</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-brackets">}
    </span><span class="hl-reserved">else </span><span class="hl-brackets">{
        </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_oTextbox</span><span class="hl-code">.</span><span class="hl-identifier">setAttribute</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">autocomplete</span><span class="hl-quotes">&quot;</span><span class="hl-code">,</span><span class="hl-quotes">&quot;</span><span class="hl-string">off</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-brackets">}
}</span><span class="hl-default">;
</span><span class="hl-comment">/****************************************************************************/
// holder
/****************************************************************************/
// holder
/****************************************************************************/
// holder
/**
 * The DataSource classes manages sending a request and returning response from a live
 * database. Supported data include local JavaScript arrays and objects and databases
 * accessible via XHR connections. Supported response formats include JavaScript arrays,
 * JSON, XML, and flat-file textual data.
 *  
 * @class DataSource
 * @constructor
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DataSource</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">() { 
    </span><span class="hl-comment">/* abstract class */
</span><span class="hl-brackets">}</span><span class="hl-default">;


</span><span class="hl-comment">/////////////////////////////////////////////////////////////////////////////
//
// Public constants
//
/////////////////////////////////////////////////////////////////////////////

/**
 * Error message for null data responses.
 *
 * @property ERROR_DATANULL
 * @type String
 * @static
 * @final
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DataSource</span><span class="hl-default">.</span><span class="hl-identifier">ERROR_DATANULL</span><span class="hl-default"> = </span><span class="hl-quotes">&quot;</span><span class="hl-string">Response data was null</span><span class="hl-quotes">&quot;</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Error message for data responses with parsing errors.
 *
 * @property ERROR_DATAPARSE
 * @type String
 * @static
 * @final
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DataSource</span><span class="hl-default">.</span><span class="hl-identifier">ERROR_DATAPARSE</span><span class="hl-default"> = </span><span class="hl-quotes">&quot;</span><span class="hl-string">Response data could not be parsed</span><span class="hl-quotes">&quot;</span><span class="hl-default">;


</span><span class="hl-comment">/////////////////////////////////////////////////////////////////////////////
//
// Public member variables
//
/////////////////////////////////////////////////////////////////////////////

/**
 * Max size of the local cache.  Set to 0 to turn off caching.  Caching is
 * useful to reduce the number of server connections.  Recommended only for data
 * sources that return comprehensive results for queries or when stale data is
 * not an issue.
 *
 * @property maxCacheEntries
 * @type Number
 * @default 15
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DataSource</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">maxCacheEntries</span><span class="hl-default"> = </span><span class="hl-number">15</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Use this to equate cache matching with the type of matching done by your live
 * data source. If caching is on and queryMatchContains is true, the cache
 * returns results that &quot;contain&quot; the query string. By default,
 * queryMatchContains is set to false, meaning the cache only returns results
 * that &quot;start with&quot; the query string.
 *
 * @property queryMatchContains
 * @type Boolean
 * @default false
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DataSource</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">queryMatchContains</span><span class="hl-default"> = </span><span class="hl-reserved">false</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Enables query subset matching. If caching is on and queryMatchSubset is
 * true, substrings of queries will return matching cached results. For
 * instance, if the first query is for &quot;abc&quot; susequent queries that start with
 * &quot;abc&quot;, like &quot;abcd&quot;, will be queried against the cache, and not the live data
 * source. Recommended only for DataSources that return comprehensive results
 * for queries with very few characters.
 *
 * @property queryMatchSubset
 * @type Boolean
 * @default false
 *
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DataSource</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">queryMatchSubset</span><span class="hl-default"> = </span><span class="hl-reserved">false</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Enables query case-sensitivity matching. If caching is on and
 * queryMatchCase is true, queries will only return results for case-sensitive
 * matches.
 *
 * @property queryMatchCase
 * @type Boolean
 * @default false
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DataSource</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">queryMatchCase</span><span class="hl-default"> = </span><span class="hl-reserved">false</span><span class="hl-default">;


</span><span class="hl-comment">/////////////////////////////////////////////////////////////////////////////
//
// Public methods
//
/////////////////////////////////////////////////////////////////////////////

 /**
 * Public accessor to the unique name of the DataSource instance.
 *
 * @method toString
 * @return {String} Unique name of the DataSource instance
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DataSource</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">toString</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">() {
    </span><span class="hl-reserved">return </span><span class="hl-quotes">&quot;</span><span class="hl-string">DataSource </span><span class="hl-quotes">&quot;</span><span class="hl-code"> + </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_sName</span><span class="hl-code">;
</span><span class="hl-brackets">}</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Retrieves query results, first checking the local cache, then making the
 * query request to the live data source as defined by the function doQuery.
 *
 * @method getResults
 * @param oCallbackFn {HTMLFunction} Callback function defined by oParent object to which to return results.
 * @param sQuery {String} Query string.
 * @param oParent {Object} The object instance that has requested data.
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DataSource</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">getResults</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">(</span><span class="hl-identifier">oCallbackFn</span><span class="hl-code">, </span><span class="hl-identifier">sQuery</span><span class="hl-code">, </span><span class="hl-identifier">oParent</span><span class="hl-brackets">) {
    
    </span><span class="hl-comment">// First look in cache
    </span><span class="hl-reserved">var </span><span class="hl-identifier">aResults</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_doQueryCache</span><span class="hl-brackets">(</span><span class="hl-identifier">oCallbackFn</span><span class="hl-code">,</span><span class="hl-identifier">sQuery</span><span class="hl-code">,</span><span class="hl-identifier">oParent</span><span class="hl-brackets">)</span><span class="hl-code">;
    
    </span><span class="hl-comment">// Not in cache, so get results from server
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">aResults</span><span class="hl-code">.</span><span class="hl-identifier">length</span><span class="hl-code"> === </span><span class="hl-number">0</span><span class="hl-brackets">) {
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">queryEvent</span><span class="hl-code">.</span><span class="hl-identifier">fire</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">, </span><span class="hl-identifier">oParent</span><span class="hl-code">, </span><span class="hl-identifier">sQuery</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">doQuery</span><span class="hl-brackets">(</span><span class="hl-identifier">oCallbackFn</span><span class="hl-code">, </span><span class="hl-identifier">sQuery</span><span class="hl-code">, </span><span class="hl-identifier">oParent</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-brackets">}
}</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Abstract method implemented by subclasses to make a query to the live data
 * source. Must call the callback function with the response returned from the
 * query. Populates cache (if enabled).
 *
 * @method doQuery
 * @param oCallbackFn {HTMLFunction} Callback function implemented by oParent to which to return results.
 * @param sQuery {String} Query string.
 * @param oParent {Object} The object instance that has requested data.
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DataSource</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">doQuery</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">(</span><span class="hl-identifier">oCallbackFn</span><span class="hl-code">, </span><span class="hl-identifier">sQuery</span><span class="hl-code">, </span><span class="hl-identifier">oParent</span><span class="hl-brackets">) {
    </span><span class="hl-comment">/* override this */ 
</span><span class="hl-brackets">}</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Flushes cache.
 *
 * @method flushCache
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DataSource</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">flushCache</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">() {
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_aCache</span><span class="hl-brackets">) {
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_aCache</span><span class="hl-code"> = </span><span class="hl-brackets">[]</span><span class="hl-code">;
    </span><span class="hl-brackets">}
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_aCacheHelper</span><span class="hl-brackets">) {
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_aCacheHelper</span><span class="hl-code"> = </span><span class="hl-brackets">[]</span><span class="hl-code">;
    </span><span class="hl-brackets">}
    </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">cacheFlushEvent</span><span class="hl-code">.</span><span class="hl-identifier">fire</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-brackets">)</span><span class="hl-code">;
</span><span class="hl-brackets">}</span><span class="hl-default">;

</span><span class="hl-comment">/////////////////////////////////////////////////////////////////////////////
//
// Public events
//
/////////////////////////////////////////////////////////////////////////////

/**
 * Fired when a query is made to the live data source.
 *
 * @event queryEvent
 * @param oSelf {Object} The DataSource instance.
 * @param oParent {Object} The requesting object.
 * @param sQuery {String} The query string.
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DataSource</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">queryEvent</span><span class="hl-default"> = </span><span class="hl-reserved">null</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Fired when a query is made to the local cache.
 *
 * @event cacheQueryEvent
 * @param oSelf {Object} The DataSource instance.
 * @param oParent {Object} The requesting object.
 * @param sQuery {String} The query string.
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DataSource</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">cacheQueryEvent</span><span class="hl-default"> = </span><span class="hl-reserved">null</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Fired when data is retrieved from the live data source.
 *
 * @event getResultsEvent
 * @param oSelf {Object} The DataSource instance.
 * @param oParent {Object} The requesting object.
 * @param sQuery {String} The query string.
 * @param aResults {Object[]} Array of result objects.
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DataSource</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">getResultsEvent</span><span class="hl-default"> = </span><span class="hl-reserved">null</span><span class="hl-default">;
    
</span><span class="hl-comment">/**
 * Fired when data is retrieved from the local cache.
 *
 * @event getCachedResultsEvent
 * @param oSelf {Object} The DataSource instance.
 * @param oParent {Object} The requesting object.
 * @param sQuery {String} The query string.
 * @param aResults {Object[]} Array of result objects.
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DataSource</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">getCachedResultsEvent</span><span class="hl-default"> = </span><span class="hl-reserved">null</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Fired when an error is encountered with the live data source.
 *
 * @event dataErrorEvent
 * @param oSelf {Object} The DataSource instance.
 * @param oParent {Object} The requesting object.
 * @param sQuery {String} The query string.
 * @param sMsg {String} Error message string
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DataSource</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">dataErrorEvent</span><span class="hl-default"> = </span><span class="hl-reserved">null</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Fired when the local cache is flushed.
 *
 * @event cacheFlushEvent
 * @param oSelf {Object} The DataSource instance
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DataSource</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">cacheFlushEvent</span><span class="hl-default"> = </span><span class="hl-reserved">null</span><span class="hl-default">;

</span><span class="hl-comment">/////////////////////////////////////////////////////////////////////////////
//
// Private member variables
//
/////////////////////////////////////////////////////////////////////////////

/**
 * Internal class variable to index multiple DataSource instances.
 *
 * @property _nIndex
 * @type Number
 * @private
 * @static
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DataSource</span><span class="hl-default">.</span><span class="hl-identifier">_nIndex</span><span class="hl-default"> = </span><span class="hl-number">0</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Name of DataSource instance.
 *
 * @property _sName
 * @type String
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DataSource</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_sName</span><span class="hl-default"> = </span><span class="hl-reserved">null</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Local cache of data result objects indexed chronologically.
 *
 * @property _aCache
 * @type Object[]
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DataSource</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_aCache</span><span class="hl-default"> = </span><span class="hl-reserved">null</span><span class="hl-default">;


</span><span class="hl-comment">/////////////////////////////////////////////////////////////////////////////
//
// Private methods
//
/////////////////////////////////////////////////////////////////////////////

/**
 * Initializes DataSource instance.
 *  
 * @method _init
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DataSource</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_init</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">() {
    </span><span class="hl-comment">// Validate and initialize public configs
    </span><span class="hl-reserved">var </span><span class="hl-identifier">maxCacheEntries</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">maxCacheEntries</span><span class="hl-code">;
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">isNaN</span><span class="hl-brackets">(</span><span class="hl-identifier">maxCacheEntries</span><span class="hl-brackets">)</span><span class="hl-code"> || </span><span class="hl-brackets">(</span><span class="hl-identifier">maxCacheEntries</span><span class="hl-code"> &lt; </span><span class="hl-number">0</span><span class="hl-brackets">)) {
        </span><span class="hl-identifier">maxCacheEntries</span><span class="hl-code"> = </span><span class="hl-number">0</span><span class="hl-code">;
    </span><span class="hl-brackets">}
    </span><span class="hl-comment">// Initialize local cache
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">maxCacheEntries</span><span class="hl-code"> &gt; </span><span class="hl-number">0</span><span class="hl-code"> &amp;&amp; !</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_aCache</span><span class="hl-brackets">) {
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_aCache</span><span class="hl-code"> = </span><span class="hl-brackets">[]</span><span class="hl-code">;
    </span><span class="hl-brackets">}
    
    </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_sName</span><span class="hl-code"> = </span><span class="hl-quotes">&quot;</span><span class="hl-string">instance</span><span class="hl-quotes">&quot;</span><span class="hl-code"> + </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">widget</span><span class="hl-code">.</span><span class="hl-identifier">DataSource</span><span class="hl-code">.</span><span class="hl-identifier">_nIndex</span><span class="hl-code">;
    </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">widget</span><span class="hl-code">.</span><span class="hl-identifier">DataSource</span><span class="hl-code">.</span><span class="hl-identifier">_nIndex</span><span class="hl-code">++;
    
    </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">queryEvent</span><span class="hl-code"> = </span><span class="hl-reserved">new </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">CustomEvent</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">query</span><span class="hl-quotes">&quot;</span><span class="hl-code">, </span><span class="hl-reserved">this</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">cacheQueryEvent</span><span class="hl-code"> = </span><span class="hl-reserved">new </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">CustomEvent</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">cacheQuery</span><span class="hl-quotes">&quot;</span><span class="hl-code">, </span><span class="hl-reserved">this</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">getResultsEvent</span><span class="hl-code"> = </span><span class="hl-reserved">new </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">CustomEvent</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">getResults</span><span class="hl-quotes">&quot;</span><span class="hl-code">, </span><span class="hl-reserved">this</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">getCachedResultsEvent</span><span class="hl-code"> = </span><span class="hl-reserved">new </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">CustomEvent</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">getCachedResults</span><span class="hl-quotes">&quot;</span><span class="hl-code">, </span><span class="hl-reserved">this</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">dataErrorEvent</span><span class="hl-code"> = </span><span class="hl-reserved">new </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">CustomEvent</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">dataError</span><span class="hl-quotes">&quot;</span><span class="hl-code">, </span><span class="hl-reserved">this</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">cacheFlushEvent</span><span class="hl-code"> = </span><span class="hl-reserved">new </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">util</span><span class="hl-code">.</span><span class="hl-identifier">CustomEvent</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">cacheFlush</span><span class="hl-quotes">&quot;</span><span class="hl-code">, </span><span class="hl-reserved">this</span><span class="hl-brackets">)</span><span class="hl-code">;
</span><span class="hl-brackets">}</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Adds a result object to the local cache, evicting the oldest element if the 
 * cache is full. Newer items will have higher indexes, the oldest item will have
 * index of 0. 
 *
 * @method _addCacheElem
 * @param oResult {Object} Data result object, including array of results.
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DataSource</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_addCacheElem</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">(</span><span class="hl-identifier">oResult</span><span class="hl-brackets">) {
    </span><span class="hl-reserved">var </span><span class="hl-identifier">aCache</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_aCache</span><span class="hl-code">;
    </span><span class="hl-comment">// Don't add if anything important is missing.
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-code">!</span><span class="hl-identifier">aCache</span><span class="hl-code"> || !</span><span class="hl-identifier">oResult</span><span class="hl-code"> || !</span><span class="hl-identifier">oResult</span><span class="hl-code">.</span><span class="hl-identifier">query</span><span class="hl-code"> || !</span><span class="hl-identifier">oResult</span><span class="hl-code">.</span><span class="hl-identifier">results</span><span class="hl-brackets">) {
        </span><span class="hl-reserved">return</span><span class="hl-code">;
    </span><span class="hl-brackets">}
    
    </span><span class="hl-comment">// If the cache is full, make room by removing from index=0
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">aCache</span><span class="hl-code">.</span><span class="hl-identifier">length</span><span class="hl-code"> &gt;= </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">maxCacheEntries</span><span class="hl-brackets">) {
        </span><span class="hl-identifier">aCache</span><span class="hl-code">.</span><span class="hl-identifier">shift</span><span class="hl-brackets">()</span><span class="hl-code">;
    </span><span class="hl-brackets">}
        
    </span><span class="hl-comment">// Add to cache, at the end of the array
    </span><span class="hl-identifier">aCache</span><span class="hl-code">.</span><span class="hl-identifier">push</span><span class="hl-brackets">(</span><span class="hl-identifier">oResult</span><span class="hl-brackets">)</span><span class="hl-code">;
</span><span class="hl-brackets">}</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Queries the local cache for results. If query has been cached, the callback
 * function is called with the results, and the cached is refreshed so that it
 * is now the newest element.  
 *
 * @method _doQueryCache
 * @param oCallbackFn {HTMLFunction} Callback function defined by oParent object to which to return results.
 * @param sQuery {String} Query string.
 * @param oParent {Object} The object instance that has requested data.
 * @return aResults {Object[]} Array of results from local cache if found, otherwise null.
 * @private 
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DataSource</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_doQueryCache</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">(</span><span class="hl-identifier">oCallbackFn</span><span class="hl-code">, </span><span class="hl-identifier">sQuery</span><span class="hl-code">, </span><span class="hl-identifier">oParent</span><span class="hl-brackets">) {
    </span><span class="hl-reserved">var </span><span class="hl-identifier">aResults</span><span class="hl-code"> = </span><span class="hl-brackets">[]</span><span class="hl-code">;
    </span><span class="hl-reserved">var </span><span class="hl-identifier">bMatchFound</span><span class="hl-code"> = </span><span class="hl-reserved">false</span><span class="hl-code">;
    </span><span class="hl-reserved">var </span><span class="hl-identifier">aCache</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_aCache</span><span class="hl-code">;
    </span><span class="hl-reserved">var </span><span class="hl-identifier">nCacheLength</span><span class="hl-code"> = </span><span class="hl-brackets">(</span><span class="hl-identifier">aCache</span><span class="hl-brackets">)</span><span class="hl-code"> ? </span><span class="hl-identifier">aCache</span><span class="hl-code">.</span><span class="hl-identifier">length</span><span class="hl-code"> : </span><span class="hl-number">0</span><span class="hl-code">;
    </span><span class="hl-reserved">var </span><span class="hl-identifier">bMatchContains</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">queryMatchContains</span><span class="hl-code">;
    
    </span><span class="hl-comment">// If cache is enabled...
    </span><span class="hl-reserved">if</span><span class="hl-brackets">((</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">maxCacheEntries</span><span class="hl-code"> &gt; </span><span class="hl-number">0</span><span class="hl-brackets">)</span><span class="hl-code"> &amp;&amp; </span><span class="hl-identifier">aCache</span><span class="hl-code"> &amp;&amp; </span><span class="hl-brackets">(</span><span class="hl-identifier">nCacheLength</span><span class="hl-code"> &gt; </span><span class="hl-number">0</span><span class="hl-brackets">)) {
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">cacheQueryEvent</span><span class="hl-code">.</span><span class="hl-identifier">fire</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">, </span><span class="hl-identifier">oParent</span><span class="hl-code">, </span><span class="hl-identifier">sQuery</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-comment">// If case is unimportant, normalize query now instead of in loops
        </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-code">!</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">queryMatchCase</span><span class="hl-brackets">) {
            </span><span class="hl-reserved">var </span><span class="hl-identifier">sOrigQuery</span><span class="hl-code"> = </span><span class="hl-identifier">sQuery</span><span class="hl-code">;
            </span><span class="hl-identifier">sQuery</span><span class="hl-code"> = </span><span class="hl-identifier">sQuery</span><span class="hl-code">.</span><span class="hl-identifier">toLowerCase</span><span class="hl-brackets">()</span><span class="hl-code">;
        </span><span class="hl-brackets">}

        </span><span class="hl-comment">// Loop through each cached element's query property...
        </span><span class="hl-reserved">for</span><span class="hl-brackets">(</span><span class="hl-reserved">var </span><span class="hl-identifier">i</span><span class="hl-code"> = </span><span class="hl-identifier">nCacheLength</span><span class="hl-code">-</span><span class="hl-number">1</span><span class="hl-code">; </span><span class="hl-identifier">i</span><span class="hl-code"> &gt;= </span><span class="hl-number">0</span><span class="hl-code">; </span><span class="hl-identifier">i</span><span class="hl-code">--</span><span class="hl-brackets">) {
            </span><span class="hl-reserved">var </span><span class="hl-identifier">resultObj</span><span class="hl-code"> = </span><span class="hl-identifier">aCache</span><span class="hl-brackets">[</span><span class="hl-identifier">i</span><span class="hl-brackets">]</span><span class="hl-code">;
            </span><span class="hl-reserved">var </span><span class="hl-identifier">aAllResultItems</span><span class="hl-code"> = </span><span class="hl-identifier">resultObj</span><span class="hl-code">.</span><span class="hl-identifier">results</span><span class="hl-code">;
            </span><span class="hl-comment">// If case is unimportant, normalize match key for comparison
            </span><span class="hl-reserved">var </span><span class="hl-identifier">matchKey</span><span class="hl-code"> = </span><span class="hl-brackets">(</span><span class="hl-code">!</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">queryMatchCase</span><span class="hl-brackets">)</span><span class="hl-code"> ?
                </span><span class="hl-identifier">encodeURIComponent</span><span class="hl-brackets">(</span><span class="hl-identifier">resultObj</span><span class="hl-code">.</span><span class="hl-identifier">query</span><span class="hl-brackets">)</span><span class="hl-code">.</span><span class="hl-identifier">toLowerCase</span><span class="hl-brackets">()</span><span class="hl-code">:
                </span><span class="hl-identifier">encodeURIComponent</span><span class="hl-brackets">(</span><span class="hl-identifier">resultObj</span><span class="hl-code">.</span><span class="hl-identifier">query</span><span class="hl-brackets">)</span><span class="hl-code">;
            
            </span><span class="hl-comment">// If a cached match key exactly matches the query...
            </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">matchKey</span><span class="hl-code"> == </span><span class="hl-identifier">sQuery</span><span class="hl-brackets">) {
                    </span><span class="hl-comment">// Stash all result objects into aResult[] and stop looping through the cache.
                    </span><span class="hl-identifier">bMatchFound</span><span class="hl-code"> = </span><span class="hl-reserved">true</span><span class="hl-code">;
                    </span><span class="hl-identifier">aResults</span><span class="hl-code"> = </span><span class="hl-identifier">aAllResultItems</span><span class="hl-code">;
                    
                    </span><span class="hl-comment">// The matching cache element was not the most recent,
                    // so now we need to refresh the cache.
                    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">i</span><span class="hl-code"> != </span><span class="hl-identifier">nCacheLength</span><span class="hl-code">-</span><span class="hl-number">1</span><span class="hl-brackets">) {                        
                        </span><span class="hl-comment">// Remove element from its original location
                        </span><span class="hl-identifier">aCache</span><span class="hl-code">.</span><span class="hl-identifier">splice</span><span class="hl-brackets">(</span><span class="hl-identifier">i</span><span class="hl-code">,</span><span class="hl-number">1</span><span class="hl-brackets">)</span><span class="hl-code">;
                        </span><span class="hl-comment">// Add element as newest
                        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_addCacheElem</span><span class="hl-brackets">(</span><span class="hl-identifier">resultObj</span><span class="hl-brackets">)</span><span class="hl-code">;
                    </span><span class="hl-brackets">}
                    </span><span class="hl-reserved">break</span><span class="hl-code">;
            </span><span class="hl-brackets">}
            </span><span class="hl-comment">// Else if this query is not an exact match and subset matching is enabled...
            </span><span class="hl-reserved">else if</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">queryMatchSubset</span><span class="hl-brackets">) {
                </span><span class="hl-comment">// Loop through substrings of each cached element's query property...
                </span><span class="hl-reserved">for</span><span class="hl-brackets">(</span><span class="hl-reserved">var </span><span class="hl-identifier">j</span><span class="hl-code"> = </span><span class="hl-identifier">sQuery</span><span class="hl-code">.</span><span class="hl-identifier">length</span><span class="hl-code">-</span><span class="hl-number">1</span><span class="hl-code">; </span><span class="hl-identifier">j</span><span class="hl-code"> &gt;= </span><span class="hl-number">0</span><span class="hl-code"> ; </span><span class="hl-identifier">j</span><span class="hl-code">--</span><span class="hl-brackets">) {
                    </span><span class="hl-reserved">var </span><span class="hl-identifier">subQuery</span><span class="hl-code"> = </span><span class="hl-identifier">sQuery</span><span class="hl-code">.</span><span class="hl-identifier">substr</span><span class="hl-brackets">(</span><span class="hl-number">0</span><span class="hl-code">,</span><span class="hl-identifier">j</span><span class="hl-brackets">)</span><span class="hl-code">;
                    
                    </span><span class="hl-comment">// If a substring of a cached sQuery exactly matches the query...
                    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">matchKey</span><span class="hl-code"> == </span><span class="hl-identifier">subQuery</span><span class="hl-brackets">) {                    
                        </span><span class="hl-identifier">bMatchFound</span><span class="hl-code"> = </span><span class="hl-reserved">true</span><span class="hl-code">;
                        
                        </span><span class="hl-comment">// Go through each cached result object to match against the query...
                        </span><span class="hl-reserved">for</span><span class="hl-brackets">(</span><span class="hl-reserved">var </span><span class="hl-identifier">k</span><span class="hl-code"> = </span><span class="hl-identifier">aAllResultItems</span><span class="hl-code">.</span><span class="hl-identifier">length</span><span class="hl-code">-</span><span class="hl-number">1</span><span class="hl-code">; </span><span class="hl-identifier">k</span><span class="hl-code"> &gt;= </span><span class="hl-number">0</span><span class="hl-code">; </span><span class="hl-identifier">k</span><span class="hl-code">--</span><span class="hl-brackets">) {
                            </span><span class="hl-reserved">var </span><span class="hl-identifier">aRecord</span><span class="hl-code"> = </span><span class="hl-identifier">aAllResultItems</span><span class="hl-brackets">[</span><span class="hl-identifier">k</span><span class="hl-brackets">]</span><span class="hl-code">;
                            </span><span class="hl-reserved">var </span><span class="hl-identifier">sKeyIndex</span><span class="hl-code"> = </span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">queryMatchCase</span><span class="hl-brackets">)</span><span class="hl-code"> ?
                                </span><span class="hl-identifier">encodeURIComponent</span><span class="hl-brackets">(</span><span class="hl-identifier">aRecord</span><span class="hl-brackets">[</span><span class="hl-number">0</span><span class="hl-brackets">])</span><span class="hl-code">.</span><span class="hl-identifier">indexOf</span><span class="hl-brackets">(</span><span class="hl-identifier">sQuery</span><span class="hl-brackets">)</span><span class="hl-code">:
                                </span><span class="hl-identifier">encodeURIComponent</span><span class="hl-brackets">(</span><span class="hl-identifier">aRecord</span><span class="hl-brackets">[</span><span class="hl-number">0</span><span class="hl-brackets">])</span><span class="hl-code">.</span><span class="hl-identifier">toLowerCase</span><span class="hl-brackets">()</span><span class="hl-code">.</span><span class="hl-identifier">indexOf</span><span class="hl-brackets">(</span><span class="hl-identifier">sQuery</span><span class="hl-brackets">)</span><span class="hl-code">;
                            
                            </span><span class="hl-comment">// A STARTSWITH match is when the query is found at the beginning of the key string...
                            </span><span class="hl-reserved">if</span><span class="hl-brackets">((</span><span class="hl-code">!</span><span class="hl-identifier">bMatchContains</span><span class="hl-code"> &amp;&amp; </span><span class="hl-brackets">(</span><span class="hl-identifier">sKeyIndex</span><span class="hl-code"> === </span><span class="hl-number">0</span><span class="hl-brackets">))</span><span class="hl-code"> ||
                            </span><span class="hl-comment">// A CONTAINS match is when the query is found anywhere within the key string...
                            </span><span class="hl-brackets">(</span><span class="hl-identifier">bMatchContains</span><span class="hl-code"> &amp;&amp; </span><span class="hl-brackets">(</span><span class="hl-identifier">sKeyIndex</span><span class="hl-code"> &gt; -</span><span class="hl-number">1</span><span class="hl-brackets">))) {
                                </span><span class="hl-comment">// Stash a match into aResults[].
                                </span><span class="hl-identifier">aResults</span><span class="hl-code">.</span><span class="hl-identifier">unshift</span><span class="hl-brackets">(</span><span class="hl-identifier">aRecord</span><span class="hl-brackets">)</span><span class="hl-code">;
                            </span><span class="hl-brackets">}
                        }
                        
                        </span><span class="hl-comment">// Add the subset match result set object as the newest element to cache,
                        // and stop looping through the cache.
                        </span><span class="hl-identifier">resultObj</span><span class="hl-code"> = </span><span class="hl-brackets">{}</span><span class="hl-code">;
                        </span><span class="hl-identifier">resultObj</span><span class="hl-code">.</span><span class="hl-identifier">query</span><span class="hl-code"> = </span><span class="hl-identifier">sQuery</span><span class="hl-code">;
                        </span><span class="hl-identifier">resultObj</span><span class="hl-code">.</span><span class="hl-identifier">results</span><span class="hl-code"> = </span><span class="hl-identifier">aResults</span><span class="hl-code">;
                        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_addCacheElem</span><span class="hl-brackets">(</span><span class="hl-identifier">resultObj</span><span class="hl-brackets">)</span><span class="hl-code">;
                        </span><span class="hl-reserved">break</span><span class="hl-code">;
                    </span><span class="hl-brackets">}
                }
                </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">bMatchFound</span><span class="hl-brackets">) {
                    </span><span class="hl-reserved">break</span><span class="hl-code">;
                </span><span class="hl-brackets">}
            }
        }
        
        </span><span class="hl-comment">// If there was a match, send along the results.
        </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">bMatchFound</span><span class="hl-brackets">) {
            </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">getCachedResultsEvent</span><span class="hl-code">.</span><span class="hl-identifier">fire</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">, </span><span class="hl-identifier">oParent</span><span class="hl-code">, </span><span class="hl-identifier">sOrigQuery</span><span class="hl-code">, </span><span class="hl-identifier">aResults</span><span class="hl-brackets">)</span><span class="hl-code">;
            </span><span class="hl-identifier">oCallbackFn</span><span class="hl-brackets">(</span><span class="hl-identifier">sOrigQuery</span><span class="hl-code">, </span><span class="hl-identifier">aResults</span><span class="hl-code">, </span><span class="hl-identifier">oParent</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-brackets">}
    }
    </span><span class="hl-reserved">return </span><span class="hl-identifier">aResults</span><span class="hl-code">;
</span><span class="hl-brackets">}</span><span class="hl-default">;


</span><span class="hl-comment">/****************************************************************************/
// holder
/****************************************************************************/
// holder
/****************************************************************************/
// holder
/**
 * Implementation of YAHOO.widget.DataSource using XML HTTP requests that return
 * query results.
 *  
 * @class DS_XHR
 * @extends YAHOO.widget.DataSource
 * @requires connection
 * @constructor
 * @param sScriptURI {String} Absolute or relative URI to script that returns query
 * results as JSON, XML, or delimited flat-file data.
 * @param aSchema {String[]} Data schema definition of results.
 * @param oConfigs {Object} (optional) Object literal of config params.
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DS_XHR</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">(</span><span class="hl-identifier">sScriptURI</span><span class="hl-code">, </span><span class="hl-identifier">aSchema</span><span class="hl-code">, </span><span class="hl-identifier">oConfigs</span><span class="hl-brackets">) {
    </span><span class="hl-comment">// Set any config params passed in to override defaults
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-reserved">typeof </span><span class="hl-identifier">oConfigs</span><span class="hl-code"> == </span><span class="hl-quotes">&quot;</span><span class="hl-string">object</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">) {
        </span><span class="hl-reserved">for</span><span class="hl-brackets">(</span><span class="hl-reserved">var </span><span class="hl-identifier">sConfig </span><span class="hl-reserved">in </span><span class="hl-identifier">oConfigs</span><span class="hl-brackets">) {
            </span><span class="hl-reserved">this</span><span class="hl-brackets">[</span><span class="hl-identifier">sConfig</span><span class="hl-brackets">]</span><span class="hl-code"> = </span><span class="hl-identifier">oConfigs</span><span class="hl-brackets">[</span><span class="hl-identifier">sConfig</span><span class="hl-brackets">]</span><span class="hl-code">;
        </span><span class="hl-brackets">}
    }
    
    </span><span class="hl-comment">// Initialization sequence
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-code">!</span><span class="hl-identifier">aSchema</span><span class="hl-code"> || </span><span class="hl-brackets">(</span><span class="hl-identifier">aSchema</span><span class="hl-code">.</span><span class="hl-identifier">constructor</span><span class="hl-code"> != </span><span class="hl-builtin">Array</span><span class="hl-brackets">)) {
        </span><span class="hl-reserved">return</span><span class="hl-code">;
    </span><span class="hl-brackets">}
    </span><span class="hl-reserved">else </span><span class="hl-brackets">{
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">schema</span><span class="hl-code"> = </span><span class="hl-identifier">aSchema</span><span class="hl-code">;
    </span><span class="hl-brackets">}
    </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">scriptURI</span><span class="hl-code"> = </span><span class="hl-identifier">sScriptURI</span><span class="hl-code">;
    </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_init</span><span class="hl-brackets">()</span><span class="hl-code">;
</span><span class="hl-brackets">}</span><span class="hl-default">;

</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DS_XHR</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default"> = </span><span class="hl-reserved">new </span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DataSource</span><span class="hl-brackets">()</span><span class="hl-default">;

</span><span class="hl-comment">/////////////////////////////////////////////////////////////////////////////
//
// Public constants
//
/////////////////////////////////////////////////////////////////////////////

/**
 * JSON data type.
 *
 * @property TYPE_JSON
 * @type Number
 * @static
 * @final
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DS_XHR</span><span class="hl-default">.</span><span class="hl-identifier">TYPE_JSON</span><span class="hl-default"> = </span><span class="hl-number">0</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * XML data type.
 *
 * @property TYPE_XML
 * @type Number
 * @static
 * @final
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DS_XHR</span><span class="hl-default">.</span><span class="hl-identifier">TYPE_XML</span><span class="hl-default"> = </span><span class="hl-number">1</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Flat-file data type.
 *
 * @property TYPE_FLAT
 * @type Number
 * @static
 * @final
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DS_XHR</span><span class="hl-default">.</span><span class="hl-identifier">TYPE_FLAT</span><span class="hl-default"> = </span><span class="hl-number">2</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Error message for XHR failure.
 *
 * @property ERROR_DATAXHR
 * @type String
 * @static
 * @final
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DS_XHR</span><span class="hl-default">.</span><span class="hl-identifier">ERROR_DATAXHR</span><span class="hl-default"> = </span><span class="hl-quotes">&quot;</span><span class="hl-string">XHR response failed</span><span class="hl-quotes">&quot;</span><span class="hl-default">;

</span><span class="hl-comment">/////////////////////////////////////////////////////////////////////////////
//
// Public member variables
//
/////////////////////////////////////////////////////////////////////////////

/**
 * Alias to YUI Connection Manager. Allows implementers to specify their own
 * subclasses of the YUI Connection Manager utility.
 *
 * @property connMgr
 * @type Object
 * @default YAHOO.util.Connect
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DS_XHR</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">connMgr</span><span class="hl-default"> = </span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">util</span><span class="hl-default">.</span><span class="hl-identifier">Connect</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Number of milliseconds the XHR connection will wait for a server response. A
 * a value of zero indicates the XHR connection will wait forever. Any value
 * greater than zero will use the Connection utility's Auto-Abort feature.
 *
 * @property connTimeout
 * @type Number
 * @default 0
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DS_XHR</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">connTimeout</span><span class="hl-default"> = </span><span class="hl-number">0</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Absolute or relative URI to script that returns query results. For instance,
 * queries will be sent to &amp;#60;scriptURI&amp;#62;?&amp;#60;scriptQueryParam&amp;#62;=userinput
 *
 * @property scriptURI
 * @type String
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DS_XHR</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">scriptURI</span><span class="hl-default"> = </span><span class="hl-reserved">null</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Query string parameter name sent to scriptURI. For instance, queries will be
 * sent to &amp;#60;scriptURI&amp;#62;?&amp;#60;scriptQueryParam&amp;#62;=userinput
 *
 * @property scriptQueryParam
 * @type String
 * @default &quot;query&quot;
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DS_XHR</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">scriptQueryParam</span><span class="hl-default"> = </span><span class="hl-quotes">&quot;</span><span class="hl-string">query</span><span class="hl-quotes">&quot;</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * String of key/value pairs to append to requests made to scriptURI. Define
 * this string when you want to send additional query parameters to your script.
 * When defined, queries will be sent to
 * &amp;#60;scriptURI&amp;#62;?&amp;#60;scriptQueryParam&amp;#62;=userinput&amp;#38;&amp;#60;scriptQueryAppend&amp;#62;
 *
 * @property scriptQueryAppend
 * @type String
 * @default &quot;&quot;
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DS_XHR</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">scriptQueryAppend</span><span class="hl-default"> = </span><span class="hl-quotes">&quot;&quot;</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * XHR response data type. Other types that may be defined are YAHOO.widget.DS_XHR.TYPE_XML
 * and YAHOO.widget.DS_XHR.TYPE_FLAT.
 *
 * @property responseType
 * @type String
 * @default YAHOO.widget.DS_XHR.TYPE_JSON
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DS_XHR</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">responseType</span><span class="hl-default"> = </span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DS_XHR</span><span class="hl-default">.</span><span class="hl-identifier">TYPE_JSON</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * String after which to strip results. If the results from the XHR are sent
 * back as HTML, the gzip HTML comment appears at the end of the data and should
 * be ignored.
 *
 * @property responseStripAfter
 * @type String
 * @default &quot;\n&amp;#60;!-&quot;
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DS_XHR</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">responseStripAfter</span><span class="hl-default"> = </span><span class="hl-quotes">&quot;</span><span class="hl-special">\n</span><span class="hl-string">&lt;!-</span><span class="hl-quotes">&quot;</span><span class="hl-default">;

</span><span class="hl-comment">/////////////////////////////////////////////////////////////////////////////
//
// Public methods
//
/////////////////////////////////////////////////////////////////////////////

/**
 * Queries the live data source defined by scriptURI for results. Results are
 * passed back to a callback function.
 *  
 * @method doQuery
 * @param oCallbackFn {HTMLFunction} Callback function defined by oParent object to which to return results.
 * @param sQuery {String} Query string.
 * @param oParent {Object} The object instance that has requested data.
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DS_XHR</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">doQuery</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">(</span><span class="hl-identifier">oCallbackFn</span><span class="hl-code">, </span><span class="hl-identifier">sQuery</span><span class="hl-code">, </span><span class="hl-identifier">oParent</span><span class="hl-brackets">) {
    </span><span class="hl-reserved">var </span><span class="hl-identifier">isXML</span><span class="hl-code"> = </span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">responseType</span><span class="hl-code"> == </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">widget</span><span class="hl-code">.</span><span class="hl-identifier">DS_XHR</span><span class="hl-code">.</span><span class="hl-identifier">TYPE_XML</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-reserved">var </span><span class="hl-identifier">sUri</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">scriptURI</span><span class="hl-code">+</span><span class="hl-quotes">&quot;</span><span class="hl-string">?</span><span class="hl-quotes">&quot;</span><span class="hl-code">+</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">scriptQueryParam</span><span class="hl-code">+</span><span class="hl-quotes">&quot;</span><span class="hl-string">=</span><span class="hl-quotes">&quot;</span><span class="hl-code">+</span><span class="hl-identifier">sQuery</span><span class="hl-code">;
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">scriptQueryAppend</span><span class="hl-code">.</span><span class="hl-identifier">length</span><span class="hl-code"> &gt; </span><span class="hl-number">0</span><span class="hl-brackets">) {
        </span><span class="hl-identifier">sUri</span><span class="hl-code"> += </span><span class="hl-quotes">&quot;</span><span class="hl-string">&amp;</span><span class="hl-quotes">&quot;</span><span class="hl-code"> + </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">scriptQueryAppend</span><span class="hl-code">;
    </span><span class="hl-brackets">}
    </span><span class="hl-reserved">var </span><span class="hl-identifier">oResponse</span><span class="hl-code"> = </span><span class="hl-reserved">null</span><span class="hl-code">;
    
    </span><span class="hl-reserved">var </span><span class="hl-identifier">oSelf</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">;
    </span><span class="hl-comment">/*
     * Sets up ajax request callback
     *
     * @param {object} oReq          HTTPXMLRequest object
     * @private
     */
    </span><span class="hl-reserved">var </span><span class="hl-identifier">responseSuccess</span><span class="hl-code"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">(</span><span class="hl-identifier">oResp</span><span class="hl-brackets">) {
        </span><span class="hl-comment">// Response ID does not match last made request ID.
        </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-code">!</span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_oConn</span><span class="hl-code"> || </span><span class="hl-brackets">(</span><span class="hl-identifier">oResp</span><span class="hl-code">.</span><span class="hl-identifier">tId</span><span class="hl-code"> != </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_oConn</span><span class="hl-code">.</span><span class="hl-identifier">tId</span><span class="hl-brackets">)) {
            </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">dataErrorEvent</span><span class="hl-code">.</span><span class="hl-identifier">fire</span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-code">, </span><span class="hl-identifier">oParent</span><span class="hl-code">, </span><span class="hl-identifier">sQuery</span><span class="hl-code">, </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">widget</span><span class="hl-code">.</span><span class="hl-identifier">DataSource</span><span class="hl-code">.</span><span class="hl-identifier">ERROR_DATANULL</span><span class="hl-brackets">)</span><span class="hl-code">;
            </span><span class="hl-reserved">return</span><span class="hl-code">;
        </span><span class="hl-brackets">}
</span><span class="hl-comment">//DEBUG
</span><span class="hl-reserved">for</span><span class="hl-brackets">(</span><span class="hl-reserved">var </span><span class="hl-identifier">foo </span><span class="hl-reserved">in </span><span class="hl-identifier">oResp</span><span class="hl-brackets">) {
}
        </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-code">!</span><span class="hl-identifier">isXML</span><span class="hl-brackets">) {
            </span><span class="hl-identifier">oResp</span><span class="hl-code"> = </span><span class="hl-identifier">oResp</span><span class="hl-code">.</span><span class="hl-identifier">responseText</span><span class="hl-code">;
        </span><span class="hl-brackets">}
        </span><span class="hl-reserved">else </span><span class="hl-brackets">{ 
            </span><span class="hl-identifier">oResp</span><span class="hl-code"> = </span><span class="hl-identifier">oResp</span><span class="hl-code">.</span><span class="hl-identifier">responseXML</span><span class="hl-code">;
        </span><span class="hl-brackets">}
        </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">oResp</span><span class="hl-code"> === </span><span class="hl-reserved">null</span><span class="hl-brackets">) {
            </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">dataErrorEvent</span><span class="hl-code">.</span><span class="hl-identifier">fire</span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-code">, </span><span class="hl-identifier">oParent</span><span class="hl-code">, </span><span class="hl-identifier">sQuery</span><span class="hl-code">, </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">widget</span><span class="hl-code">.</span><span class="hl-identifier">DataSource</span><span class="hl-code">.</span><span class="hl-identifier">ERROR_DATANULL</span><span class="hl-brackets">)</span><span class="hl-code">;
            </span><span class="hl-reserved">return</span><span class="hl-code">;
        </span><span class="hl-brackets">}

        </span><span class="hl-reserved">var </span><span class="hl-identifier">aResults</span><span class="hl-code"> = </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">parseResponse</span><span class="hl-brackets">(</span><span class="hl-identifier">sQuery</span><span class="hl-code">, </span><span class="hl-identifier">oResp</span><span class="hl-code">, </span><span class="hl-identifier">oParent</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-reserved">var </span><span class="hl-identifier">resultObj</span><span class="hl-code"> = </span><span class="hl-brackets">{}</span><span class="hl-code">;
        </span><span class="hl-identifier">resultObj</span><span class="hl-code">.</span><span class="hl-identifier">query</span><span class="hl-code"> = </span><span class="hl-identifier">decodeURIComponent</span><span class="hl-brackets">(</span><span class="hl-identifier">sQuery</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-identifier">resultObj</span><span class="hl-code">.</span><span class="hl-identifier">results</span><span class="hl-code"> = </span><span class="hl-identifier">aResults</span><span class="hl-code">;
        </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">aResults</span><span class="hl-code"> === </span><span class="hl-reserved">null</span><span class="hl-brackets">) {
            </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">dataErrorEvent</span><span class="hl-code">.</span><span class="hl-identifier">fire</span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-code">, </span><span class="hl-identifier">oParent</span><span class="hl-code">, </span><span class="hl-identifier">sQuery</span><span class="hl-code">, </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">widget</span><span class="hl-code">.</span><span class="hl-identifier">DataSource</span><span class="hl-code">.</span><span class="hl-identifier">ERROR_DATAPARSE</span><span class="hl-brackets">)</span><span class="hl-code">;
            </span><span class="hl-identifier">aResults</span><span class="hl-code"> = </span><span class="hl-brackets">[]</span><span class="hl-code">;
        </span><span class="hl-brackets">}
        </span><span class="hl-reserved">else </span><span class="hl-brackets">{
            </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">getResultsEvent</span><span class="hl-code">.</span><span class="hl-identifier">fire</span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-code">, </span><span class="hl-identifier">oParent</span><span class="hl-code">, </span><span class="hl-identifier">sQuery</span><span class="hl-code">, </span><span class="hl-identifier">aResults</span><span class="hl-brackets">)</span><span class="hl-code">;
            </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_addCacheElem</span><span class="hl-brackets">(</span><span class="hl-identifier">resultObj</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-brackets">}
        </span><span class="hl-identifier">oCallbackFn</span><span class="hl-brackets">(</span><span class="hl-identifier">sQuery</span><span class="hl-code">, </span><span class="hl-identifier">aResults</span><span class="hl-code">, </span><span class="hl-identifier">oParent</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-brackets">}</span><span class="hl-code">;

    </span><span class="hl-reserved">var </span><span class="hl-identifier">responseFailure</span><span class="hl-code"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">(</span><span class="hl-identifier">oResp</span><span class="hl-brackets">) {
        </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">dataErrorEvent</span><span class="hl-code">.</span><span class="hl-identifier">fire</span><span class="hl-brackets">(</span><span class="hl-identifier">oSelf</span><span class="hl-code">, </span><span class="hl-identifier">oParent</span><span class="hl-code">, </span><span class="hl-identifier">sQuery</span><span class="hl-code">, </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">widget</span><span class="hl-code">.</span><span class="hl-identifier">DS_XHR</span><span class="hl-code">.</span><span class="hl-identifier">ERROR_DATAXHR</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-reserved">return</span><span class="hl-code">;
    </span><span class="hl-brackets">}</span><span class="hl-code">;
    
    </span><span class="hl-reserved">var </span><span class="hl-identifier">oCallback</span><span class="hl-code"> = </span><span class="hl-brackets">{
        </span><span class="hl-identifier">success</span><span class="hl-code">:</span><span class="hl-identifier">responseSuccess</span><span class="hl-code">,
        </span><span class="hl-identifier">failure</span><span class="hl-code">:</span><span class="hl-identifier">responseFailure
    </span><span class="hl-brackets">}</span><span class="hl-code">;
    
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-code">!</span><span class="hl-identifier">isNaN</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">connTimeout</span><span class="hl-brackets">)</span><span class="hl-code"> &amp;&amp; </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">connTimeout</span><span class="hl-code"> &gt; </span><span class="hl-number">0</span><span class="hl-brackets">) {
        </span><span class="hl-identifier">oCallback</span><span class="hl-code">.</span><span class="hl-identifier">timeout</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">connTimeout</span><span class="hl-code">;
    </span><span class="hl-brackets">}
    
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oConn</span><span class="hl-brackets">) {
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">connMgr</span><span class="hl-code">.</span><span class="hl-identifier">abort</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_oConn</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-brackets">}
    
    </span><span class="hl-identifier">oSelf</span><span class="hl-code">.</span><span class="hl-identifier">_oConn</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">connMgr</span><span class="hl-code">.</span><span class="hl-identifier">asyncRequest</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">GET</span><span class="hl-quotes">&quot;</span><span class="hl-code">, </span><span class="hl-identifier">sUri</span><span class="hl-code">, </span><span class="hl-identifier">oCallback</span><span class="hl-code">, </span><span class="hl-reserved">null</span><span class="hl-brackets">)</span><span class="hl-code">;
</span><span class="hl-brackets">}</span><span class="hl-default">;

</span><span class="hl-comment">/**
 * Parses raw response data into an array of result objects. The result data key
 * is always stashed in the [0] element of each result object. 
 *
 * @method parseResponse
 * @param sQuery {String} Query string.
 * @param oResponse {Object} The raw response data to parse.
 * @param oParent {Object} The object instance that has requested data.
 * @returns {Object[]} Array of result objects.
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DS_XHR</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">parseResponse</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">(</span><span class="hl-identifier">sQuery</span><span class="hl-code">, </span><span class="hl-identifier">oResponse</span><span class="hl-code">, </span><span class="hl-identifier">oParent</span><span class="hl-brackets">) {
    </span><span class="hl-reserved">var </span><span class="hl-identifier">aSchema</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">schema</span><span class="hl-code">;
    </span><span class="hl-reserved">var </span><span class="hl-identifier">aResults</span><span class="hl-code"> = </span><span class="hl-brackets">[]</span><span class="hl-code">;
    </span><span class="hl-reserved">var </span><span class="hl-identifier">bError</span><span class="hl-code"> = </span><span class="hl-reserved">false</span><span class="hl-code">;

    </span><span class="hl-comment">// Strip out comment at the end of results
    </span><span class="hl-reserved">var </span><span class="hl-identifier">nEnd</span><span class="hl-code"> = </span><span class="hl-brackets">((</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">responseStripAfter</span><span class="hl-code"> !== </span><span class="hl-quotes">&quot;&quot;</span><span class="hl-brackets">)</span><span class="hl-code"> &amp;&amp; </span><span class="hl-brackets">(</span><span class="hl-identifier">oResponse</span><span class="hl-code">.</span><span class="hl-identifier">indexOf</span><span class="hl-brackets">))</span><span class="hl-code"> ?
        </span><span class="hl-identifier">oResponse</span><span class="hl-code">.</span><span class="hl-identifier">indexOf</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">responseStripAfter</span><span class="hl-brackets">)</span><span class="hl-code"> : -</span><span class="hl-number">1</span><span class="hl-code">;
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">nEnd</span><span class="hl-code"> != -</span><span class="hl-number">1</span><span class="hl-brackets">) {
        </span><span class="hl-identifier">oResponse</span><span class="hl-code"> = </span><span class="hl-identifier">oResponse</span><span class="hl-code">.</span><span class="hl-identifier">substring</span><span class="hl-brackets">(</span><span class="hl-number">0</span><span class="hl-code">,</span><span class="hl-identifier">nEnd</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-brackets">}

    </span><span class="hl-reserved">switch </span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">responseType</span><span class="hl-brackets">) {
        </span><span class="hl-reserved">case </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">widget</span><span class="hl-code">.</span><span class="hl-identifier">DS_XHR</span><span class="hl-code">.</span><span class="hl-identifier">TYPE_JSON</span><span class="hl-code">:
            </span><span class="hl-reserved">var </span><span class="hl-identifier">jsonList</span><span class="hl-code">;
            </span><span class="hl-comment">// Divert KHTML clients from JSON lib
            </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-builtin">window</span><span class="hl-code">.</span><span class="hl-identifier">JSON</span><span class="hl-code"> &amp;&amp; </span><span class="hl-brackets">(</span><span class="hl-builtin">navigator</span><span class="hl-code">.</span><span class="hl-identifier">userAgent</span><span class="hl-code">.</span><span class="hl-identifier">toLowerCase</span><span class="hl-brackets">()</span><span class="hl-code">.</span><span class="hl-identifier">indexOf</span><span class="hl-brackets">(</span><span class="hl-quotes">'</span><span class="hl-string">khtml</span><span class="hl-quotes">'</span><span class="hl-brackets">)</span><span class="hl-code">== -</span><span class="hl-number">1</span><span class="hl-brackets">)) {
                </span><span class="hl-comment">// Use the JSON utility if available
                </span><span class="hl-reserved">var </span><span class="hl-identifier">jsonObjParsed</span><span class="hl-code"> = </span><span class="hl-identifier">JSON</span><span class="hl-code">.</span><span class="hl-identifier">parse</span><span class="hl-brackets">(</span><span class="hl-identifier">oResponse</span><span class="hl-brackets">)</span><span class="hl-code">;
                </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-code">!</span><span class="hl-identifier">jsonObjParsed</span><span class="hl-brackets">) {
                    </span><span class="hl-identifier">bError</span><span class="hl-code"> = </span><span class="hl-reserved">true</span><span class="hl-code">;
                    </span><span class="hl-reserved">break</span><span class="hl-code">;
                </span><span class="hl-brackets">}
                </span><span class="hl-reserved">else </span><span class="hl-brackets">{
                    </span><span class="hl-reserved">try </span><span class="hl-brackets">{
                        </span><span class="hl-comment">// eval is necessary here since aSchema[0] is of unknown depth
                        </span><span class="hl-identifier">jsonList</span><span class="hl-code"> = </span><span class="hl-identifier">eval</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">jsonObjParsed.</span><span class="hl-quotes">&quot;</span><span class="hl-code"> + </span><span class="hl-identifier">aSchema</span><span class="hl-brackets">[</span><span class="hl-number">0</span><span class="hl-brackets">])</span><span class="hl-code">;
                    </span><span class="hl-brackets">}
                    </span><span class="hl-reserved">catch</span><span class="hl-brackets">(</span><span class="hl-identifier">e</span><span class="hl-brackets">) {
                        </span><span class="hl-identifier">bError</span><span class="hl-code"> = </span><span class="hl-reserved">true</span><span class="hl-code">;
                        </span><span class="hl-reserved">break</span><span class="hl-code">;
                   </span><span class="hl-brackets">}
                }
            }
            </span><span class="hl-reserved">else </span><span class="hl-brackets">{
                </span><span class="hl-comment">// Parse the JSON response as a string
                </span><span class="hl-reserved">try </span><span class="hl-brackets">{
                    </span><span class="hl-comment">// Trim leading spaces
                    </span><span class="hl-reserved">while </span><span class="hl-brackets">(</span><span class="hl-identifier">oResponse</span><span class="hl-code">.</span><span class="hl-identifier">substring</span><span class="hl-brackets">(</span><span class="hl-number">0</span><span class="hl-code">,</span><span class="hl-number">1</span><span class="hl-brackets">)</span><span class="hl-code"> == </span><span class="hl-quotes">&quot; &quot;</span><span class="hl-brackets">) {
                        </span><span class="hl-identifier">oResponse</span><span class="hl-code"> = </span><span class="hl-identifier">oResponse</span><span class="hl-code">.</span><span class="hl-identifier">substring</span><span class="hl-brackets">(</span><span class="hl-number">1</span><span class="hl-code">, </span><span class="hl-identifier">oResponse</span><span class="hl-code">.</span><span class="hl-identifier">length</span><span class="hl-brackets">)</span><span class="hl-code">;
                    </span><span class="hl-brackets">}

                    </span><span class="hl-comment">// Invalid JSON response
                    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">oResponse</span><span class="hl-code">.</span><span class="hl-identifier">indexOf</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">{</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">)</span><span class="hl-code"> &lt; </span><span class="hl-number">0</span><span class="hl-brackets">) {
                        </span><span class="hl-identifier">bError</span><span class="hl-code"> = </span><span class="hl-reserved">true</span><span class="hl-code">;
                        </span><span class="hl-reserved">break</span><span class="hl-code">;
                    </span><span class="hl-brackets">}

                    </span><span class="hl-comment">// Empty (but not invalid) JSON response
                    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">oResponse</span><span class="hl-code">.</span><span class="hl-identifier">indexOf</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">{}</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">)</span><span class="hl-code"> === </span><span class="hl-number">0</span><span class="hl-brackets">) {
                        </span><span class="hl-reserved">break</span><span class="hl-code">;
                    </span><span class="hl-brackets">}

                    </span><span class="hl-comment">// Turn the string into an object literal...
                    // ...eval is necessary here
                    </span><span class="hl-reserved">var </span><span class="hl-identifier">jsonObjRaw</span><span class="hl-code"> = </span><span class="hl-identifier">eval</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">(</span><span class="hl-quotes">&quot;</span><span class="hl-code"> + </span><span class="hl-identifier">oResponse</span><span class="hl-code"> + </span><span class="hl-quotes">&quot;</span><span class="hl-string">)</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">)</span><span class="hl-code">;
                    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-code">!</span><span class="hl-identifier">jsonObjRaw</span><span class="hl-brackets">) {
                        </span><span class="hl-identifier">bError</span><span class="hl-code"> = </span><span class="hl-reserved">true</span><span class="hl-code">;
                        </span><span class="hl-reserved">break</span><span class="hl-code">;
                    </span><span class="hl-brackets">}

                    </span><span class="hl-comment">// Grab the object member that contains an array of all reponses...
                    // ...eval is necessary here since aSchema[0] is of unknown depth
                    </span><span class="hl-identifier">jsonList</span><span class="hl-code"> = </span><span class="hl-identifier">eval</span><span class="hl-brackets">(</span><span class="hl-quotes">&quot;</span><span class="hl-string">(jsonObjRaw.</span><span class="hl-quotes">&quot;</span><span class="hl-code"> + </span><span class="hl-identifier">aSchema</span><span class="hl-brackets">[</span><span class="hl-number">0</span><span class="hl-brackets">]</span><span class="hl-code">+</span><span class="hl-quotes">&quot;</span><span class="hl-string">)</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">)</span><span class="hl-code">;
                </span><span class="hl-brackets">}
                </span><span class="hl-reserved">catch</span><span class="hl-brackets">(</span><span class="hl-identifier">e</span><span class="hl-brackets">) {
                    </span><span class="hl-identifier">bError</span><span class="hl-code"> = </span><span class="hl-reserved">true</span><span class="hl-code">;
                    </span><span class="hl-reserved">break</span><span class="hl-code">;
               </span><span class="hl-brackets">}
            }

            </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-code">!</span><span class="hl-identifier">jsonList</span><span class="hl-brackets">) {
                </span><span class="hl-identifier">bError</span><span class="hl-code"> = </span><span class="hl-reserved">true</span><span class="hl-code">;
                </span><span class="hl-reserved">break</span><span class="hl-code">;
            </span><span class="hl-brackets">}

            </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">jsonList</span><span class="hl-code">.</span><span class="hl-identifier">constructor</span><span class="hl-code"> != </span><span class="hl-builtin">Array</span><span class="hl-brackets">) {
                </span><span class="hl-identifier">jsonList</span><span class="hl-code"> = </span><span class="hl-brackets">[</span><span class="hl-identifier">jsonList</span><span class="hl-brackets">]</span><span class="hl-code">;
            </span><span class="hl-brackets">}
            
            </span><span class="hl-comment">// Loop through the array of all responses...
            </span><span class="hl-reserved">for</span><span class="hl-brackets">(</span><span class="hl-reserved">var </span><span class="hl-identifier">i</span><span class="hl-code"> = </span><span class="hl-identifier">jsonList</span><span class="hl-code">.</span><span class="hl-identifier">length</span><span class="hl-code">-</span><span class="hl-number">1</span><span class="hl-code">; </span><span class="hl-identifier">i</span><span class="hl-code"> &gt;= </span><span class="hl-number">0</span><span class="hl-code"> ; </span><span class="hl-identifier">i</span><span class="hl-code">--</span><span class="hl-brackets">) {
                </span><span class="hl-reserved">var </span><span class="hl-identifier">aResultItem</span><span class="hl-code"> = </span><span class="hl-brackets">[]</span><span class="hl-code">;
                </span><span class="hl-reserved">var </span><span class="hl-identifier">jsonResult</span><span class="hl-code"> = </span><span class="hl-identifier">jsonList</span><span class="hl-brackets">[</span><span class="hl-identifier">i</span><span class="hl-brackets">]</span><span class="hl-code">;
                </span><span class="hl-comment">// ...and loop through each data field value of each response
                </span><span class="hl-reserved">for</span><span class="hl-brackets">(</span><span class="hl-reserved">var </span><span class="hl-identifier">j</span><span class="hl-code"> = </span><span class="hl-identifier">aSchema</span><span class="hl-code">.</span><span class="hl-identifier">length</span><span class="hl-code">-</span><span class="hl-number">1</span><span class="hl-code">; </span><span class="hl-identifier">j</span><span class="hl-code"> &gt;= </span><span class="hl-number">1</span><span class="hl-code"> ; </span><span class="hl-identifier">j</span><span class="hl-code">--</span><span class="hl-brackets">) {
                    </span><span class="hl-comment">// ...and capture data into an array mapped according to the schema...
                    </span><span class="hl-reserved">var </span><span class="hl-identifier">dataFieldValue</span><span class="hl-code"> = </span><span class="hl-identifier">jsonResult</span><span class="hl-brackets">[</span><span class="hl-identifier">aSchema</span><span class="hl-brackets">[</span><span class="hl-identifier">j</span><span class="hl-brackets">]]</span><span class="hl-code">;
                    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-code">!</span><span class="hl-identifier">dataFieldValue</span><span class="hl-brackets">) {
                        </span><span class="hl-identifier">dataFieldValue</span><span class="hl-code"> = </span><span class="hl-quotes">&quot;&quot;</span><span class="hl-code">;
                    </span><span class="hl-brackets">}
                    </span><span class="hl-identifier">aResultItem</span><span class="hl-code">.</span><span class="hl-identifier">unshift</span><span class="hl-brackets">(</span><span class="hl-identifier">dataFieldValue</span><span class="hl-brackets">)</span><span class="hl-code">;
                </span><span class="hl-brackets">}
                </span><span class="hl-comment">// If schema isn't well defined, pass along the entire result object
                </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">aResultItem</span><span class="hl-code">.</span><span class="hl-identifier">length</span><span class="hl-code"> == </span><span class="hl-number">1</span><span class="hl-brackets">) {
                    </span><span class="hl-identifier">aResultItem</span><span class="hl-code">.</span><span class="hl-identifier">push</span><span class="hl-brackets">(</span><span class="hl-identifier">jsonResult</span><span class="hl-brackets">)</span><span class="hl-code">;
                </span><span class="hl-brackets">}
                </span><span class="hl-comment">// Capture the array of data field values in an array of results
                </span><span class="hl-identifier">aResults</span><span class="hl-code">.</span><span class="hl-identifier">unshift</span><span class="hl-brackets">(</span><span class="hl-identifier">aResultItem</span><span class="hl-brackets">)</span><span class="hl-code">;
            </span><span class="hl-brackets">}
            </span><span class="hl-reserved">break</span><span class="hl-code">;
        </span><span class="hl-reserved">case </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">widget</span><span class="hl-code">.</span><span class="hl-identifier">DS_XHR</span><span class="hl-code">.</span><span class="hl-identifier">TYPE_XML</span><span class="hl-code">:
            </span><span class="hl-comment">// Get the collection of results
            </span><span class="hl-reserved">var </span><span class="hl-identifier">xmlList</span><span class="hl-code"> = </span><span class="hl-identifier">oResponse</span><span class="hl-code">.</span><span class="hl-identifier">getElementsByTagName</span><span class="hl-brackets">(</span><span class="hl-identifier">aSchema</span><span class="hl-brackets">[</span><span class="hl-number">0</span><span class="hl-brackets">])</span><span class="hl-code">;
            </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-code">!</span><span class="hl-identifier">xmlList</span><span class="hl-brackets">) {
                </span><span class="hl-identifier">bError</span><span class="hl-code"> = </span><span class="hl-reserved">true</span><span class="hl-code">;
                </span><span class="hl-reserved">break</span><span class="hl-code">;
            </span><span class="hl-brackets">}
            </span><span class="hl-comment">// Loop through each result
            </span><span class="hl-reserved">for</span><span class="hl-brackets">(</span><span class="hl-reserved">var </span><span class="hl-identifier">k</span><span class="hl-code"> = </span><span class="hl-identifier">xmlList</span><span class="hl-code">.</span><span class="hl-identifier">length</span><span class="hl-code">-</span><span class="hl-number">1</span><span class="hl-code">; </span><span class="hl-identifier">k</span><span class="hl-code"> &gt;= </span><span class="hl-number">0</span><span class="hl-code"> ; </span><span class="hl-identifier">k</span><span class="hl-code">--</span><span class="hl-brackets">) {
                </span><span class="hl-reserved">var </span><span class="hl-identifier">result</span><span class="hl-code"> = </span><span class="hl-identifier">xmlList</span><span class="hl-code">.</span><span class="hl-identifier">item</span><span class="hl-brackets">(</span><span class="hl-identifier">k</span><span class="hl-brackets">)</span><span class="hl-code">;
                </span><span class="hl-reserved">var </span><span class="hl-identifier">aFieldSet</span><span class="hl-code"> = </span><span class="hl-brackets">[]</span><span class="hl-code">;
                </span><span class="hl-comment">// Loop through each data field in each result using the schema
                </span><span class="hl-reserved">for</span><span class="hl-brackets">(</span><span class="hl-reserved">var </span><span class="hl-identifier">m</span><span class="hl-code"> = </span><span class="hl-identifier">aSchema</span><span class="hl-code">.</span><span class="hl-identifier">length</span><span class="hl-code">-</span><span class="hl-number">1</span><span class="hl-code">; </span><span class="hl-identifier">m</span><span class="hl-code"> &gt;= </span><span class="hl-number">1</span><span class="hl-code"> ; </span><span class="hl-identifier">m</span><span class="hl-code">--</span><span class="hl-brackets">) {
                    </span><span class="hl-reserved">var </span><span class="hl-identifier">sValue</span><span class="hl-code"> = </span><span class="hl-reserved">null</span><span class="hl-code">;
                    </span><span class="hl-comment">// Values may be held in an attribute...
                    </span><span class="hl-reserved">var </span><span class="hl-identifier">xmlAttr</span><span class="hl-code"> = </span><span class="hl-identifier">result</span><span class="hl-code">.</span><span class="hl-identifier">attributes</span><span class="hl-code">.</span><span class="hl-identifier">getNamedItem</span><span class="hl-brackets">(</span><span class="hl-identifier">aSchema</span><span class="hl-brackets">[</span><span class="hl-identifier">m</span><span class="hl-brackets">])</span><span class="hl-code">;
                    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">xmlAttr</span><span class="hl-brackets">) {
                        </span><span class="hl-identifier">sValue</span><span class="hl-code"> = </span><span class="hl-identifier">xmlAttr</span><span class="hl-code">.</span><span class="hl-identifier">value</span><span class="hl-code">;
                    </span><span class="hl-brackets">}
                    </span><span class="hl-comment">// ...or in a node
                    </span><span class="hl-reserved">else</span><span class="hl-brackets">{
                        </span><span class="hl-reserved">var </span><span class="hl-identifier">xmlNode</span><span class="hl-code"> = </span><span class="hl-identifier">result</span><span class="hl-code">.</span><span class="hl-identifier">getElementsByTagName</span><span class="hl-brackets">(</span><span class="hl-identifier">aSchema</span><span class="hl-brackets">[</span><span class="hl-identifier">m</span><span class="hl-brackets">])</span><span class="hl-code">;
                        </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">xmlNode</span><span class="hl-code"> &amp;&amp; </span><span class="hl-identifier">xmlNode</span><span class="hl-code">.</span><span class="hl-identifier">item</span><span class="hl-brackets">(</span><span class="hl-number">0</span><span class="hl-brackets">)</span><span class="hl-code"> &amp;&amp; </span><span class="hl-identifier">xmlNode</span><span class="hl-code">.</span><span class="hl-identifier">item</span><span class="hl-brackets">(</span><span class="hl-number">0</span><span class="hl-brackets">)</span><span class="hl-code">.</span><span class="hl-identifier">firstChild</span><span class="hl-brackets">) {
                            </span><span class="hl-identifier">sValue</span><span class="hl-code"> = </span><span class="hl-identifier">xmlNode</span><span class="hl-code">.</span><span class="hl-identifier">item</span><span class="hl-brackets">(</span><span class="hl-number">0</span><span class="hl-brackets">)</span><span class="hl-code">.</span><span class="hl-identifier">firstChild</span><span class="hl-code">.</span><span class="hl-identifier">nodeValue</span><span class="hl-code">;
                        </span><span class="hl-brackets">}
                        </span><span class="hl-reserved">else </span><span class="hl-brackets">{
                            </span><span class="hl-identifier">sValue</span><span class="hl-code"> = </span><span class="hl-quotes">&quot;&quot;</span><span class="hl-code">;
                        </span><span class="hl-brackets">}
                    }
                    </span><span class="hl-comment">// Capture the schema-mapped data field values into an array
                    </span><span class="hl-identifier">aFieldSet</span><span class="hl-code">.</span><span class="hl-identifier">unshift</span><span class="hl-brackets">(</span><span class="hl-identifier">sValue</span><span class="hl-brackets">)</span><span class="hl-code">;
                </span><span class="hl-brackets">}
                </span><span class="hl-comment">// Capture each array of values into an array of results
                </span><span class="hl-identifier">aResults</span><span class="hl-code">.</span><span class="hl-identifier">unshift</span><span class="hl-brackets">(</span><span class="hl-identifier">aFieldSet</span><span class="hl-brackets">)</span><span class="hl-code">;
            </span><span class="hl-brackets">}
            </span><span class="hl-reserved">break</span><span class="hl-code">;
        </span><span class="hl-reserved">case </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">widget</span><span class="hl-code">.</span><span class="hl-identifier">DS_XHR</span><span class="hl-code">.</span><span class="hl-identifier">TYPE_FLAT</span><span class="hl-code">:
            </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">oResponse</span><span class="hl-code">.</span><span class="hl-identifier">length</span><span class="hl-code"> &gt; </span><span class="hl-number">0</span><span class="hl-brackets">) {
                </span><span class="hl-comment">// Delete the last line delimiter at the end of the data if it exists
                </span><span class="hl-reserved">var </span><span class="hl-identifier">newLength</span><span class="hl-code"> = </span><span class="hl-identifier">oResponse</span><span class="hl-code">.</span><span class="hl-identifier">length</span><span class="hl-code">-</span><span class="hl-identifier">aSchema</span><span class="hl-brackets">[</span><span class="hl-number">0</span><span class="hl-brackets">]</span><span class="hl-code">.</span><span class="hl-identifier">length</span><span class="hl-code">;
                </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">oResponse</span><span class="hl-code">.</span><span class="hl-identifier">substr</span><span class="hl-brackets">(</span><span class="hl-identifier">newLength</span><span class="hl-brackets">)</span><span class="hl-code"> == </span><span class="hl-identifier">aSchema</span><span class="hl-brackets">[</span><span class="hl-number">0</span><span class="hl-brackets">]) {
                    </span><span class="hl-identifier">oResponse</span><span class="hl-code"> = </span><span class="hl-identifier">oResponse</span><span class="hl-code">.</span><span class="hl-identifier">substr</span><span class="hl-brackets">(</span><span class="hl-number">0</span><span class="hl-code">, </span><span class="hl-identifier">newLength</span><span class="hl-brackets">)</span><span class="hl-code">;
                </span><span class="hl-brackets">}
                </span><span class="hl-reserved">var </span><span class="hl-identifier">aRecords</span><span class="hl-code"> = </span><span class="hl-identifier">oResponse</span><span class="hl-code">.</span><span class="hl-identifier">split</span><span class="hl-brackets">(</span><span class="hl-identifier">aSchema</span><span class="hl-brackets">[</span><span class="hl-number">0</span><span class="hl-brackets">])</span><span class="hl-code">;
                </span><span class="hl-reserved">for</span><span class="hl-brackets">(</span><span class="hl-reserved">var </span><span class="hl-identifier">n</span><span class="hl-code"> = </span><span class="hl-identifier">aRecords</span><span class="hl-code">.</span><span class="hl-identifier">length</span><span class="hl-code">-</span><span class="hl-number">1</span><span class="hl-code">; </span><span class="hl-identifier">n</span><span class="hl-code"> &gt;= </span><span class="hl-number">0</span><span class="hl-code">; </span><span class="hl-identifier">n</span><span class="hl-code">--</span><span class="hl-brackets">) {
                    </span><span class="hl-identifier">aResults</span><span class="hl-brackets">[</span><span class="hl-identifier">n</span><span class="hl-brackets">]</span><span class="hl-code"> = </span><span class="hl-identifier">aRecords</span><span class="hl-brackets">[</span><span class="hl-identifier">n</span><span class="hl-brackets">]</span><span class="hl-code">.</span><span class="hl-identifier">split</span><span class="hl-brackets">(</span><span class="hl-identifier">aSchema</span><span class="hl-brackets">[</span><span class="hl-number">1</span><span class="hl-brackets">])</span><span class="hl-code">;
                </span><span class="hl-brackets">}
            }
            </span><span class="hl-reserved">break</span><span class="hl-code">;
        </span><span class="hl-reserved">default</span><span class="hl-code">:
            </span><span class="hl-reserved">break</span><span class="hl-code">;
    </span><span class="hl-brackets">}
    </span><span class="hl-identifier">sQuery</span><span class="hl-code"> = </span><span class="hl-reserved">null</span><span class="hl-code">;
    </span><span class="hl-identifier">oResponse</span><span class="hl-code"> = </span><span class="hl-reserved">null</span><span class="hl-code">;
    </span><span class="hl-identifier">oParent</span><span class="hl-code"> = </span><span class="hl-reserved">null</span><span class="hl-code">;
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">bError</span><span class="hl-brackets">) {
        </span><span class="hl-reserved">return null</span><span class="hl-code">;
    </span><span class="hl-brackets">}
    </span><span class="hl-reserved">else </span><span class="hl-brackets">{
        </span><span class="hl-reserved">return </span><span class="hl-identifier">aResults</span><span class="hl-code">;
    </span><span class="hl-brackets">}
}</span><span class="hl-default">;            

</span><span class="hl-comment">/////////////////////////////////////////////////////////////////////////////
//
// Private member variables
//
/////////////////////////////////////////////////////////////////////////////

/**
 * XHR connection object.
 *
 * @property _oConn
 * @type Object
 * @private
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DS_XHR</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">_oConn</span><span class="hl-default"> = </span><span class="hl-reserved">null</span><span class="hl-default">;


</span><span class="hl-comment">/****************************************************************************/
// holder
/****************************************************************************/
// holder
/****************************************************************************/
// holder
/**
 * Implementation of YAHOO.widget.DataSource using a native Javascript function as
 * its live data source.
 *  
 * @class DS_JSFunction
 * @constructor
 * @extends YAHOO.widget.DataSource
 * @param oFunction {String} In-memory Javascript function that returns query results as an array of objects.
 * @param oConfigs {Object} (optional) Object literal of config params.
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DS_JSFunction</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">(</span><span class="hl-identifier">oFunction</span><span class="hl-code">, </span><span class="hl-identifier">oConfigs</span><span class="hl-brackets">) {
    </span><span class="hl-comment">// Set any config params passed in to override defaults
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-reserved">typeof </span><span class="hl-identifier">oConfigs</span><span class="hl-code"> == </span><span class="hl-quotes">&quot;</span><span class="hl-string">object</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">) {
        </span><span class="hl-reserved">for</span><span class="hl-brackets">(</span><span class="hl-reserved">var </span><span class="hl-identifier">sConfig </span><span class="hl-reserved">in </span><span class="hl-identifier">oConfigs</span><span class="hl-brackets">) {
            </span><span class="hl-reserved">this</span><span class="hl-brackets">[</span><span class="hl-identifier">sConfig</span><span class="hl-brackets">]</span><span class="hl-code"> = </span><span class="hl-identifier">oConfigs</span><span class="hl-brackets">[</span><span class="hl-identifier">sConfig</span><span class="hl-brackets">]</span><span class="hl-code">;
        </span><span class="hl-brackets">}
    }

    </span><span class="hl-comment">// Initialization sequence
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-code">!</span><span class="hl-identifier">oFunction</span><span class="hl-code">  || </span><span class="hl-brackets">(</span><span class="hl-identifier">oFunction</span><span class="hl-code">.</span><span class="hl-identifier">constructor</span><span class="hl-code"> != </span><span class="hl-builtin">Function</span><span class="hl-brackets">)) {
        </span><span class="hl-reserved">return</span><span class="hl-code">;
    </span><span class="hl-brackets">}
    </span><span class="hl-reserved">else </span><span class="hl-brackets">{
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">dataFunction</span><span class="hl-code"> = </span><span class="hl-identifier">oFunction</span><span class="hl-code">;
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_init</span><span class="hl-brackets">()</span><span class="hl-code">;
    </span><span class="hl-brackets">}
}</span><span class="hl-default">;

</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DS_JSFunction</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default"> = </span><span class="hl-reserved">new </span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DataSource</span><span class="hl-brackets">()</span><span class="hl-default">;

</span><span class="hl-comment">/////////////////////////////////////////////////////////////////////////////
//
// Public member variables
//
/////////////////////////////////////////////////////////////////////////////

/**
 * In-memory Javascript function that returns query results.
 *
 * @property dataFunction
 * @type HTMLFunction
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DS_JSFunction</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">dataFunction</span><span class="hl-default"> = </span><span class="hl-reserved">null</span><span class="hl-default">;

</span><span class="hl-comment">/////////////////////////////////////////////////////////////////////////////
//
// Public methods
//
/////////////////////////////////////////////////////////////////////////////

/**
 * Queries the live data source defined by function for results. Results are
 * passed back to a callback function.
 *  
 * @method doQuery
 * @param oCallbackFn {HTMLFunction} Callback function defined by oParent object to which to return results.
 * @param sQuery {String} Query string.
 * @param oParent {Object} The object instance that has requested data.
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DS_JSFunction</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">doQuery</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">(</span><span class="hl-identifier">oCallbackFn</span><span class="hl-code">, </span><span class="hl-identifier">sQuery</span><span class="hl-code">, </span><span class="hl-identifier">oParent</span><span class="hl-brackets">) {
    </span><span class="hl-reserved">var </span><span class="hl-identifier">oFunction</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">dataFunction</span><span class="hl-code">;
    </span><span class="hl-reserved">var </span><span class="hl-identifier">aResults</span><span class="hl-code"> = </span><span class="hl-brackets">[]</span><span class="hl-code">;
    
    </span><span class="hl-identifier">aResults</span><span class="hl-code"> = </span><span class="hl-identifier">oFunction</span><span class="hl-brackets">(</span><span class="hl-identifier">sQuery</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">aResults</span><span class="hl-code"> === </span><span class="hl-reserved">null</span><span class="hl-brackets">) {
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">dataErrorEvent</span><span class="hl-code">.</span><span class="hl-identifier">fire</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">, </span><span class="hl-identifier">oParent</span><span class="hl-code">, </span><span class="hl-identifier">sQuery</span><span class="hl-code">, </span><span class="hl-identifier">YAHOO</span><span class="hl-code">.</span><span class="hl-identifier">widget</span><span class="hl-code">.</span><span class="hl-identifier">DataSource</span><span class="hl-code">.</span><span class="hl-identifier">ERROR_DATANULL</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-reserved">return</span><span class="hl-code">;
    </span><span class="hl-brackets">}
    
    </span><span class="hl-reserved">var </span><span class="hl-identifier">resultObj</span><span class="hl-code"> = </span><span class="hl-brackets">{}</span><span class="hl-code">;
    </span><span class="hl-identifier">resultObj</span><span class="hl-code">.</span><span class="hl-identifier">query</span><span class="hl-code"> = </span><span class="hl-identifier">decodeURIComponent</span><span class="hl-brackets">(</span><span class="hl-identifier">sQuery</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-identifier">resultObj</span><span class="hl-code">.</span><span class="hl-identifier">results</span><span class="hl-code"> = </span><span class="hl-identifier">aResults</span><span class="hl-code">;
    </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_addCacheElem</span><span class="hl-brackets">(</span><span class="hl-identifier">resultObj</span><span class="hl-brackets">)</span><span class="hl-code">;
    
    </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">getResultsEvent</span><span class="hl-code">.</span><span class="hl-identifier">fire</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">, </span><span class="hl-identifier">oParent</span><span class="hl-code">, </span><span class="hl-identifier">sQuery</span><span class="hl-code">, </span><span class="hl-identifier">aResults</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-identifier">oCallbackFn</span><span class="hl-brackets">(</span><span class="hl-identifier">sQuery</span><span class="hl-code">, </span><span class="hl-identifier">aResults</span><span class="hl-code">, </span><span class="hl-identifier">oParent</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-reserved">return</span><span class="hl-code">;
</span><span class="hl-brackets">}</span><span class="hl-default">;

</span><span class="hl-comment">/****************************************************************************/
// holder
/****************************************************************************/
// holder
/****************************************************************************/
// holder
/**
 * Implementation of YAHOO.widget.DataSource using a native Javascript array as
 * its live data source.
 *
 * @class DS_JSArray
 * @constructor
 * @extends YAHOO.widget.DataSource
 * @param aData {String[]} In-memory Javascript array of simple string data.
 * @param oConfigs {Object} (optional) Object literal of config params.
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DS_JSArray</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">(</span><span class="hl-identifier">aData</span><span class="hl-code">, </span><span class="hl-identifier">oConfigs</span><span class="hl-brackets">) {
    </span><span class="hl-comment">// Set any config params passed in to override defaults
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-reserved">typeof </span><span class="hl-identifier">oConfigs</span><span class="hl-code"> == </span><span class="hl-quotes">&quot;</span><span class="hl-string">object</span><span class="hl-quotes">&quot;</span><span class="hl-brackets">) {
        </span><span class="hl-reserved">for</span><span class="hl-brackets">(</span><span class="hl-reserved">var </span><span class="hl-identifier">sConfig </span><span class="hl-reserved">in </span><span class="hl-identifier">oConfigs</span><span class="hl-brackets">) {
            </span><span class="hl-reserved">this</span><span class="hl-brackets">[</span><span class="hl-identifier">sConfig</span><span class="hl-brackets">]</span><span class="hl-code"> = </span><span class="hl-identifier">oConfigs</span><span class="hl-brackets">[</span><span class="hl-identifier">sConfig</span><span class="hl-brackets">]</span><span class="hl-code">;
        </span><span class="hl-brackets">}
    }

    </span><span class="hl-comment">// Initialization sequence
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-code">!</span><span class="hl-identifier">aData</span><span class="hl-code"> || </span><span class="hl-brackets">(</span><span class="hl-identifier">aData</span><span class="hl-code">.</span><span class="hl-identifier">constructor</span><span class="hl-code"> != </span><span class="hl-builtin">Array</span><span class="hl-brackets">)) {
        </span><span class="hl-reserved">return</span><span class="hl-code">;
    </span><span class="hl-brackets">}
    </span><span class="hl-reserved">else </span><span class="hl-brackets">{
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">data</span><span class="hl-code"> = </span><span class="hl-identifier">aData</span><span class="hl-code">;
        </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">_init</span><span class="hl-brackets">()</span><span class="hl-code">;
    </span><span class="hl-brackets">}
}</span><span class="hl-default">;

</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DS_JSArray</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default"> = </span><span class="hl-reserved">new </span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DataSource</span><span class="hl-brackets">()</span><span class="hl-default">;

</span><span class="hl-comment">/////////////////////////////////////////////////////////////////////////////
//
// Public member variables
//
/////////////////////////////////////////////////////////////////////////////

/**
 * In-memory Javascript array of strings.
 *
 * @property data
 * @type Array
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DS_JSArray</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">data</span><span class="hl-default"> = </span><span class="hl-reserved">null</span><span class="hl-default">;

</span><span class="hl-comment">/////////////////////////////////////////////////////////////////////////////
//
// Public methods
//
/////////////////////////////////////////////////////////////////////////////

/**
 * Queries the live data source defined by data for results. Results are passed
 * back to a callback function.
 *
 * @method doQuery
 * @param oCallbackFn {HTMLFunction} Callback function defined by oParent object to which to return results.
 * @param sQuery {String} Query string.
 * @param oParent {Object} The object instance that has requested data.
 */
</span><span class="hl-identifier">YAHOO</span><span class="hl-default">.</span><span class="hl-identifier">widget</span><span class="hl-default">.</span><span class="hl-identifier">DS_JSArray</span><span class="hl-default">.</span><span class="hl-identifier">prototype</span><span class="hl-default">.</span><span class="hl-identifier">doQuery</span><span class="hl-default"> = </span><span class="hl-reserved">function</span><span class="hl-brackets">(</span><span class="hl-identifier">oCallbackFn</span><span class="hl-code">, </span><span class="hl-identifier">sQuery</span><span class="hl-code">, </span><span class="hl-identifier">oParent</span><span class="hl-brackets">) {
    </span><span class="hl-reserved">var </span><span class="hl-identifier">aData</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">data</span><span class="hl-code">; </span><span class="hl-comment">// the array
    </span><span class="hl-reserved">var </span><span class="hl-identifier">aResults</span><span class="hl-code"> = </span><span class="hl-brackets">[]</span><span class="hl-code">; </span><span class="hl-comment">// container for results
    </span><span class="hl-reserved">var </span><span class="hl-identifier">bMatchFound</span><span class="hl-code"> = </span><span class="hl-reserved">false</span><span class="hl-code">;
    </span><span class="hl-reserved">var </span><span class="hl-identifier">bMatchContains</span><span class="hl-code"> = </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">queryMatchContains</span><span class="hl-code">;
    </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">sQuery</span><span class="hl-brackets">) {
        </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-code">!</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">queryMatchCase</span><span class="hl-brackets">) {
            </span><span class="hl-identifier">sQuery</span><span class="hl-code"> = </span><span class="hl-identifier">sQuery</span><span class="hl-code">.</span><span class="hl-identifier">toLowerCase</span><span class="hl-brackets">()</span><span class="hl-code">;
        </span><span class="hl-brackets">}

        </span><span class="hl-comment">// Loop through each element of the array...
        // which can be a string or an array of strings
        </span><span class="hl-reserved">for</span><span class="hl-brackets">(</span><span class="hl-reserved">var </span><span class="hl-identifier">i</span><span class="hl-code"> = </span><span class="hl-identifier">aData</span><span class="hl-code">.</span><span class="hl-identifier">length</span><span class="hl-code">-</span><span class="hl-number">1</span><span class="hl-code">; </span><span class="hl-identifier">i</span><span class="hl-code"> &gt;= </span><span class="hl-number">0</span><span class="hl-code">; </span><span class="hl-identifier">i</span><span class="hl-code">--</span><span class="hl-brackets">) {
            </span><span class="hl-reserved">var </span><span class="hl-identifier">aDataset</span><span class="hl-code"> = </span><span class="hl-brackets">[]</span><span class="hl-code">;

            </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">aData</span><span class="hl-brackets">[</span><span class="hl-identifier">i</span><span class="hl-brackets">]) {
                </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">aData</span><span class="hl-brackets">[</span><span class="hl-identifier">i</span><span class="hl-brackets">]</span><span class="hl-code">.</span><span class="hl-identifier">constructor</span><span class="hl-code"> == </span><span class="hl-builtin">String</span><span class="hl-brackets">) {
                    </span><span class="hl-identifier">aDataset</span><span class="hl-brackets">[</span><span class="hl-number">0</span><span class="hl-brackets">]</span><span class="hl-code"> = </span><span class="hl-identifier">aData</span><span class="hl-brackets">[</span><span class="hl-identifier">i</span><span class="hl-brackets">]</span><span class="hl-code">;
                </span><span class="hl-brackets">}
                </span><span class="hl-reserved">else if</span><span class="hl-brackets">(</span><span class="hl-identifier">aData</span><span class="hl-brackets">[</span><span class="hl-identifier">i</span><span class="hl-brackets">]</span><span class="hl-code">.</span><span class="hl-identifier">constructor</span><span class="hl-code"> == </span><span class="hl-builtin">Array</span><span class="hl-brackets">) {
                    </span><span class="hl-identifier">aDataset</span><span class="hl-code"> = </span><span class="hl-identifier">aData</span><span class="hl-brackets">[</span><span class="hl-identifier">i</span><span class="hl-brackets">]</span><span class="hl-code">;
                </span><span class="hl-brackets">}
            }

            </span><span class="hl-reserved">if</span><span class="hl-brackets">(</span><span class="hl-identifier">aDataset</span><span class="hl-brackets">[</span><span class="hl-number">0</span><span class="hl-brackets">]</span><span class="hl-code"> &amp;&amp; </span><span class="hl-brackets">(</span><span class="hl-identifier">aDataset</span><span class="hl-brackets">[</span><span class="hl-number">0</span><span class="hl-brackets">]</span><span class="hl-code">.</span><span class="hl-identifier">constructor</span><span class="hl-code"> == </span><span class="hl-builtin">String</span><span class="hl-brackets">)) {
                </span><span class="hl-reserved">var </span><span class="hl-identifier">sKeyIndex</span><span class="hl-code"> = </span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">queryMatchCase</span><span class="hl-brackets">)</span><span class="hl-code"> ?
                </span><span class="hl-identifier">encodeURIComponent</span><span class="hl-brackets">(</span><span class="hl-identifier">aDataset</span><span class="hl-brackets">[</span><span class="hl-number">0</span><span class="hl-brackets">])</span><span class="hl-code">.</span><span class="hl-identifier">indexOf</span><span class="hl-brackets">(</span><span class="hl-identifier">sQuery</span><span class="hl-brackets">)</span><span class="hl-code">:
                </span><span class="hl-identifier">encodeURIComponent</span><span class="hl-brackets">(</span><span class="hl-identifier">aDataset</span><span class="hl-brackets">[</span><span class="hl-number">0</span><span class="hl-brackets">])</span><span class="hl-code">.</span><span class="hl-identifier">toLowerCase</span><span class="hl-brackets">()</span><span class="hl-code">.</span><span class="hl-identifier">indexOf</span><span class="hl-brackets">(</span><span class="hl-identifier">sQuery</span><span class="hl-brackets">)</span><span class="hl-code">;

                </span><span class="hl-comment">// A STARTSWITH match is when the query is found at the beginning of the key string...
                </span><span class="hl-reserved">if</span><span class="hl-brackets">((</span><span class="hl-code">!</span><span class="hl-identifier">bMatchContains</span><span class="hl-code"> &amp;&amp; </span><span class="hl-brackets">(</span><span class="hl-identifier">sKeyIndex</span><span class="hl-code"> === </span><span class="hl-number">0</span><span class="hl-brackets">))</span><span class="hl-code"> ||
                </span><span class="hl-comment">// A CONTAINS match is when the query is found anywhere within the key string...
                </span><span class="hl-brackets">(</span><span class="hl-identifier">bMatchContains</span><span class="hl-code"> &amp;&amp; </span><span class="hl-brackets">(</span><span class="hl-identifier">sKeyIndex</span><span class="hl-code"> &gt; -</span><span class="hl-number">1</span><span class="hl-brackets">))) {
                    </span><span class="hl-comment">// Stash a match into aResults[].
                    </span><span class="hl-identifier">aResults</span><span class="hl-code">.</span><span class="hl-identifier">unshift</span><span class="hl-brackets">(</span><span class="hl-identifier">aDataset</span><span class="hl-brackets">)</span><span class="hl-code">;
                </span><span class="hl-brackets">}
            }
        }
    }

    </span><span class="hl-reserved">this</span><span class="hl-code">.</span><span class="hl-identifier">getResultsEvent</span><span class="hl-code">.</span><span class="hl-identifier">fire</span><span class="hl-brackets">(</span><span class="hl-reserved">this</span><span class="hl-code">, </span><span class="hl-identifier">oParent</span><span class="hl-code">, </span><span class="hl-identifier">sQuery</span><span class="hl-code">, </span><span class="hl-identifier">aResults</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-identifier">oCallbackFn</span><span class="hl-brackets">(</span><span class="hl-identifier">sQuery</span><span class="hl-code">, </span><span class="hl-identifier">aResults</span><span class="hl-code">, </span><span class="hl-identifier">oParent</span><span class="hl-brackets">)</span><span class="hl-code">;
</span><span class="hl-brackets">}</span><span class="hl-default">;
</span></pre></div><hr>Copyright &copy; 2006 Jack Slocum. All rights reserved.</body></html>